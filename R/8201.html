<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>PS</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/998.html#L345'>PS</a>                345 ext/session/mod_files.c 	if (PS(use_strict_mode) &amp;&amp;</span>
<span class='curline'><a href='../S/998.html#L349'>PS</a>                349 ext/session/mod_files.c 			efree(PS(id));</span>
<span class='curline'><a href='../S/998.html#L350'>PS</a>                350 ext/session/mod_files.c 			PS(id) = NULL;</span>
<span class='curline'><a href='../S/998.html#L352'>PS</a>                352 ext/session/mod_files.c 		PS(id) = PS(mod)-&gt;s_create_sid((void **)&amp;data, NULL TSRMLS_CC);</span>
<span class='curline'><a href='../S/998.html#L353'>PS</a>                353 ext/session/mod_files.c 		if (!PS(id)) {</span>
<span class='curline'><a href='../S/998.html#L356'>PS</a>                356 ext/session/mod_files.c 		if (PS(use_cookies)) {</span>
<span class='curline'><a href='../S/998.html#L357'>PS</a>                357 ext/session/mod_files.c 			PS(send_cookie) = 1;</span>
<span class='curline'><a href='../S/998.html#L360'>PS</a>                360 ext/session/mod_files.c 		PS(session_status) = php_session_active;</span>
<span class='curline'><a href='../S/998.html#L363'>PS</a>                363 ext/session/mod_files.c 	if (!PS(id)) {</span>
<span class='curline'><a href='../S/998.html#L367'>PS</a>                367 ext/session/mod_files.c 	ps_files_open(data, PS(id) TSRMLS_CC);</span>
<span class='curline'><a href='../S/1000.html#L276'>PS</a>                276 ext/session/mod_mm.c 	int save_path_len = strlen(PS(save_path));</span>
<span class='curline'><a href='../S/1000.html#L296'>PS</a>                296 ext/session/mod_mm.c 	memcpy(ps_mm_path, PS(save_path), save_path_len);</span>
<span class='curline'><a href='../S/1000.html#L297'>PS</a>                297 ext/session/mod_mm.c 	if (save_path_len &amp;&amp; PS(save_path)[save_path_len - 1] != DEFAULT_SLASH) {</span>
<span class='curline'><a href='../S/1000.html#L359'>PS</a>                359 ext/session/mod_mm.c 	if (PS(use_strict_mode)</span>
<span class='curline'><a href='../S/1000.html#L363'>PS</a>                363 ext/session/mod_mm.c 			efree(PS(id));</span>
<span class='curline'><a href='../S/1000.html#L364'>PS</a>                364 ext/session/mod_mm.c 			PS(id) = NULL;</span>
<span class='curline'><a href='../S/1000.html#L366'>PS</a>                366 ext/session/mod_mm.c 		PS(id) = PS(mod)-&gt;s_create_sid((void **)&amp;data, NULL TSRMLS_CC);</span>
<span class='curline'><a href='../S/1000.html#L367'>PS</a>                367 ext/session/mod_mm.c 		if (!PS(id)) {</span>
<span class='curline'><a href='../S/1000.html#L370'>PS</a>                370 ext/session/mod_mm.c 		if (PS(use_cookies)) {</span>
<span class='curline'><a href='../S/1000.html#L371'>PS</a>                371 ext/session/mod_mm.c 			PS(send_cookie) = 1;</span>
<span class='curline'><a href='../S/1000.html#L374'>PS</a>                374 ext/session/mod_mm.c 		PS(session_status) = php_session_active;</span>
<span class='curline'><a href='../S/1000.html#L377'>PS</a>                377 ext/session/mod_mm.c 	sd = ps_sd_lookup(data, PS(id), 0);</span>
<span class='curline'><a href='../S/1002.html#L69'>PS</a>                 69 ext/session/mod_user.c #define PSF(a) PS(mod_user_names).name.ps_##a</span>
<span class='curline'><a href='../S/1002.html#L95'>PS</a>                 95 ext/session/mod_user.c 	PS(mod_user_implemented) = 1;</span>
<span class='curline'><a href='../S/1002.html#L105'>PS</a>                105 ext/session/mod_user.c 	if (!PS(mod_user_implemented)) {</span>
<span class='curline'><a href='../S/1002.html#L116'>PS</a>                116 ext/session/mod_user.c 	PS(mod_user_implemented) = 0;</span>
<span class='curline'><a href='../S/1004.html#L25'>PS</a>                 25 ext/session/mod_user_class.c 	if (PS(default_mod) == NULL) {				\</span>
<span class='curline'><a href='../S/1004.html#L32'>PS</a>                 32 ext/session/mod_user_class.c 	if (!PS(mod_user_is_open)) {			\</span>
<span class='curline'><a href='../S/1004.html#L50'>PS</a>                 50 ext/session/mod_user_class.c 	PS(mod_user_is_open) = 1;</span>
<span class='curline'><a href='../S/1004.html#L51'>PS</a>                 51 ext/session/mod_user_class.c 	RETVAL_BOOL(SUCCESS == PS(default_mod)-&gt;s_open(&amp;PS(mod_data), save_path, session_name TSRMLS_CC));</span>
<span class='curline'><a href='../S/1004.html#L65'>PS</a>                 65 ext/session/mod_user_class.c 	PS(mod_user_is_open) = 0;</span>
<span class='curline'><a href='../S/1004.html#L66'>PS</a>                 66 ext/session/mod_user_class.c 	RETVAL_BOOL(SUCCESS == PS(default_mod)-&gt;s_close(&amp;PS(mod_data) TSRMLS_CC));</span>
<span class='curline'><a href='../S/1004.html#L83'>PS</a>                 83 ext/session/mod_user_class.c 	if (PS(default_mod)-&gt;s_read(&amp;PS(mod_data), key, &amp;val, &amp;val_len TSRMLS_CC) == FAILURE) {</span>
<span class='curline'><a href='../S/1004.html#L107'>PS</a>                107 ext/session/mod_user_class.c 	RETVAL_BOOL(SUCCESS == PS(default_mod)-&gt;s_write(&amp;PS(mod_data), key, val, val_len TSRMLS_CC));</span>
<span class='curline'><a href='../S/1004.html#L124'>PS</a>                124 ext/session/mod_user_class.c 	RETVAL_BOOL(SUCCESS == PS(default_mod)-&gt;s_destroy(&amp;PS(mod_data), key TSRMLS_CC));</span>
<span class='curline'><a href='../S/1004.html#L141'>PS</a>                141 ext/session/mod_user_class.c 	RETVAL_BOOL(SUCCESS == PS(default_mod)-&gt;s_gc(&amp;PS(mod_data), maxlifetime, &amp;nrdels TSRMLS_CC));</span>
<span class='curline'><a href='../S/1004.html#L157'>PS</a>                157 ext/session/mod_user_class.c 	id = PS(default_mod)-&gt;s_create_sid(&amp;PS(mod_data), NULL TSRMLS_CC);</span>
<span class='curline'><a href='../S/1005.html#L249'>PS</a>                249 ext/session/php_session.h 	if (PS(http_session_vars)) {											\</span>
<span class='curline'><a href='../S/1005.html#L250'>PS</a>                250 ext/session/php_session.h 		zend_hash_del(Z_ARRVAL_P(PS(http_session_vars)), name, namelen+1);	\</span>
<span class='curline'><a href='../S/1005.html#L262'>PS</a>                262 ext/session/php_session.h 		HashTable *_ht = Z_ARRVAL_P(PS(http_session_vars));			\</span>
<span class='curline'><a href='../S/1006.html#L81'>PS</a>                 81 ext/session/session.c 	if (PS(http_session_vars) &amp;&amp; PS(http_session_vars)-&gt;type == IS_ARRAY)</span>
<span class='curline'><a href='../S/1006.html#L84'>PS</a>                 84 ext/session/session.c 	if (PS(session_status) == php_session_active) {	\</span>
<span class='curline'><a href='../S/1006.html#L94'>PS</a>                 94 ext/session/session.c 	PS(id) = NULL;</span>
<span class='curline'><a href='../S/1006.html#L95'>PS</a>                 95 ext/session/session.c 	PS(session_status) = php_session_none;</span>
<span class='curline'><a href='../S/1006.html#L96'>PS</a>                 96 ext/session/session.c 	PS(mod_data) = NULL;</span>
<span class='curline'><a href='../S/1006.html#L97'>PS</a>                 97 ext/session/session.c 	PS(mod_user_is_open) = 0;</span>
<span class='curline'><a href='../S/1006.html#L99'>PS</a>                 99 ext/session/session.c 	PS(http_session_vars) = NULL;</span>
<span class='curline'><a href='../S/1006.html#L106'>PS</a>                106 ext/session/session.c 	if (PS(http_session_vars)) {</span>
<span class='curline'><a href='../S/1006.html#L107'>PS</a>                107 ext/session/session.c 		zval_ptr_dtor(&amp;PS(http_session_vars));</span>
<span class='curline'><a href='../S/1006.html#L108'>PS</a>                108 ext/session/session.c 		PS(http_session_vars) = NULL;</span>
<span class='curline'><a href='../S/1006.html#L111'>PS</a>                111 ext/session/session.c 	if (PS(mod_data) || PS(mod_user_implemented)) {</span>
<span class='curline'><a href='../S/1006.html#L113'>PS</a>                113 ext/session/session.c 			PS(mod)-&gt;s_close(&amp;PS(mod_data) TSRMLS_CC);</span>
<span class='curline'><a href='../S/1006.html#L116'>PS</a>                116 ext/session/session.c 	if (PS(id)) {</span>
<span class='curline'><a href='../S/1006.html#L117'>PS</a>                117 ext/session/session.c 		efree(PS(id));</span>
<span class='curline'><a href='../S/1006.html#L118'>PS</a>                118 ext/session/session.c 		PS(id) = NULL;</span>
<span class='curline'><a href='../S/1006.html#L127'>PS</a>                127 ext/session/session.c 	if (PS(session_status) != php_session_active) {</span>
<span class='curline'><a href='../S/1006.html#L132'>PS</a>                132 ext/session/session.c 	if (PS(id) &amp;&amp; PS(mod)-&gt;s_destroy(&amp;PS(mod_data), PS(id) TSRMLS_CC) == FAILURE) {</span>
<span class='curline'><a href='../S/1006.html#L149'>PS</a>                149 ext/session/session.c 		zend_hash_find(Z_ARRVAL_P(PS(http_session_vars)), name, namelen + 1, (void *) &amp;sym_track);</span>
<span class='curline'><a href='../S/1006.html#L158'>PS</a>                158 ext/session/session.c 		ZEND_SET_SYMBOL_WITH_LENGTH(Z_ARRVAL_P(PS(http_session_vars)), name, namelen+1, empty_var, 1, 0);</span>
<span class='curline'><a href='../S/1006.html#L166'>PS</a>                166 ext/session/session.c 		zend_set_hash_symbol(state_val, name, namelen, PZVAL_IS_REF(state_val), 1, Z_ARRVAL_P(PS(http_session_vars)));</span>
<span class='curline'><a href='../S/1006.html#L176'>PS</a>                176 ext/session/session.c 		ret = zend_hash_find(Z_ARRVAL_P(PS(http_session_vars)), name, namelen + 1, (void **) state_var);</span>
<span class='curline'><a href='../S/1006.html#L189'>PS</a>                189 ext/session/session.c 	if (PS(http_session_vars)) {</span>
<span class='curline'><a href='../S/1006.html#L190'>PS</a>                190 ext/session/session.c 		zval_ptr_dtor(&amp;PS(http_session_vars));</span>
<span class='curline'><a href='../S/1006.html#L195'>PS</a>                195 ext/session/session.c 	PS(http_session_vars) = session_vars;</span>
<span class='curline'><a href='../S/1006.html#L197'>PS</a>                197 ext/session/session.c 	ZEND_SET_GLOBAL_VAR_WITH_LENGTH("_SESSION", sizeof("_SESSION"), PS(http_session_vars), 2, 1);</span>
<span class='curline'><a href='../S/1006.html#L206'>PS</a>                206 ext/session/session.c 		if (!PS(serializer)) {</span>
<span class='curline'><a href='../S/1006.html#L209'>PS</a>                209 ext/session/session.c 		} else if (PS(serializer)-&gt;encode(&amp;ret, newlen TSRMLS_CC) == FAILURE) {</span>
<span class='curline'><a href='../S/1006.html#L221'>PS</a>                221 ext/session/session.c 	if (!PS(serializer)) {</span>
<span class='curline'><a href='../S/1006.html#L225'>PS</a>                225 ext/session/session.c 	if (PS(serializer)-&gt;decode(val, vallen TSRMLS_CC) == FAILURE) {</span>
<span class='curline'><a href='../S/1006.html#L316'>PS</a>                316 ext/session/session.c 	switch (PS(hash_func)) {</span>
<span class='curline'><a href='../S/1006.html#L329'>PS</a>                329 ext/session/session.c 			if (!PS(hash_ops)) {</span>
<span class='curline'><a href='../S/1006.html#L335'>PS</a>                335 ext/session/session.c 			hash_context = emalloc(PS(hash_ops)-&gt;context_size);</span>
<span class='curline'><a href='../S/1006.html#L336'>PS</a>                336 ext/session/session.c 			PS(hash_ops)-&gt;hash_init(hash_context);</span>
<span class='curline'><a href='../S/1006.html#L337'>PS</a>                337 ext/session/session.c 			PS(hash_ops)-&gt;hash_update(hash_context, (unsigned char *) buf, strlen(buf));</span>
<span class='curline'><a href='../S/1006.html#L338'>PS</a>                338 ext/session/session.c 			digest_len = PS(hash_ops)-&gt;digest_size;</span>
<span class='curline'><a href='../S/1006.html#L348'>PS</a>                348 ext/session/session.c 	if (PS(entropy_length) &gt; 0) {</span>
<span class='curline'><a href='../S/1006.html#L351'>PS</a>                351 ext/session/session.c 		size_t toread = PS(entropy_length);</span>
<span class='curline'><a href='../S/1006.html#L355'>PS</a>                355 ext/session/session.c 			switch (PS(hash_func)) {</span>
<span class='curline'><a href='../S/1006.html#L364'>PS</a>                364 ext/session/session.c 					PS(hash_ops)-&gt;hash_update(hash_context, rbuf, toread);</span>
<span class='curline'><a href='../S/1006.html#L372'>PS</a>                372 ext/session/session.c 		fd = VCWD_OPEN(PS(entropy_file), O_RDONLY);</span>
<span class='curline'><a href='../S/1006.html#L376'>PS</a>                376 ext/session/session.c 			int to_read = PS(entropy_length);</span>
<span class='curline'><a href='../S/1006.html#L382'>PS</a>                382 ext/session/session.c 				switch (PS(hash_func)) {</span>
<span class='curline'><a href='../S/1006.html#L391'>PS</a>                391 ext/session/session.c 						PS(hash_ops)-&gt;hash_update(hash_context, rbuf, n);</span>
<span class='curline'><a href='../S/1006.html#L403'>PS</a>                403 ext/session/session.c 	switch (PS(hash_func)) {</span>
<span class='curline'><a href='../S/1006.html#L412'>PS</a>                412 ext/session/session.c 			PS(hash_ops)-&gt;hash_final(digest, hash_context);</span>
<span class='curline'><a href='../S/1006.html#L418'>PS</a>                418 ext/session/session.c 	if (PS(hash_bits_per_character) &lt; 4</span>
<span class='curline'><a href='../S/1006.html#L419'>PS</a>                419 ext/session/session.c 			|| PS(hash_bits_per_character) &gt; 6) {</span>
<span class='curline'><a href='../S/1006.html#L420'>PS</a>                420 ext/session/session.c 		PS(hash_bits_per_character) = 4;</span>
<span class='curline'><a href='../S/1006.html#L425'>PS</a>                425 ext/session/session.c 	outid = emalloc((size_t)((digest_len + 2) * ((8.0f / PS(hash_bits_per_character)) + 0.5)));</span>
<span class='curline'><a href='../S/1006.html#L426'>PS</a>                426 ext/session/session.c 	j = (int) (bin_to_readable((char *)digest, digest_len, outid, (char)PS(hash_bits_per_character)) - outid);</span>
<span class='curline'><a href='../S/1006.html#L476'>PS</a>                476 ext/session/session.c 	if (!PS(mod)) {</span>
<span class='curline'><a href='../S/1006.html#L482'>PS</a>                482 ext/session/session.c 	if (PS(mod)-&gt;s_open(&amp;PS(mod_data), PS(save_path), PS(session_name) TSRMLS_CC) == FAILURE) {</span>
<span class='curline'><a href='../S/1006.html#L483'>PS</a>                483 ext/session/session.c 		php_error_docref(NULL TSRMLS_CC, E_ERROR, "Failed to initialize storage module: %s (path: %s)", PS(mod)-&gt;s_name, PS(save_path));</span>
<span class='curline'><a href='../S/1006.html#L488'>PS</a>                488 ext/session/session.c 	if (!PS(id)) {</span>
<span class='curline'><a href='../S/1006.html#L489'>PS</a>                489 ext/session/session.c 		PS(id) = PS(mod)-&gt;s_create_sid(&amp;PS(mod_data), NULL TSRMLS_CC);</span>
<span class='curline'><a href='../S/1006.html#L490'>PS</a>                490 ext/session/session.c 		if (!PS(id)) {</span>
<span class='curline'><a href='../S/1006.html#L491'>PS</a>                491 ext/session/session.c 			php_error_docref(NULL TSRMLS_CC, E_ERROR, "Failed to create session ID: %s (path: %s)", PS(mod)-&gt;s_name, PS(save_path));</span>
<span class='curline'><a href='../S/1006.html#L494'>PS</a>                494 ext/session/session.c 		if (PS(use_cookies)) {</span>
<span class='curline'><a href='../S/1006.html#L495'>PS</a>                495 ext/session/session.c 			PS(send_cookie) = 1;</span>
<span class='curline'><a href='../S/1006.html#L500'>PS</a>                500 ext/session/session.c 	if (!PS(use_strict_mode)) {</span>
<span class='curline'><a href='../S/1006.html#L502'>PS</a>                502 ext/session/session.c 		PS(session_status) = php_session_active;</span>
<span class='curline'><a href='../S/1006.html#L507'>PS</a>                507 ext/session/session.c 	if (PS(mod)-&gt;s_read(&amp;PS(mod_data), PS(id), &amp;val, &amp;vallen TSRMLS_CC) == FAILURE) {</span>
<span class='curline'><a href='../S/1006.html#L515'>PS</a>                515 ext/session/session.c 	if (PS(use_strict_mode) &amp;&amp; PS(session_status) != php_session_active) {</span>
<span class='curline'><a href='../S/1006.html#L517'>PS</a>                517 ext/session/session.c 		PS(session_status) = php_session_active;</span>
<span class='curline'><a href='../S/1006.html#L524'>PS</a>                524 ext/session/session.c 	if (!PS(use_cookies) &amp;&amp; PS(send_cookie)) {</span>
<span class='curline'><a href='../S/1006.html#L525'>PS</a>                525 ext/session/session.c 		if (PS(use_trans_sid) &amp;&amp; !PS(use_only_cookies)) {</span>
<span class='curline'><a href='../S/1006.html#L526'>PS</a>                526 ext/session/session.c 			PS(apply_trans_sid) = 1;</span>
<span class='curline'><a href='../S/1006.html#L528'>PS</a>                528 ext/session/session.c 		PS(send_cookie) = 0;</span>
<span class='curline'><a href='../S/1006.html#L538'>PS</a>                538 ext/session/session.c  		if (PS(mod_data) || PS(mod_user_implemented)) {</span>
<span class='curline'><a href='../S/1006.html#L544'>PS</a>                544 ext/session/session.c 				ret = PS(mod)-&gt;s_write(&amp;PS(mod_data), PS(id), val, vallen TSRMLS_CC);</span>
<span class='curline'><a href='../S/1006.html#L547'>PS</a>                547 ext/session/session.c 				ret = PS(mod)-&gt;s_write(&amp;PS(mod_data), PS(id), "", 0 TSRMLS_CC);</span>
<span class='curline'><a href='../S/1006.html#L555'>PS</a>                555 ext/session/session.c 					PS(mod)-&gt;s_name,</span>
<span class='curline'><a href='../S/1006.html#L556'>PS</a>                556 ext/session/session.c 					PS(save_path));</span>
<span class='curline'><a href='../S/1006.html#L560'>PS</a>                560 ext/session/session.c 	if (PS(mod_data) || PS(mod_user_implemented)) {</span>
<span class='curline'><a href='../S/1006.html#L561'>PS</a>                561 ext/session/session.c 		PS(mod)-&gt;s_close(&amp;PS(mod_data) TSRMLS_CC);</span>
<span class='curline'><a href='../S/1006.html#L593'>PS</a>                593 ext/session/session.c 	PS(default_mod) = PS(mod);</span>
<span class='curline'><a href='../S/1006.html#L594'>PS</a>                594 ext/session/session.c 	PS(mod) = tmp;</span>
<span class='curline'><a href='../S/1006.html#L622'>PS</a>                622 ext/session/session.c 	PS(serializer) = tmp;</span>
<span class='curline'><a href='../S/1006.html#L633'>PS</a>                633 ext/session/session.c 		PS(use_trans_sid) = (zend_bool) 1;</span>
<span class='curline'><a href='../S/1006.html#L635'>PS</a>                635 ext/session/session.c 		PS(use_trans_sid) = (zend_bool) atoi(new_value);</span>
<span class='curline'><a href='../S/1006.html#L703'>PS</a>                703 ext/session/session.c 	PS(hash_ops) = NULL;</span>
<span class='curline'><a href='../S/1006.html#L709'>PS</a>                709 ext/session/session.c 		PS(hash_func) = val ? 1 : 0;</span>
<span class='curline'><a href='../S/1006.html#L716'>PS</a>                716 ext/session/session.c 		PS(hash_func) = PS_HASH_FUNC_MD5;</span>
<span class='curline'><a href='../S/1006.html#L723'>PS</a>                723 ext/session/session.c 		PS(hash_func) = PS_HASH_FUNC_SHA1;</span>
<span class='curline'><a href='../S/1006.html#L733'>PS</a>                733 ext/session/session.c 		PS(hash_func) = PS_HASH_FUNC_OTHER;</span>
<span class='curline'><a href='../S/1006.html#L734'>PS</a>                734 ext/session/session.c 		PS(hash_ops) = ops;</span>
<span class='curline'><a href='../S/1006.html#L759'>PS</a>                759 ext/session/session.c 		PS(rfc1867_freq) = -tmp;</span>
<span class='curline'><a href='../S/1006.html#L761'>PS</a>                761 ext/session/session.c 		PS(rfc1867_freq) = tmp;</span>
<span class='curline'><a href='../S/1006.html#L848'>PS</a>                848 ext/session/session.c 	php_var_serialize(&amp;buf, &amp;PS(http_session_vars), &amp;var_hash TSRMLS_CC);</span>
<span class='curline'><a href='../S/1006.html#L872'>PS</a>                872 ext/session/session.c 	if (PS(http_session_vars)) {</span>
<span class='curline'><a href='../S/1006.html#L873'>PS</a>                873 ext/session/session.c 		zval_ptr_dtor(&amp;PS(http_session_vars));</span>
<span class='curline'><a href='../S/1006.html#L878'>PS</a>                878 ext/session/session.c 	PS(http_session_vars) = session_vars;</span>
<span class='curline'><a href='../S/1006.html#L879'>PS</a>                879 ext/session/session.c 	ZEND_SET_GLOBAL_VAR_WITH_LENGTH("_SESSION", sizeof("_SESSION"), PS(http_session_vars), Z_REFCOUNT_P(PS(http_session_vars)) + 1, 1);</span>
<span class='curline'><a href='../S/1006.html#L945'>PS</a>                945 ext/session/session.c 			if ((Z_TYPE_PP(tmp) == IS_ARRAY &amp;&amp; Z_ARRVAL_PP(tmp) == &amp;EG(symbol_table)) || *tmp == PS(http_session_vars)) {</span>
<span class='curline'><a href='../S/1006.html#L1041'>PS</a>               1041 ext/session/session.c 			if ((Z_TYPE_PP(tmp) == IS_ARRAY &amp;&amp; Z_ARRVAL_PP(tmp) == &amp;EG(symbol_table)) || *tmp == PS(http_session_vars)) {</span>
<span class='curline'><a href='../S/1006.html#L1203'>PS</a>               1203 ext/session/session.c 	now = tv.tv_sec + PS(cache_expire) * 60;</span>
<span class='curline'><a href='../S/1006.html#L1208'>PS</a>               1208 ext/session/session.c 	snprintf(buf, sizeof(buf) , "Cache-Control: public, max-age=%ld", PS(cache_expire) * 60); /* SAFE */</span>
<span class='curline'><a href='../S/1006.html#L1219'>PS</a>               1219 ext/session/session.c 	snprintf(buf, sizeof(buf), "Cache-Control: private, max-age=%ld, pre-check=%ld", PS(cache_expire) * 60, PS(cache_expire) * 60); /* SAFE */</span>
<span class='curline'><a href='../S/1006.html#L1257'>PS</a>               1257 ext/session/session.c 	if (PS(cache_limiter)[0] == '\0') return 0;</span>
<span class='curline'><a href='../S/1006.html#L1272'>PS</a>               1272 ext/session/session.c 		if (!strcasecmp(lim-&gt;name, PS(cache_limiter))) {</span>
<span class='curline'><a href='../S/1006.html#L1307'>PS</a>               1307 ext/session/session.c 	e_session_name = php_url_encode(PS(session_name), strlen(PS(session_name)), NULL);</span>
<span class='curline'><a href='../S/1006.html#L1356'>PS</a>               1356 ext/session/session.c 	e_session_name = php_url_encode(PS(session_name), strlen(PS(session_name)), NULL);</span>
<span class='curline'><a href='../S/1006.html#L1357'>PS</a>               1357 ext/session/session.c 	e_id = php_url_encode(PS(id), strlen(PS(id)), NULL);</span>
<span class='curline'><a href='../S/1006.html#L1367'>PS</a>               1367 ext/session/session.c 	if (PS(cookie_lifetime) &gt; 0) {</span>
<span class='curline'><a href='../S/1006.html#L1372'>PS</a>               1372 ext/session/session.c 		t = tv.tv_sec + PS(cookie_lifetime);</span>
<span class='curline'><a href='../S/1006.html#L1381'>PS</a>               1381 ext/session/session.c 			smart_str_append_long(&amp;ncookie, PS(cookie_lifetime));</span>
<span class='curline'><a href='../S/1006.html#L1385'>PS</a>               1385 ext/session/session.c 	if (PS(cookie_path)[0]) {</span>
<span class='curline'><a href='../S/1006.html#L1387'>PS</a>               1387 ext/session/session.c 		smart_str_appends(&amp;ncookie, PS(cookie_path));</span>
<span class='curline'><a href='../S/1006.html#L1390'>PS</a>               1390 ext/session/session.c 	if (PS(cookie_domain)[0]) {</span>
<span class='curline'><a href='../S/1006.html#L1392'>PS</a>               1392 ext/session/session.c 		smart_str_appends(&amp;ncookie, PS(cookie_domain));</span>
<span class='curline'><a href='../S/1006.html#L1395'>PS</a>               1395 ext/session/session.c 	if (PS(cookie_secure)) {</span>
<span class='curline'><a href='../S/1006.html#L1399'>PS</a>               1399 ext/session/session.c 	if (PS(cookie_httponly)) {</span>
<span class='curline'><a href='../S/1006.html#L1443'>PS</a>               1443 ext/session/session.c 		PS(id) = NULL;</span>
<span class='curline'><a href='../S/1006.html#L1444'>PS</a>               1444 ext/session/session.c 		PS(send_cookie) = 1;</span>
<span class='curline'><a href='../S/1006.html#L1447'>PS</a>               1447 ext/session/session.c 		PS(id) = estrndup(Z_STRVAL_PP(ppid), Z_STRLEN_PP(ppid));</span>
<span class='curline'><a href='../S/1006.html#L1448'>PS</a>               1448 ext/session/session.c 		PS(send_cookie) = 0;</span>
<span class='curline'><a href='../S/1006.html#L1454'>PS</a>               1454 ext/session/session.c 	int module_number = PS(module_number);</span>
<span class='curline'><a href='../S/1006.html#L1456'>PS</a>               1456 ext/session/session.c 	if (!PS(id)) {</span>
<span class='curline'><a href='../S/1006.html#L1461'>PS</a>               1461 ext/session/session.c 	if (PS(use_cookies) &amp;&amp; PS(send_cookie)) {</span>
<span class='curline'><a href='../S/1006.html#L1463'>PS</a>               1463 ext/session/session.c 		PS(send_cookie) = 0;</span>
<span class='curline'><a href='../S/1006.html#L1469'>PS</a>               1469 ext/session/session.c 	if (PS(define_sid)) {</span>
<span class='curline'><a href='../S/1006.html#L1472'>PS</a>               1472 ext/session/session.c 		smart_str_appends(&amp;var, PS(session_name));</span>
<span class='curline'><a href='../S/1006.html#L1474'>PS</a>               1474 ext/session/session.c 		smart_str_appends(&amp;var, PS(id));</span>
<span class='curline'><a href='../S/1006.html#L1481'>PS</a>               1481 ext/session/session.c 	if (PS(apply_trans_sid)) {</span>
<span class='curline'><a href='../S/1006.html#L1483'>PS</a>               1483 ext/session/session.c 		php_url_scanner_add_var(PS(session_name), strlen(PS(session_name)), PS(id), strlen(PS(id)), 1 TSRMLS_CC);</span>
<span class='curline'><a href='../S/1006.html#L1496'>PS</a>               1496 ext/session/session.c 	if (PS(use_only_cookies)) {</span>
<span class='curline'><a href='../S/1006.html#L1497'>PS</a>               1497 ext/session/session.c 		PS(apply_trans_sid) = 0;</span>
<span class='curline'><a href='../S/1006.html#L1499'>PS</a>               1499 ext/session/session.c 		PS(apply_trans_sid) = PS(use_trans_sid);</span>
<span class='curline'><a href='../S/1006.html#L1502'>PS</a>               1502 ext/session/session.c 	switch (PS(session_status)) {</span>
<span class='curline'><a href='../S/1006.html#L1510'>PS</a>               1510 ext/session/session.c 			if (!PS(mod) &amp;&amp; value) {</span>
<span class='curline'><a href='../S/1006.html#L1511'>PS</a>               1511 ext/session/session.c 				PS(mod) = _php_find_ps_module(value TSRMLS_CC);</span>
<span class='curline'><a href='../S/1006.html#L1512'>PS</a>               1512 ext/session/session.c 				if (!PS(mod)) {</span>
<span class='curline'><a href='../S/1006.html#L1518'>PS</a>               1518 ext/session/session.c 			if (!PS(serializer) &amp;&amp; value) {</span>
<span class='curline'><a href='../S/1006.html#L1519'>PS</a>               1519 ext/session/session.c 				PS(serializer) = _php_find_ps_serializer(value TSRMLS_CC);</span>
<span class='curline'><a href='../S/1006.html#L1520'>PS</a>               1520 ext/session/session.c 				if (!PS(serializer)) {</span>
<span class='curline'><a href='../S/1006.html#L1525'>PS</a>               1525 ext/session/session.c 			PS(session_status) = php_session_none;</span>
<span class='curline'><a href='../S/1006.html#L1530'>PS</a>               1530 ext/session/session.c 			PS(define_sid) = 1;</span>
<span class='curline'><a href='../S/1006.html#L1531'>PS</a>               1531 ext/session/session.c 			PS(send_cookie) = 1;</span>
<span class='curline'><a href='../S/1006.html#L1534'>PS</a>               1534 ext/session/session.c 	lensess = strlen(PS(session_name));</span>
<span class='curline'><a href='../S/1006.html#L1539'>PS</a>               1539 ext/session/session.c 	if (!PS(id)) {</span>
<span class='curline'><a href='../S/1006.html#L1540'>PS</a>               1540 ext/session/session.c 		if (PS(use_cookies) &amp;&amp; zend_hash_find(&amp;EG(symbol_table), "_COOKIE", sizeof("_COOKIE"), (void **) &amp;data) == SUCCESS &amp;&amp;</span>
<span class='curline'><a href='../S/1006.html#L1542'>PS</a>               1542 ext/session/session.c 				zend_hash_find(Z_ARRVAL_PP(data), PS(session_name), lensess + 1, (void **) &amp;ppid) == SUCCESS</span>
<span class='curline'><a href='../S/1006.html#L1545'>PS</a>               1545 ext/session/session.c 			PS(apply_trans_sid) = 0;</span>
<span class='curline'><a href='../S/1006.html#L1546'>PS</a>               1546 ext/session/session.c 			PS(define_sid) = 0;</span>
<span class='curline'><a href='../S/1006.html#L1549'>PS</a>               1549 ext/session/session.c 		if (!PS(use_only_cookies) &amp;&amp; !PS(id) &amp;&amp;</span>
<span class='curline'><a href='../S/1006.html#L1552'>PS</a>               1552 ext/session/session.c 				zend_hash_find(Z_ARRVAL_PP(data), PS(session_name), lensess + 1, (void **) &amp;ppid) == SUCCESS</span>
<span class='curline'><a href='../S/1006.html#L1557'>PS</a>               1557 ext/session/session.c 		if (!PS(use_only_cookies) &amp;&amp; !PS(id) &amp;&amp;</span>
<span class='curline'><a href='../S/1006.html#L1560'>PS</a>               1560 ext/session/session.c 				zend_hash_find(Z_ARRVAL_PP(data), PS(session_name), lensess + 1, (void **) &amp;ppid) == SUCCESS</span>
<span class='curline'><a href='../S/1006.html#L1570'>PS</a>               1570 ext/session/session.c 	if (!PS(use_only_cookies) &amp;&amp; !PS(id) &amp;&amp; PG(http_globals)[TRACK_VARS_SERVER] &amp;&amp;</span>
<span class='curline'><a href='../S/1006.html#L1573'>PS</a>               1573 ext/session/session.c 			(p = strstr(Z_STRVAL_PP(data), PS(session_name))) &amp;&amp;</span>
<span class='curline'><a href='../S/1006.html#L1580'>PS</a>               1580 ext/session/session.c 			PS(id) = estrndup(p, q - p);</span>
<span class='curline'><a href='../S/1006.html#L1581'>PS</a>               1581 ext/session/session.c 			PS(send_cookie) = 0;</span>
<span class='curline'><a href='../S/1006.html#L1588'>PS</a>               1588 ext/session/session.c 	if (PS(id) &amp;&amp;</span>
<span class='curline'><a href='../S/1006.html#L1589'>PS</a>               1589 ext/session/session.c 			PS(extern_referer_chk)[0] != '\0' &amp;&amp;</span>
<span class='curline'><a href='../S/1006.html#L1594'>PS</a>               1594 ext/session/session.c 			strstr(Z_STRVAL_PP(data), PS(extern_referer_chk)) == NULL</span>
<span class='curline'><a href='../S/1006.html#L1596'>PS</a>               1596 ext/session/session.c 		efree(PS(id));</span>
<span class='curline'><a href='../S/1006.html#L1597'>PS</a>               1597 ext/session/session.c 		PS(id) = NULL;</span>
<span class='curline'><a href='../S/1006.html#L1598'>PS</a>               1598 ext/session/session.c 		PS(send_cookie) = 1;</span>
<span class='curline'><a href='../S/1006.html#L1599'>PS</a>               1599 ext/session/session.c 		if (PS(use_trans_sid) &amp;&amp; !PS(use_only_cookies)) {</span>
<span class='curline'><a href='../S/1006.html#L1600'>PS</a>               1600 ext/session/session.c 			PS(apply_trans_sid) = 1;</span>
<span class='curline'><a href='../S/1006.html#L1606'>PS</a>               1606 ext/session/session.c 	if (PS(id) &amp;&amp; strpbrk(PS(id), "\r\n\t &lt;&gt;'\"\\")) {</span>
<span class='curline'><a href='../S/1006.html#L1607'>PS</a>               1607 ext/session/session.c 		efree(PS(id));</span>
<span class='curline'><a href='../S/1006.html#L1608'>PS</a>               1608 ext/session/session.c 		PS(id) = NULL;</span>
<span class='curline'><a href='../S/1006.html#L1614'>PS</a>               1614 ext/session/session.c 	if ((PS(mod_data) || PS(mod_user_implemented)) &amp;&amp; PS(gc_probability) &gt; 0) {</span>
<span class='curline'><a href='../S/1006.html#L1617'>PS</a>               1617 ext/session/session.c 		nrand = (int) ((float) PS(gc_divisor) * php_combined_lcg(TSRMLS_C));</span>
<span class='curline'><a href='../S/1006.html#L1618'>PS</a>               1618 ext/session/session.c 		if (nrand &lt; PS(gc_probability)) {</span>
<span class='curline'><a href='../S/1006.html#L1619'>PS</a>               1619 ext/session/session.c 			PS(mod)-&gt;s_gc(&amp;PS(mod_data), PS(gc_maxlifetime), &amp;nrdels TSRMLS_CC);</span>
<span class='curline'><a href='../S/1006.html#L1632'>PS</a>               1632 ext/session/session.c 	if (PS(session_status) == php_session_active) {</span>
<span class='curline'><a href='../S/1006.html#L1633'>PS</a>               1633 ext/session/session.c 		PS(session_status) = php_session_none;</span>
<span class='curline'><a href='../S/1006.html#L1641'>PS</a>               1641 ext/session/session.c 	if (PS(session_status) == php_session_active) {</span>
<span class='curline'><a href='../S/1006.html#L1642'>PS</a>               1642 ext/session/session.c 		PS(session_status) = php_session_none;</span>
<span class='curline'><a href='../S/1006.html#L1643'>PS</a>               1643 ext/session/session.c 		if (PS(mod_data) || PS(mod_user_implemented)) {</span>
<span class='curline'><a href='../S/1006.html#L1644'>PS</a>               1644 ext/session/session.c 			PS(mod)-&gt;s_close(&amp;PS(mod_data) TSRMLS_CC);</span>
<span class='curline'><a href='../S/1006.html#L1652'>PS</a>               1652 ext/session/session.c 	if (PS(session_status) == php_session_active) {</span>
<span class='curline'><a href='../S/1006.html#L1661'>PS</a>               1661 ext/session/session.c 	if (PS(apply_trans_sid) &amp;&amp; (PS(session_status) == php_session_active)) {</span>
<span class='curline'><a href='../S/1006.html#L1662'>PS</a>               1662 ext/session/session.c 		*new = php_url_scanner_adapt_single_url(url, urllen, PS(session_name), PS(id), newlen TSRMLS_CC);</span>
<span class='curline'><a href='../S/1006.html#L1680'>PS</a>               1680 ext/session/session.c 	if (!PS(use_cookies) ||</span>
<span class='curline'><a href='../S/1006.html#L1715'>PS</a>               1715 ext/session/session.c 	add_assoc_long(return_value, "lifetime", PS(cookie_lifetime));</span>
<span class='curline'><a href='../S/1006.html#L1716'>PS</a>               1716 ext/session/session.c 	add_assoc_string(return_value, "path", PS(cookie_path), 1);</span>
<span class='curline'><a href='../S/1006.html#L1717'>PS</a>               1717 ext/session/session.c 	add_assoc_string(return_value, "domain", PS(cookie_domain), 1);</span>
<span class='curline'><a href='../S/1006.html#L1718'>PS</a>               1718 ext/session/session.c 	add_assoc_bool(return_value, "secure", PS(cookie_secure));</span>
<span class='curline'><a href='../S/1006.html#L1719'>PS</a>               1719 ext/session/session.c 	add_assoc_bool(return_value, "httponly", PS(cookie_httponly));</span>
<span class='curline'><a href='../S/1006.html#L1734'>PS</a>               1734 ext/session/session.c 	RETVAL_STRING(PS(session_name), 1);</span>
<span class='curline'><a href='../S/1006.html#L1754'>PS</a>               1754 ext/session/session.c 	if (PS(mod) &amp;&amp; PS(mod)-&gt;s_name) {</span>
<span class='curline'><a href='../S/1006.html#L1755'>PS</a>               1755 ext/session/session.c 		RETVAL_STRING(safe_estrdup(PS(mod)-&gt;s_name), 0);</span>
<span class='curline'><a href='../S/1006.html#L1767'>PS</a>               1767 ext/session/session.c 		if (PS(mod_data) || PS(mod_user_implemented)) {</span>
<span class='curline'><a href='../S/1006.html#L1768'>PS</a>               1768 ext/session/session.c 			PS(mod)-&gt;s_close(&amp;PS(mod_data) TSRMLS_CC);</span>
<span class='curline'><a href='../S/1006.html#L1770'>PS</a>               1770 ext/session/session.c 		PS(mod_data) = NULL;</span>
<span class='curline'><a href='../S/1006.html#L1785'>PS</a>               1785 ext/session/session.c 	if (PS(session_status) != php_session_none) {</span>
<span class='curline'><a href='../S/1006.html#L1810'>PS</a>               1810 ext/session/session.c 				if (PS(mod_user_names).names[i] != NULL) {</span>
<span class='curline'><a href='../S/1006.html#L1811'>PS</a>               1811 ext/session/session.c 					zval_ptr_dtor(&amp;PS(mod_user_names).names[i]);</span>
<span class='curline'><a href='../S/1006.html#L1819'>PS</a>               1819 ext/session/session.c 				PS(mod_user_names).names[i] = callback;</span>
<span class='curline'><a href='../S/1006.html#L1835'>PS</a>               1835 ext/session/session.c 				if (PS(mod_user_names).names[i] != NULL) {</span>
<span class='curline'><a href='../S/1006.html#L1836'>PS</a>               1836 ext/session/session.c 					zval_ptr_dtor(&amp;PS(mod_user_names).names[i]);</span>
<span class='curline'><a href='../S/1006.html#L1844'>PS</a>               1844 ext/session/session.c 				PS(mod_user_names).names[i] = callback;</span>
<span class='curline'><a href='../S/1006.html#L1872'>PS</a>               1872 ext/session/session.c 		if (PS(mod) &amp;&amp; PS(session_status) == php_session_none &amp;&amp; PS(mod) != &amp;ps_mod_user) {</span>
<span class='curline'><a href='../S/1006.html#L1901'>PS</a>               1901 ext/session/session.c 	if (PS(mod) &amp;&amp; PS(mod) != &amp;ps_mod_user) {</span>
<span class='curline'><a href='../S/1006.html#L1906'>PS</a>               1906 ext/session/session.c 		if (PS(mod_user_names).names[i] != NULL) {</span>
<span class='curline'><a href='../S/1006.html#L1907'>PS</a>               1907 ext/session/session.c 			zval_ptr_dtor(&amp;PS(mod_user_names).names[i]);</span>
<span class='curline'><a href='../S/1006.html#L1910'>PS</a>               1910 ext/session/session.c 		PS(mod_user_names).names[i] = *args[i];</span>
<span class='curline'><a href='../S/1006.html#L1929'>PS</a>               1929 ext/session/session.c 	RETVAL_STRING(PS(save_path), 1);</span>
<span class='curline'><a href='../S/1006.html#L1953'>PS</a>               1953 ext/session/session.c 	if (PS(id)) {</span>
<span class='curline'><a href='../S/1006.html#L1954'>PS</a>               1954 ext/session/session.c 		RETVAL_STRING(PS(id), 1);</span>
<span class='curline'><a href='../S/1006.html#L1960'>PS</a>               1960 ext/session/session.c 		if (PS(id)) {</span>
<span class='curline'><a href='../S/1006.html#L1961'>PS</a>               1961 ext/session/session.c 			efree(PS(id));</span>
<span class='curline'><a href='../S/1006.html#L1963'>PS</a>               1963 ext/session/session.c 		PS(id) = estrndup(name, name_len);</span>
<span class='curline'><a href='../S/1006.html#L1978'>PS</a>               1978 ext/session/session.c 	if (SG(headers_sent) &amp;&amp; PS(use_cookies)) {</span>
<span class='curline'><a href='../S/1006.html#L1983'>PS</a>               1983 ext/session/session.c 	if (PS(session_status) == php_session_active) {</span>
<span class='curline'><a href='../S/1006.html#L1984'>PS</a>               1984 ext/session/session.c 		if (PS(id)) {</span>
<span class='curline'><a href='../S/1006.html#L1985'>PS</a>               1985 ext/session/session.c 			if (del_ses &amp;&amp; PS(mod)-&gt;s_destroy(&amp;PS(mod_data), PS(id) TSRMLS_CC) == FAILURE) {</span>
<span class='curline'><a href='../S/1006.html#L1989'>PS</a>               1989 ext/session/session.c 			efree(PS(id));</span>
<span class='curline'><a href='../S/1006.html#L1992'>PS</a>               1992 ext/session/session.c 		PS(id) = PS(mod)-&gt;s_create_sid(&amp;PS(mod_data), NULL TSRMLS_CC);</span>
<span class='curline'><a href='../S/1006.html#L1993'>PS</a>               1993 ext/session/session.c 		if (PS(id)) {</span>
<span class='curline'><a href='../S/1006.html#L1994'>PS</a>               1994 ext/session/session.c 			PS(send_cookie) = 1;</span>
<span class='curline'><a href='../S/1006.html#L1998'>PS</a>               1998 ext/session/session.c 			PS(id) = STR_EMPTY_ALLOC();</span>
<span class='curline'><a href='../S/1006.html#L2016'>PS</a>               2016 ext/session/session.c 	RETVAL_STRING(PS(cache_limiter), 1);</span>
<span class='curline'><a href='../S/1006.html#L2035'>PS</a>               2035 ext/session/session.c 	RETVAL_LONG(PS(cache_expire));</span>
<span class='curline'><a href='../S/1006.html#L2071'>PS</a>               2071 ext/session/session.c 	if (PS(session_status) == php_session_none) {</span>
<span class='curline'><a href='../S/1006.html#L2088'>PS</a>               2088 ext/session/session.c 	if (PS(id) &amp;&amp; !strlen(PS(id))) {</span>
<span class='curline'><a href='../S/1006.html#L2095'>PS</a>               2095 ext/session/session.c 	if (PS(session_status) != php_session_active) {</span>
<span class='curline'><a href='../S/1006.html#L2118'>PS</a>               2118 ext/session/session.c 	if (PS(session_status) == php_session_none) {</span>
<span class='curline'><a href='../S/1006.html#L2125'>PS</a>               2125 ext/session/session.c 		SEPARATE_ZVAL_IF_NOT_REF(&amp;PS(http_session_vars));</span>
<span class='curline'><a href='../S/1006.html#L2126'>PS</a>               2126 ext/session/session.c 		ht_sess_var = Z_ARRVAL_P(PS(http_session_vars));</span>
<span class='curline'><a href='../S/1006.html#L2166'>PS</a>               2166 ext/session/session.c 	RETURN_LONG(PS(session_status));</span>
<span class='curline'><a href='../S/1006.html#L2361'>PS</a>               2361 ext/session/session.c 	if (PS(mod) == NULL) {</span>
<span class='curline'><a href='../S/1006.html#L2366'>PS</a>               2366 ext/session/session.c 			PS(mod) = _php_find_ps_module(value TSRMLS_CC);</span>
<span class='curline'><a href='../S/1006.html#L2370'>PS</a>               2370 ext/session/session.c 	if (PS(serializer) == NULL) {</span>
<span class='curline'><a href='../S/1006.html#L2375'>PS</a>               2375 ext/session/session.c 			PS(serializer) = _php_find_ps_serializer(value TSRMLS_CC);</span>
<span class='curline'><a href='../S/1006.html#L2379'>PS</a>               2379 ext/session/session.c 	if (PS(mod) == NULL || PS(serializer) == NULL) {</span>
<span class='curline'><a href='../S/1006.html#L2381'>PS</a>               2381 ext/session/session.c 		PS(session_status) = php_session_disabled;</span>
<span class='curline'><a href='../S/1006.html#L2394'>PS</a>               2394 ext/session/session.c 	return php_rinit_session(PS(auto_start) TSRMLS_CC);</span>
<span class='curline'><a href='../S/1006.html#L2409'>PS</a>               2409 ext/session/session.c 		if (PS(mod_user_names).names[i] != NULL) {</span>
<span class='curline'><a href='../S/1006.html#L2410'>PS</a>               2410 ext/session/session.c 			zval_ptr_dtor(&amp;PS(mod_user_names).names[i]);</span>
<span class='curline'><a href='../S/1006.html#L2411'>PS</a>               2411 ext/session/session.c 			PS(mod_user_names).names[i] = NULL;</span>
<span class='curline'><a href='../S/1006.html#L2446'>PS</a>               2446 ext/session/session.c 	PS(module_number) = module_number; /* if we really need this var we need to init it in zts mode as well! */</span>
<span class='curline'><a href='../S/1006.html#L2448'>PS</a>               2448 ext/session/session.c 	PS(session_status) = php_session_none;</span>
<span class='curline'><a href='../S/1006.html#L2569'>PS</a>               2569 ext/session/session.c 	if (zend_hash_find(Z_ARRVAL_P(PG(http_globals)[where]), PS(session_name), progress-&gt;sname_len+1, (void **)&amp;ppid) == SUCCESS</span>
<span class='curline'><a href='../S/1006.html#L2582'>PS</a>               2582 ext/session/session.c 	if (PS(use_cookies)) {</span>
<span class='curline'><a href='../S/1006.html#L2589'>PS</a>               2589 ext/session/session.c 	if (PS(use_only_cookies)) {</span>
<span class='curline'><a href='../S/1006.html#L2600'>PS</a>               2600 ext/session/session.c 	if (zend_symtable_find(Z_ARRVAL_P(PS(http_session_vars)), progress-&gt;key.c, progress-&gt;key.len+1, (void**)&amp;progress_ary) != SUCCESS) {</span>
<span class='curline'><a href='../S/1006.html#L2619'>PS</a>               2619 ext/session/session.c 		if (PS(rfc1867_min_freq) &gt; 0.0) {</span>
<span class='curline'><a href='../S/1006.html#L2627'>PS</a>               2627 ext/session/session.c 			progress-&gt;next_update_time = dtv + PS(rfc1867_min_freq);</span>
<span class='curline'><a href='../S/1006.html#L2634'>PS</a>               2634 ext/session/session.c 	PS(session_status) = php_session_active;</span>
<span class='curline'><a href='../S/1006.html#L2637'>PS</a>               2637 ext/session/session.c 		ZEND_SET_SYMBOL_WITH_LENGTH(Z_ARRVAL_P(PS(http_session_vars)), progress-&gt;key.c, progress-&gt;key.len+1, progress-&gt;data, 2, 0);</span>
<span class='curline'><a href='../S/1006.html#L2645'>PS</a>               2645 ext/session/session.c 	PS(session_status) = php_session_active;</span>
<span class='curline'><a href='../S/1006.html#L2647'>PS</a>               2647 ext/session/session.c 		zend_hash_del(Z_ARRVAL_P(PS(http_session_vars)), progress-&gt;key.c, progress-&gt;key.len+1);</span>
<span class='curline'><a href='../S/1006.html#L2660'>PS</a>               2660 ext/session/session.c 	if (!PS(rfc1867_enabled)) {</span>
<span class='curline'><a href='../S/1006.html#L2664'>PS</a>               2664 ext/session/session.c 	progress = PS(rfc1867_progress);</span>
<span class='curline'><a href='../S/1006.html#L2671'>PS</a>               2671 ext/session/session.c 			progress-&gt;sname_len  = strlen(PS(session_name));</span>
<span class='curline'><a href='../S/1006.html#L2672'>PS</a>               2672 ext/session/session.c 			PS(rfc1867_progress) = progress;</span>
<span class='curline'><a href='../S/1006.html#L2693'>PS</a>               2693 ext/session/session.c 				if (name_len == progress-&gt;sname_len &amp;&amp; memcmp(data-&gt;name, PS(session_name), name_len) == 0) {</span>
<span class='curline'><a href='../S/1006.html#L2697'>PS</a>               2697 ext/session/session.c 				} else if (name_len == PS(rfc1867_name).len &amp;&amp; memcmp(data-&gt;name, PS(rfc1867_name).c, name_len) == 0) {</span>
<span class='curline'><a href='../S/1006.html#L2699'>PS</a>               2699 ext/session/session.c 					smart_str_appendl(&amp;progress-&gt;key, PS(rfc1867_prefix).c, PS(rfc1867_prefix).len);</span>
<span class='curline'><a href='../S/1006.html#L2703'>PS</a>               2703 ext/session/session.c 					progress-&gt;apply_trans_sid = PS(use_trans_sid);</span>
<span class='curline'><a href='../S/1006.html#L2721'>PS</a>               2721 ext/session/session.c 				if (PS(rfc1867_freq) &gt;= 0) {</span>
<span class='curline'><a href='../S/1006.html#L2722'>PS</a>               2722 ext/session/session.c 					progress-&gt;update_step = PS(rfc1867_freq);</span>
<span class='curline'><a href='../S/1006.html#L2723'>PS</a>               2723 ext/session/session.c 				} else if (PS(rfc1867_freq) &lt; 0) { /* % of total size */</span>
<span class='curline'><a href='../S/1006.html#L2724'>PS</a>               2724 ext/session/session.c 					progress-&gt;update_step = progress-&gt;content_length * -PS(rfc1867_freq) / 100;</span>
<span class='curline'><a href='../S/1006.html#L2745'>PS</a>               2745 ext/session/session.c 				PS(id) = estrndup(Z_STRVAL(progress-&gt;sid), Z_STRLEN(progress-&gt;sid));</span>
<span class='curline'><a href='../S/1006.html#L2746'>PS</a>               2746 ext/session/session.c 				PS(apply_trans_sid) = progress-&gt;apply_trans_sid;</span>
<span class='curline'><a href='../S/1006.html#L2747'>PS</a>               2747 ext/session/session.c 				PS(send_cookie) = 0;</span>
<span class='curline'><a href='../S/1006.html#L2808'>PS</a>               2808 ext/session/session.c 				if (PS(rfc1867_cleanup)) {</span>
<span class='curline'><a href='../S/1006.html#L2825'>PS</a>               2825 ext/session/session.c 			PS(rfc1867_progress) = NULL;</span>
<span class='curline'><a href='../S/1031.html#L1675'>PS</a>               1675 ext/soap/soap.c 			if (PS(session_status) != php_session_active &amp;&amp;</span>
<span class='curline'><a href='../S/1031.html#L1676'>PS</a>               1676 ext/soap/soap.c 			    PS(session_status) != php_session_disabled) {</span>
<span class='curline'><a href='../S/1031.html#L1681'>PS</a>               1681 ext/soap/soap.c 			if (zend_hash_find(Z_ARRVAL_P(PS(http_session_vars)), "_bogus_session_name", sizeof("_bogus_session_name"), (void **) &amp;tmp_soap) == SUCCESS &amp;&amp;</span>
<span class='curline'><a href='../S/1031.html#L1757'>PS</a>               1757 ext/soap/soap.c 				if (zend_hash_update(Z_ARRVAL_P(PS(http_session_vars)), "_bogus_session_name", sizeof("_bogus_session_name"), &amp;tmp_soap, sizeof(zval *), (void **)&amp;tmp_soap_pp) == SUCCESS) {</span>
</pre>
</body>
</html>
