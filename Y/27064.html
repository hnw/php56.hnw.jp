<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>ms</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/176.html#L115'>ms</a>                115 ext/fileinfo/libmagic/apprentice.c private int getvalue(struct magic_set *ms, struct magic *, const char **, int);</span>
<span class='curline'><a href='../S/176.html#L392'>ms</a>                392 ext/fileinfo/libmagic/apprentice.c apprentice_1(struct magic_set *ms, const char *fn, int action)</span>
<span class='curline'><a href='../S/176.html#L399'>ms</a>                399 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, 0, "magic element size %lu != %lu",</span>
<span class='curline'><a href='../S/176.html#L406'>ms</a>                406 ext/fileinfo/libmagic/apprentice.c 		map = apprentice_load(ms, fn, action);</span>
<span class='curline'><a href='../S/176.html#L409'>ms</a>                409 ext/fileinfo/libmagic/apprentice.c 		return apprentice_compile(ms, map, fn);</span>
<span class='curline'><a href='../S/176.html#L412'>ms</a>                412 ext/fileinfo/libmagic/apprentice.c 	map = apprentice_map(ms, fn);</span>
<span class='curline'><a href='../S/176.html#L415'>ms</a>                415 ext/fileinfo/libmagic/apprentice.c 			if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/176.html#L416'>ms</a>                416 ext/fileinfo/libmagic/apprentice.c 				file_magwarn(ms, "using regular magic file `%s'", fn);</span>
<span class='curline'><a href='../S/176.html#L417'>ms</a>                417 ext/fileinfo/libmagic/apprentice.c 			map = apprentice_load(ms, fn, action);</span>
<span class='curline'><a href='../S/176.html#L424'>ms</a>                424 ext/fileinfo/libmagic/apprentice.c 		if (add_mlist(ms-&gt;mlist[i], map, i) == -1) {</span>
<span class='curline'><a href='../S/176.html#L425'>ms</a>                425 ext/fileinfo/libmagic/apprentice.c 			file_oomem(ms, sizeof(*ml));</span>
<span class='curline'><a href='../S/176.html#L434'>ms</a>                434 ext/fileinfo/libmagic/apprentice.c 			apprentice_list(ms-&gt;mlist[i], BINTEST);</span>
<span class='curline'><a href='../S/176.html#L436'>ms</a>                436 ext/fileinfo/libmagic/apprentice.c 			apprentice_list(ms-&gt;mlist[i], TEXTTEST);</span>
<span class='curline'><a href='../S/176.html#L444'>ms</a>                444 ext/fileinfo/libmagic/apprentice.c file_ms_free(struct magic_set *ms)</span>
<span class='curline'><a href='../S/176.html#L447'>ms</a>                447 ext/fileinfo/libmagic/apprentice.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/176.html#L450'>ms</a>                450 ext/fileinfo/libmagic/apprentice.c 		mlist_free(ms-&gt;mlist[i]);</span>
<span class='curline'><a href='../S/176.html#L451'>ms</a>                451 ext/fileinfo/libmagic/apprentice.c 	if (ms-&gt;o.pbuf) {</span>
<span class='curline'><a href='../S/176.html#L452'>ms</a>                452 ext/fileinfo/libmagic/apprentice.c 		efree(ms-&gt;o.pbuf);</span>
<span class='curline'><a href='../S/176.html#L454'>ms</a>                454 ext/fileinfo/libmagic/apprentice.c 	if (ms-&gt;o.buf) {</span>
<span class='curline'><a href='../S/176.html#L455'>ms</a>                455 ext/fileinfo/libmagic/apprentice.c 		efree(ms-&gt;o.buf);</span>
<span class='curline'><a href='../S/176.html#L457'>ms</a>                457 ext/fileinfo/libmagic/apprentice.c 	if (ms-&gt;c.li) {</span>
<span class='curline'><a href='../S/176.html#L458'>ms</a>                458 ext/fileinfo/libmagic/apprentice.c 		efree(ms-&gt;c.li);</span>
<span class='curline'><a href='../S/176.html#L460'>ms</a>                460 ext/fileinfo/libmagic/apprentice.c 	efree(ms);</span>
<span class='curline'><a href='../S/176.html#L466'>ms</a>                466 ext/fileinfo/libmagic/apprentice.c 	struct magic_set *ms;</span>
<span class='curline'><a href='../S/176.html#L469'>ms</a>                469 ext/fileinfo/libmagic/apprentice.c 	if ((ms = CAST(struct magic_set *, ecalloc((size_t)1,</span>
<span class='curline'><a href='../S/176.html#L473'>ms</a>                473 ext/fileinfo/libmagic/apprentice.c 	if (magic_setflags(ms, flags) == -1) {</span>
<span class='curline'><a href='../S/176.html#L478'>ms</a>                478 ext/fileinfo/libmagic/apprentice.c 	ms-&gt;o.buf = ms-&gt;o.pbuf = NULL;</span>
<span class='curline'><a href='../S/176.html#L479'>ms</a>                479 ext/fileinfo/libmagic/apprentice.c 	len = (ms-&gt;c.len = 10) * sizeof(*ms-&gt;c.li);</span>
<span class='curline'><a href='../S/176.html#L481'>ms</a>                481 ext/fileinfo/libmagic/apprentice.c 	if ((ms-&gt;c.li = CAST(struct level_info *, emalloc(len))) == NULL)</span>
<span class='curline'><a href='../S/176.html#L484'>ms</a>                484 ext/fileinfo/libmagic/apprentice.c 	ms-&gt;event_flags = 0;</span>
<span class='curline'><a href='../S/176.html#L485'>ms</a>                485 ext/fileinfo/libmagic/apprentice.c 	ms-&gt;error = -1;</span>
<span class='curline'><a href='../S/176.html#L487'>ms</a>                487 ext/fileinfo/libmagic/apprentice.c 		ms-&gt;mlist[i] = NULL;</span>
<span class='curline'><a href='../S/176.html#L488'>ms</a>                488 ext/fileinfo/libmagic/apprentice.c 	ms-&gt;file = "unknown";</span>
<span class='curline'><a href='../S/176.html#L489'>ms</a>                489 ext/fileinfo/libmagic/apprentice.c 	ms-&gt;line = 0;</span>
<span class='curline'><a href='../S/176.html#L490'>ms</a>                490 ext/fileinfo/libmagic/apprentice.c 	return ms;</span>
<span class='curline'><a href='../S/176.html#L492'>ms</a>                492 ext/fileinfo/libmagic/apprentice.c 	efree(ms);</span>
<span class='curline'><a href='../S/176.html#L547'>ms</a>                547 ext/fileinfo/libmagic/apprentice.c file_apprentice(struct magic_set *ms, const char *fn, int action)</span>
<span class='curline'><a href='../S/176.html#L553'>ms</a>                553 ext/fileinfo/libmagic/apprentice.c 	file_reset(ms);</span>
<span class='curline'><a href='../S/176.html#L567'>ms</a>                567 ext/fileinfo/libmagic/apprentice.c 			mlist_free(ms-&gt;mlist[i]);</span>
<span class='curline'><a href='../S/176.html#L568'>ms</a>                568 ext/fileinfo/libmagic/apprentice.c 			if ((ms-&gt;mlist[i] = mlist_alloc()) == NULL) {</span>
<span class='curline'><a href='../S/176.html#L569'>ms</a>                569 ext/fileinfo/libmagic/apprentice.c 				file_oomem(ms, sizeof(*ms-&gt;mlist[i]));</span>
<span class='curline'><a href='../S/176.html#L573'>ms</a>                573 ext/fileinfo/libmagic/apprentice.c 		return apprentice_1(ms, fn, action);</span>
<span class='curline'><a href='../S/176.html#L577'>ms</a>                577 ext/fileinfo/libmagic/apprentice.c 		file_oomem(ms, strlen(fn));</span>
<span class='curline'><a href='../S/176.html#L582'>ms</a>                582 ext/fileinfo/libmagic/apprentice.c 		mlist_free(ms-&gt;mlist[i]);</span>
<span class='curline'><a href='../S/176.html#L583'>ms</a>                583 ext/fileinfo/libmagic/apprentice.c 		if ((ms-&gt;mlist[i] = mlist_alloc()) == NULL) {</span>
<span class='curline'><a href='../S/176.html#L584'>ms</a>                584 ext/fileinfo/libmagic/apprentice.c 			file_oomem(ms, sizeof(*ms-&gt;mlist[i]));</span>
<span class='curline'><a href='../S/176.html#L588'>ms</a>                588 ext/fileinfo/libmagic/apprentice.c 					mlist_free(ms-&gt;mlist[i]);</span>
<span class='curline'><a href='../S/176.html#L603'>ms</a>                603 ext/fileinfo/libmagic/apprentice.c 		file_err = apprentice_1(ms, fn, action);</span>
<span class='curline'><a href='../S/176.html#L612'>ms</a>                612 ext/fileinfo/libmagic/apprentice.c 			mlist_free(ms-&gt;mlist[i]);</span>
<span class='curline'><a href='../S/176.html#L613'>ms</a>                613 ext/fileinfo/libmagic/apprentice.c 			ms-&gt;mlist[i] = NULL;</span>
<span class='curline'><a href='../S/176.html#L615'>ms</a>                615 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, 0, "could not find any valid magic files!");</span>
<span class='curline'><a href='../S/176.html#L627'>ms</a>                627 ext/fileinfo/libmagic/apprentice.c 		mlist_free(ms-&gt;mlist[i]);</span>
<span class='curline'><a href='../S/176.html#L628'>ms</a>                628 ext/fileinfo/libmagic/apprentice.c 		ms-&gt;mlist[i] = NULL;</span>
<span class='curline'><a href='../S/176.html#L639'>ms</a>                639 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, 0, "Invalid action %d", action);</span>
<span class='curline'><a href='../S/176.html#L925'>ms</a>                925 ext/fileinfo/libmagic/apprentice.c addentry(struct magic_set *ms, struct magic_entry *me,</span>
<span class='curline'><a href='../S/176.html#L936'>ms</a>                936 ext/fileinfo/libmagic/apprentice.c 			file_oomem(ms, sizeof(*mp) * mset[i].max);</span>
<span class='curline'><a href='../S/176.html#L952'>ms</a>                952 ext/fileinfo/libmagic/apprentice.c load_1(struct magic_set *ms, int action, const char *fn, int *errs,</span>
<span class='curline'><a href='../S/176.html#L965'>ms</a>                965 ext/fileinfo/libmagic/apprentice.c 	ms-&gt;file = fn;</span>
<span class='curline'><a href='../S/176.html#L970'>ms</a>                970 ext/fileinfo/libmagic/apprentice.c 			file_error(ms, errno, "cannot read magic file `%s'",</span>
<span class='curline'><a href='../S/176.html#L978'>ms</a>                978 ext/fileinfo/libmagic/apprentice.c 	for (ms-&gt;line = 1; (line = php_stream_get_line(stream, buffer , BUFSIZ, &amp;len)) != NULL; ms-&gt;line++) {</span>
<span class='curline'><a href='../S/176.html#L1000'>ms</a>               1000 ext/fileinfo/libmagic/apprentice.c 					file_error(ms, 0,</span>
<span class='curline'><a href='../S/176.html#L1006'>ms</a>               1006 ext/fileinfo/libmagic/apprentice.c 					file_error(ms, 0,</span>
<span class='curline'><a href='../S/176.html#L1012'>ms</a>               1012 ext/fileinfo/libmagic/apprentice.c 				if ((*bang[i].fun)(ms, &amp;me,</span>
<span class='curline'><a href='../S/176.html#L1022'>ms</a>               1022 ext/fileinfo/libmagic/apprentice.c 			switch (parse(ms, &amp;me, line, lineno, action)) {</span>
<span class='curline'><a href='../S/176.html#L1026'>ms</a>               1026 ext/fileinfo/libmagic/apprentice.c 				(void)addentry(ms, &amp;me, mset);</span>
<span class='curline'><a href='../S/176.html#L1035'>ms</a>               1035 ext/fileinfo/libmagic/apprentice.c 		(void)addentry(ms, &amp;me, mset);</span>
<span class='curline'><a href='../S/176.html#L1051'>ms</a>               1051 ext/fileinfo/libmagic/apprentice.c set_text_binary(struct magic_set *ms, struct magic_entry *me, uint32_t nme,</span>
<span class='curline'><a href='../S/176.html#L1062'>ms</a>               1062 ext/fileinfo/libmagic/apprentice.c 		if ((ms-&gt;flags &amp; MAGIC_DEBUG) == 0)</span>
<span class='curline'><a href='../S/176.html#L1084'>ms</a>               1084 ext/fileinfo/libmagic/apprentice.c set_last_default(struct magic_set *ms, struct magic_entry *me, uint32_t nme)</span>
<span class='curline'><a href='../S/176.html#L1095'>ms</a>               1095 ext/fileinfo/libmagic/apprentice.c 				ms-&gt;line = me[i].mp-&gt;lineno;</span>
<span class='curline'><a href='../S/176.html#L1096'>ms</a>               1096 ext/fileinfo/libmagic/apprentice.c 				file_magwarn(ms,</span>
<span class='curline'><a href='../S/176.html#L1105'>ms</a>               1105 ext/fileinfo/libmagic/apprentice.c coalesce_entries(struct magic_set *ms, struct magic_entry *me, uint32_t nme,</span>
<span class='curline'><a href='../S/176.html#L1116'>ms</a>               1116 ext/fileinfo/libmagic/apprentice.c 		file_oomem(ms, slen);</span>
<span class='curline'><a href='../S/176.html#L1142'>ms</a>               1142 ext/fileinfo/libmagic/apprentice.c apprentice_load(struct magic_set *ms, const char *fn, int action)</span>
<span class='curline'><a href='../S/176.html#L1157'>ms</a>               1157 ext/fileinfo/libmagic/apprentice.c 	ms-&gt;flags |= MAGIC_CHECK;	/* Enable checks for parsed files */</span>
<span class='curline'><a href='../S/176.html#L1162'>ms</a>               1162 ext/fileinfo/libmagic/apprentice.c 		file_oomem(ms, sizeof(*map));</span>
<span class='curline'><a href='../S/176.html#L1184'>ms</a>               1184 ext/fileinfo/libmagic/apprentice.c 				file_oomem(ms,</span>
<span class='curline'><a href='../S/176.html#L1199'>ms</a>               1199 ext/fileinfo/libmagic/apprentice.c 					file_oomem(ms, mlen);</span>
<span class='curline'><a href='../S/176.html#L1210'>ms</a>               1210 ext/fileinfo/libmagic/apprentice.c 			load_1(ms, action, filearr[i], &amp;errs, mset);</span>
<span class='curline'><a href='../S/176.html#L1215'>ms</a>               1215 ext/fileinfo/libmagic/apprentice.c 		load_1(ms, action, fn, &amp;errs, mset);</span>
<span class='curline'><a href='../S/176.html#L1226'>ms</a>               1226 ext/fileinfo/libmagic/apprentice.c 			i = set_text_binary(ms, mset[j].me, mset[j].count, i);</span>
<span class='curline'><a href='../S/176.html#L1235'>ms</a>               1235 ext/fileinfo/libmagic/apprentice.c 		set_last_default(ms, mset[j].me, mset[j].count);</span>
<span class='curline'><a href='../S/176.html#L1238'>ms</a>               1238 ext/fileinfo/libmagic/apprentice.c 		if (coalesce_entries(ms, mset[j].me, mset[j].count,</span>
<span class='curline'><a href='../S/176.html#L1264'>ms</a>               1264 ext/fileinfo/libmagic/apprentice.c file_signextend(struct magic_set *ms, struct magic *m, uint64_t v)</span>
<span class='curline'><a href='../S/176.html#L1328'>ms</a>               1328 ext/fileinfo/libmagic/apprentice.c 			if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/176.html#L1329'>ms</a>               1329 ext/fileinfo/libmagic/apprentice.c 			    file_magwarn(ms, "cannot happen: m-&gt;type=%d\n",</span>
<span class='curline'><a href='../S/176.html#L1338'>ms</a>               1338 ext/fileinfo/libmagic/apprentice.c string_modifier_check(struct magic_set *ms, struct magic *m)</span>
<span class='curline'><a href='../S/176.html#L1340'>ms</a>               1340 ext/fileinfo/libmagic/apprentice.c 	if ((ms-&gt;flags &amp; MAGIC_CHECK) == 0)</span>
<span class='curline'><a href='../S/176.html#L1344'>ms</a>               1344 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms,</span>
<span class='curline'><a href='../S/176.html#L1352'>ms</a>               1352 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms,</span>
<span class='curline'><a href='../S/176.html#L1360'>ms</a>               1360 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms,</span>
<span class='curline'><a href='../S/176.html#L1368'>ms</a>               1368 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms,</span>
<span class='curline'><a href='../S/176.html#L1377'>ms</a>               1377 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms, "'/%c' not allowed on regex\n",</span>
<span class='curline'><a href='../S/176.html#L1382'>ms</a>               1382 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms, "'/%c' not allowed on regex\n",</span>
<span class='curline'><a href='../S/176.html#L1388'>ms</a>               1388 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "coding error: m-&gt;type=%d\n",</span>
<span class='curline'><a href='../S/176.html#L1448'>ms</a>               1448 ext/fileinfo/libmagic/apprentice.c check_cond(struct magic_set *ms, int cond, uint32_t cont_level)</span>
<span class='curline'><a href='../S/176.html#L1451'>ms</a>               1451 ext/fileinfo/libmagic/apprentice.c 	last_cond = ms-&gt;c.li[cont_level].last_cond;</span>
<span class='curline'><a href='../S/176.html#L1456'>ms</a>               1456 ext/fileinfo/libmagic/apprentice.c 			if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/176.html#L1457'>ms</a>               1457 ext/fileinfo/libmagic/apprentice.c 				file_magwarn(ms, "syntax error: `if'");</span>
<span class='curline'><a href='../S/176.html#L1465'>ms</a>               1465 ext/fileinfo/libmagic/apprentice.c 			if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/176.html#L1466'>ms</a>               1466 ext/fileinfo/libmagic/apprentice.c 				file_magwarn(ms, "syntax error: `elif'");</span>
<span class='curline'><a href='../S/176.html#L1474'>ms</a>               1474 ext/fileinfo/libmagic/apprentice.c 			if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/176.html#L1475'>ms</a>               1475 ext/fileinfo/libmagic/apprentice.c 				file_magwarn(ms, "syntax error: `else'");</span>
<span class='curline'><a href='../S/176.html#L1486'>ms</a>               1486 ext/fileinfo/libmagic/apprentice.c 	ms-&gt;c.li[cont_level].last_cond = last_cond;</span>
<span class='curline'><a href='../S/176.html#L1495'>ms</a>               1495 ext/fileinfo/libmagic/apprentice.c parse(struct magic_set *ms, struct magic_entry *me, const char *line,</span>
<span class='curline'><a href='../S/176.html#L1520'>ms</a>               1520 ext/fileinfo/libmagic/apprentice.c 		if (file_check_mem(ms, cont_level) == -1)</span>
<span class='curline'><a href='../S/176.html#L1526'>ms</a>               1526 ext/fileinfo/libmagic/apprentice.c 			file_magerror(ms, "No current entry for continuation");</span>
<span class='curline'><a href='../S/176.html#L1530'>ms</a>               1530 ext/fileinfo/libmagic/apprentice.c 			file_magerror(ms, "Continuations present with 0 count");</span>
<span class='curline'><a href='../S/176.html#L1536'>ms</a>               1536 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms, "New continuation level %u is more "</span>
<span class='curline'><a href='../S/176.html#L1544'>ms</a>               1544 ext/fileinfo/libmagic/apprentice.c 				file_oomem(ms, sizeof(*nm) * cnt);</span>
<span class='curline'><a href='../S/176.html#L1558'>ms</a>               1558 ext/fileinfo/libmagic/apprentice.c 			file_oomem(ms, len);</span>
<span class='curline'><a href='../S/176.html#L1587'>ms</a>               1587 ext/fileinfo/libmagic/apprentice.c 		if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/176.html#L1588'>ms</a>               1588 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms, "relative offset at level 0");</span>
<span class='curline'><a href='../S/176.html#L1593'>ms</a>               1593 ext/fileinfo/libmagic/apprentice.c 		if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/176.html#L1594'>ms</a>               1594 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms, "offset `%s' invalid", l);</span>
<span class='curline'><a href='../S/176.html#L1646'>ms</a>               1646 ext/fileinfo/libmagic/apprentice.c 				if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/176.html#L1647'>ms</a>               1647 ext/fileinfo/libmagic/apprentice.c 					file_magwarn(ms,</span>
<span class='curline'><a href='../S/176.html#L1671'>ms</a>               1671 ext/fileinfo/libmagic/apprentice.c 				if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/176.html#L1672'>ms</a>               1672 ext/fileinfo/libmagic/apprentice.c 					file_magwarn(ms,</span>
<span class='curline'><a href='../S/176.html#L1678'>ms</a>               1678 ext/fileinfo/libmagic/apprentice.c 			if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/176.html#L1679'>ms</a>               1679 ext/fileinfo/libmagic/apprentice.c 				file_magwarn(ms,</span>
<span class='curline'><a href='../S/176.html#L1686'>ms</a>               1686 ext/fileinfo/libmagic/apprentice.c 	if (check_cond(ms, m-&gt;cond, cont_level) == -1)</span>
<span class='curline'><a href='../S/176.html#L1741'>ms</a>               1741 ext/fileinfo/libmagic/apprentice.c 		if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/176.html#L1742'>ms</a>               1742 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms, "type `%s' invalid", l);</span>
<span class='curline'><a href='../S/176.html#L1757'>ms</a>               1757 ext/fileinfo/libmagic/apprentice.c 		else if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/176.html#L1758'>ms</a>               1758 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms, "'~' invalid for string types");</span>
<span class='curline'><a href='../S/176.html#L1770'>ms</a>               1770 ext/fileinfo/libmagic/apprentice.c 			m-&gt;num_mask = file_signextend(ms, m, val);</span>
<span class='curline'><a href='../S/176.html#L1782'>ms</a>               1782 ext/fileinfo/libmagic/apprentice.c 					    (ms-&gt;flags &amp; MAGIC_CHECK))</span>
<span class='curline'><a href='../S/176.html#L1783'>ms</a>               1783 ext/fileinfo/libmagic/apprentice.c 						file_magwarn(ms,</span>
<span class='curline'><a href='../S/176.html#L1789'>ms</a>               1789 ext/fileinfo/libmagic/apprentice.c 						file_magwarn(ms,</span>
<span class='curline'><a href='../S/176.html#L1851'>ms</a>               1851 ext/fileinfo/libmagic/apprentice.c 					if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/176.html#L1852'>ms</a>               1852 ext/fileinfo/libmagic/apprentice.c 						file_magwarn(ms,</span>
<span class='curline'><a href='../S/176.html#L1862'>ms</a>               1862 ext/fileinfo/libmagic/apprentice.c 			if (string_modifier_check(ms, m) == -1)</span>
<span class='curline'><a href='../S/176.html#L1866'>ms</a>               1866 ext/fileinfo/libmagic/apprentice.c 			if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/176.html#L1867'>ms</a>               1867 ext/fileinfo/libmagic/apprentice.c 				file_magwarn(ms, "invalid string op: %c", *t);</span>
<span class='curline'><a href='../S/176.html#L1883'>ms</a>               1883 ext/fileinfo/libmagic/apprentice.c 			if (ms-&gt;flags &amp; MAGIC_CHECK) {</span>
<span class='curline'><a href='../S/176.html#L1884'>ms</a>               1884 ext/fileinfo/libmagic/apprentice.c 				file_magwarn(ms, "%c= not supported",</span>
<span class='curline'><a href='../S/176.html#L1918'>ms</a>               1918 ext/fileinfo/libmagic/apprentice.c 	if (m-&gt;reln != 'x' &amp;&amp; getvalue(ms, m, &amp;l, action))</span>
<span class='curline'><a href='../S/176.html#L1943'>ms</a>               1943 ext/fileinfo/libmagic/apprentice.c 		if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/176.html#L1944'>ms</a>               1944 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms, "description `%s' truncated", m-&gt;desc);</span>
<span class='curline'><a href='../S/176.html#L1951'>ms</a>               1951 ext/fileinfo/libmagic/apprentice.c         if (ms-&gt;flags &amp; MAGIC_CHECK) {</span>
<span class='curline'><a href='../S/176.html#L1952'>ms</a>               1952 ext/fileinfo/libmagic/apprentice.c 		if (check_format(ms, m) == -1)</span>
<span class='curline'><a href='../S/176.html#L1964'>ms</a>               1964 ext/fileinfo/libmagic/apprentice.c parse_strength(struct magic_set *ms, struct magic_entry *me, const char *line)</span>
<span class='curline'><a href='../S/176.html#L1972'>ms</a>               1972 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms,</span>
<span class='curline'><a href='../S/176.html#L1978'>ms</a>               1978 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "%s: Strength setting is not supported in "</span>
<span class='curline'><a href='../S/176.html#L1992'>ms</a>               1992 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "Unknown factor op `%c'", *l);</span>
<span class='curline'><a href='../S/176.html#L1998'>ms</a>               1998 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "Too large factor `%lu'", factor);</span>
<span class='curline'><a href='../S/176.html#L2002'>ms</a>               2002 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "Bad factor `%s'", l);</span>
<span class='curline'><a href='../S/176.html#L2007'>ms</a>               2007 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "Cannot have factor op `%c' and factor %u",</span>
<span class='curline'><a href='../S/176.html#L2023'>ms</a>               2023 ext/fileinfo/libmagic/apprentice.c parse_apple(struct magic_set *ms, struct magic_entry *me, const char *line)</span>
<span class='curline'><a href='../S/176.html#L2030'>ms</a>               2030 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "Current entry already has a APPLE type "</span>
<span class='curline'><a href='../S/176.html#L2042'>ms</a>               2042 ext/fileinfo/libmagic/apprentice.c 		if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/176.html#L2043'>ms</a>               2043 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms, "APPLE type `%s' truncated %"</span>
<span class='curline'><a href='../S/176.html#L2058'>ms</a>               2058 ext/fileinfo/libmagic/apprentice.c parse_mime(struct magic_set *ms, struct magic_entry *me, const char *line)</span>
<span class='curline'><a href='../S/176.html#L2065'>ms</a>               2065 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "Current entry already has a MIME type `%s',"</span>
<span class='curline'><a href='../S/176.html#L2077'>ms</a>               2077 ext/fileinfo/libmagic/apprentice.c 		if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/176.html#L2078'>ms</a>               2078 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms, "MIME type `%s' truncated %"</span>
<span class='curline'><a href='../S/176.html#L2221'>ms</a>               2221 ext/fileinfo/libmagic/apprentice.c check_format(struct magic_set *ms, struct magic *m)</span>
<span class='curline'><a href='../S/176.html#L2236'>ms</a>               2236 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "Internal error inconsistency between "</span>
<span class='curline'><a href='../S/176.html#L2241'>ms</a>               2241 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "No format string for `%s' with description "</span>
<span class='curline'><a href='../S/176.html#L2252'>ms</a>               2252 ext/fileinfo/libmagic/apprentice.c 		file_magwarn(ms, "Printf format `%c' is not valid for type "</span>
<span class='curline'><a href='../S/176.html#L2260'>ms</a>               2260 ext/fileinfo/libmagic/apprentice.c 			file_magwarn(ms,</span>
<span class='curline'><a href='../S/176.html#L2276'>ms</a>               2276 ext/fileinfo/libmagic/apprentice.c getvalue(struct magic_set *ms, struct magic *m, const char **p, int action)</span>
<span class='curline'><a href='../S/176.html#L2287'>ms</a>               2287 ext/fileinfo/libmagic/apprentice.c 		*p = getstr(ms, m, *p, action == FILE_COMPILE);</span>
<span class='curline'><a href='../S/176.html#L2289'>ms</a>               2289 ext/fileinfo/libmagic/apprentice.c 			if (ms-&gt;flags &amp; MAGIC_CHECK)</span>
<span class='curline'><a href='../S/176.html#L2290'>ms</a>               2290 ext/fileinfo/libmagic/apprentice.c 				file_magwarn(ms, "cannot get string from `%s'",</span>
<span class='curline'><a href='../S/176.html#L2320'>ms</a>               2320 ext/fileinfo/libmagic/apprentice.c 			m-&gt;value.q = file_signextend(ms, m,</span>
<span class='curline'><a href='../S/176.html#L2336'>ms</a>               2336 ext/fileinfo/libmagic/apprentice.c getstr(struct magic_set *ms, struct magic *m, const char *s, int warn)</span>
<span class='curline'><a href='../S/176.html#L2350'>ms</a>               2350 ext/fileinfo/libmagic/apprentice.c 			file_error(ms, 0, "string too long: `%s'", origs);</span>
<span class='curline'><a href='../S/176.html#L2358'>ms</a>               2358 ext/fileinfo/libmagic/apprentice.c 					file_magwarn(ms, "incomplete escape");</span>
<span class='curline'><a href='../S/176.html#L2363'>ms</a>               2363 ext/fileinfo/libmagic/apprentice.c 					file_magwarn(ms,</span>
<span class='curline'><a href='../S/176.html#L2377'>ms</a>               2377 ext/fileinfo/libmagic/apprentice.c 							file_magwarn(ms, "no "</span>
<span class='curline'><a href='../S/176.html#L2382'>ms</a>               2382 ext/fileinfo/libmagic/apprentice.c 						file_magwarn(ms,</span>
<span class='curline'><a href='../S/176.html#L2598'>ms</a>               2598 ext/fileinfo/libmagic/apprentice.c apprentice_map(struct magic_set *ms, const char *fn)</span>
<span class='curline'><a href='../S/176.html#L2613'>ms</a>               2613 ext/fileinfo/libmagic/apprentice.c 		file_oomem(ms, sizeof(*map));</span>
<span class='curline'><a href='../S/176.html#L2632'>ms</a>               2632 ext/fileinfo/libmagic/apprentice.c 	dbname = mkdbname(ms, fn, 0);</span>
<span class='curline'><a href='../S/176.html#L2643'>ms</a>               2643 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, errno, "cannot stat `%s'", dbname);</span>
<span class='curline'><a href='../S/176.html#L2648'>ms</a>               2648 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, 0, "file `%s' is too small", dbname);</span>
<span class='curline'><a href='../S/176.html#L2654'>ms</a>               2654 ext/fileinfo/libmagic/apprentice.c 		file_oomem(ms, map-&gt;len);</span>
<span class='curline'><a href='../S/176.html#L2658'>ms</a>               2658 ext/fileinfo/libmagic/apprentice.c 		file_badread(ms);</span>
<span class='curline'><a href='../S/176.html#L2671'>ms</a>               2671 ext/fileinfo/libmagic/apprentice.c 			file_error(ms, 0, "bad magic in `%s'", dbname);</span>
<span class='curline'><a href='../S/176.html#L2682'>ms</a>               2682 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, 0, "File %d.%d supports only version %d magic "</span>
<span class='curline'><a href='../S/176.html#L2700'>ms</a>               2700 ext/fileinfo/libmagic/apprentice.c 			file_error(ms, 0, "Size of `%s' %llu is not a multiple of %zu",</span>
<span class='curline'><a href='../S/176.html#L2718'>ms</a>               2718 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, 0, "Inconsistent entries in `%s' %u != %u",</span>
<span class='curline'><a href='../S/176.html#L2751'>ms</a>               2751 ext/fileinfo/libmagic/apprentice.c apprentice_compile(struct magic_set *ms, struct magic_map *map, const char *fn)</span>
<span class='curline'><a href='../S/176.html#L2764'>ms</a>               2764 ext/fileinfo/libmagic/apprentice.c 	dbname = mkdbname(ms, fn, 0);</span>
<span class='curline'><a href='../S/176.html#L2773'>ms</a>               2773 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, errno, "cannot open `%s'", dbname);</span>
<span class='curline'><a href='../S/176.html#L2778'>ms</a>               2778 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, errno, "error writing `%s'", dbname);</span>
<span class='curline'><a href='../S/176.html#L2783'>ms</a>               2783 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, errno, "error writing `%s'", dbname);</span>
<span class='curline'><a href='../S/176.html#L2790'>ms</a>               2790 ext/fileinfo/libmagic/apprentice.c 		file_error(ms, errno, "error seeking `%s'", dbname);</span>
<span class='curline'><a href='../S/176.html#L2797'>ms</a>               2797 ext/fileinfo/libmagic/apprentice.c 			file_error(ms, errno, "error writing `%s'", dbname);</span>
<span class='curline'><a href='../S/176.html#L2817'>ms</a>               2817 ext/fileinfo/libmagic/apprentice.c mkdbname(struct magic_set *ms, const char *fn, int strip)</span>
<span class='curline'><a href='../S/176.html#L2842'>ms</a>               2842 ext/fileinfo/libmagic/apprentice.c 	if (ms-&gt;flags &amp; MAGIC_MIME) {</span>
<span class='curline'><a href='../S/176.html#L2849'>ms</a>               2849 ext/fileinfo/libmagic/apprentice.c 			ms-&gt;flags &amp;= MAGIC_MIME_TYPE;</span>
<span class='curline'><a href='../S/176.html#L2858'>ms</a>               2858 ext/fileinfo/libmagic/apprentice.c 		ms-&gt;flags &amp;= MAGIC_MIME_TYPE;</span>
<span class='curline'><a href='../S/176.html#L3003'>ms</a>               3003 ext/fileinfo/libmagic/apprentice.c file_magicfind(struct magic_set *ms, const char *name, struct mlist *v)</span>
<span class='curline'><a href='../S/176.html#L3008'>ms</a>               3008 ext/fileinfo/libmagic/apprentice.c 	mlist = ms-&gt;mlist[1];</span>
<span class='curline'><a href='../S/177.html#L45'>ms</a>                 45 ext/fileinfo/libmagic/apptype.c file_os2_apptype(struct magic_set *ms, const char *fn, const void *buf,</span>
<span class='curline'><a href='../S/177.html#L57'>ms</a>                 57 ext/fileinfo/libmagic/apptype.c 		file_error(ms, errno, "cannot create tempnam");</span>
<span class='curline'><a href='../S/177.html#L69'>ms</a>                 69 ext/fileinfo/libmagic/apptype.c 			file_error(ms, errno, "cannot open tmp file `%s'", path);</span>
<span class='curline'><a href='../S/177.html#L73'>ms</a>                 73 ext/fileinfo/libmagic/apptype.c 			file_error(ms, errno, "cannot write tmp file `%s'",</span>
<span class='curline'><a href='../S/177.html#L109'>ms</a>                109 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, "32-bit ") == -1)</span>
<span class='curline'><a href='../S/177.html#L112'>ms</a>                112 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, "physical device driver") == -1)</span>
<span class='curline'><a href='../S/177.html#L115'>ms</a>                115 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, "virtual device driver") == -1)</span>
<span class='curline'><a href='../S/177.html#L119'>ms</a>                119 ext/fileinfo/libmagic/apptype.c 			if (file_printf(ms, "protected ") == -1)</span>
<span class='curline'><a href='../S/177.html#L121'>ms</a>                121 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, "DLL") == -1)</span>
<span class='curline'><a href='../S/177.html#L124'>ms</a>                124 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, "Windows executable") == -1)</span>
<span class='curline'><a href='../S/177.html#L134'>ms</a>                134 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, "DOS executable") == -1)</span>
<span class='curline'><a href='../S/177.html#L138'>ms</a>                138 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, ", magic(4)-&gt; ") == -1)</span>
<span class='curline'><a href='../S/177.html#L143'>ms</a>                143 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, "bound executable") == -1)</span>
<span class='curline'><a href='../S/177.html#L146'>ms</a>                146 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, "PM executable") == -1)</span>
<span class='curline'><a href='../S/177.html#L148'>ms</a>                148 ext/fileinfo/libmagic/apptype.c 	} else if (file_printf(ms, "OS/2 executable") == -1)</span>
<span class='curline'><a href='../S/177.html#L155'>ms</a>                155 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, " [NOTWINDOWCOMPAT]") == -1)</span>
<span class='curline'><a href='../S/177.html#L159'>ms</a>                159 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, " [WINDOWCOMPAT]") == -1)</span>
<span class='curline'><a href='../S/177.html#L163'>ms</a>                163 ext/fileinfo/libmagic/apptype.c 		if (file_printf(ms, " [WINDOWAPI]") == -1)</span>
<span class='curline'><a href='../S/178.html#L71'>ms</a>                 71 ext/fileinfo/libmagic/ascmagic.c file_ascmagic(struct magic_set *ms, const unsigned char *buf, size_t nbytes,</span>
<span class='curline'><a href='../S/178.html#L82'>ms</a>                 82 ext/fileinfo/libmagic/ascmagic.c 	if (ms-&gt;flags &amp; MAGIC_APPLE)</span>
<span class='curline'><a href='../S/178.html#L88'>ms</a>                 88 ext/fileinfo/libmagic/ascmagic.c 	if (file_encoding(ms, buf, nbytes, &amp;ubuf, &amp;ulen, &amp;code, &amp;code_mime,</span>
<span class='curline'><a href='../S/178.html#L92'>ms</a>                 92 ext/fileinfo/libmagic/ascmagic.c 		rv = file_ascmagic_with_encoding(ms, buf, nbytes, ubuf, ulen, code,</span>
<span class='curline'><a href='../S/178.html#L101'>ms</a>                101 ext/fileinfo/libmagic/ascmagic.c file_ascmagic_with_encoding(struct magic_set *ms, const unsigned char *buf,</span>
<span class='curline'><a href='../S/178.html#L108'>ms</a>                108 ext/fileinfo/libmagic/ascmagic.c 	int mime = ms-&gt;flags &amp; MAGIC_MIME;</span>
<span class='curline'><a href='../S/178.html#L126'>ms</a>                126 ext/fileinfo/libmagic/ascmagic.c 	if (ms-&gt;flags &amp; MAGIC_APPLE)</span>
<span class='curline'><a href='../S/178.html#L137'>ms</a>                137 ext/fileinfo/libmagic/ascmagic.c 	if (ulen &gt; 0 &amp;&amp; (ms-&gt;flags &amp; MAGIC_NO_CHECK_SOFT) == 0) {</span>
<span class='curline'><a href='../S/178.html#L143'>ms</a>                143 ext/fileinfo/libmagic/ascmagic.c 			file_oomem(ms, mlen);</span>
<span class='curline'><a href='../S/178.html#L149'>ms</a>                149 ext/fileinfo/libmagic/ascmagic.c 		if ((rv = file_softmagic(ms, utf8_buf,</span>
<span class='curline'><a href='../S/178.html#L196'>ms</a>                196 ext/fileinfo/libmagic/ascmagic.c 		if (!file_printedlen(ms) &amp;&amp; (mime &amp; MAGIC_MIME_TYPE) != 0) {</span>
<span class='curline'><a href='../S/178.html#L198'>ms</a>                198 ext/fileinfo/libmagic/ascmagic.c 				if (file_printf(ms, "%s", subtype_mime) == -1)</span>
<span class='curline'><a href='../S/178.html#L201'>ms</a>                201 ext/fileinfo/libmagic/ascmagic.c 				if (file_printf(ms, "text/plain") == -1)</span>
<span class='curline'><a href='../S/178.html#L206'>ms</a>                206 ext/fileinfo/libmagic/ascmagic.c 		if (file_printedlen(ms)) {</span>
<span class='curline'><a href='../S/178.html#L207'>ms</a>                207 ext/fileinfo/libmagic/ascmagic.c 			switch (file_replace(ms, " text$", ", ")) {</span>
<span class='curline'><a href='../S/178.html#L209'>ms</a>                209 ext/fileinfo/libmagic/ascmagic.c 				switch (file_replace(ms, " text executable$",</span>
<span class='curline'><a href='../S/178.html#L212'>ms</a>                212 ext/fileinfo/libmagic/ascmagic.c 					if (file_printf(ms, ", ") == -1)</span>
<span class='curline'><a href='../S/178.html#L229'>ms</a>                229 ext/fileinfo/libmagic/ascmagic.c 		if (file_printf(ms, "%s", code) == -1)</span>
<span class='curline'><a href='../S/178.html#L233'>ms</a>                233 ext/fileinfo/libmagic/ascmagic.c 			if (file_printf(ms, " %s", subtype) == -1)</span>
<span class='curline'><a href='../S/178.html#L237'>ms</a>                237 ext/fileinfo/libmagic/ascmagic.c 		if (file_printf(ms, " %s", type) == -1)</span>
<span class='curline'><a href='../S/178.html#L241'>ms</a>                241 ext/fileinfo/libmagic/ascmagic.c 			if (file_printf(ms, " executable") == -1)</span>
<span class='curline'><a href='../S/178.html#L245'>ms</a>                245 ext/fileinfo/libmagic/ascmagic.c 			if (file_printf(ms, ", with very long lines") == -1)</span>
<span class='curline'><a href='../S/178.html#L254'>ms</a>                254 ext/fileinfo/libmagic/ascmagic.c 			if (file_printf(ms, ", with") == -1)</span>
<span class='curline'><a href='../S/178.html#L258'>ms</a>                258 ext/fileinfo/libmagic/ascmagic.c 				if (file_printf(ms, " no") == -1)</span>
<span class='curline'><a href='../S/178.html#L262'>ms</a>                262 ext/fileinfo/libmagic/ascmagic.c 					if (file_printf(ms, " CRLF") == -1)</span>
<span class='curline'><a href='../S/178.html#L265'>ms</a>                265 ext/fileinfo/libmagic/ascmagic.c 						if (file_printf(ms, ",") == -1)</span>
<span class='curline'><a href='../S/178.html#L269'>ms</a>                269 ext/fileinfo/libmagic/ascmagic.c 					if (file_printf(ms, " CR") == -1)</span>
<span class='curline'><a href='../S/178.html#L272'>ms</a>                272 ext/fileinfo/libmagic/ascmagic.c 						if (file_printf(ms, ",") == -1)</span>
<span class='curline'><a href='../S/178.html#L276'>ms</a>                276 ext/fileinfo/libmagic/ascmagic.c 					if (file_printf(ms, " LF") == -1)</span>
<span class='curline'><a href='../S/178.html#L279'>ms</a>                279 ext/fileinfo/libmagic/ascmagic.c 						if (file_printf(ms, ",") == -1)</span>
<span class='curline'><a href='../S/178.html#L283'>ms</a>                283 ext/fileinfo/libmagic/ascmagic.c 					if (file_printf(ms, " NEL") == -1)</span>
<span class='curline'><a href='../S/178.html#L287'>ms</a>                287 ext/fileinfo/libmagic/ascmagic.c 			if (file_printf(ms, " line terminators") == -1)</span>
<span class='curline'><a href='../S/178.html#L292'>ms</a>                292 ext/fileinfo/libmagic/ascmagic.c 			if (file_printf(ms, ", with escape sequences") == -1)</span>
<span class='curline'><a href='../S/178.html#L295'>ms</a>                295 ext/fileinfo/libmagic/ascmagic.c 			if (file_printf(ms, ", with overstriking") == -1)</span>
<span class='curline'><a href='../S/182.html#L103'>ms</a>                103 ext/fileinfo/libmagic/compress.c file_zmagic(struct magic_set *ms, int fd, const char *name,</span>
<span class='curline'><a href='../S/182.html#L109'>ms</a>                109 ext/fileinfo/libmagic/compress.c 	int mime = ms-&gt;flags &amp; MAGIC_MIME;</span>
<span class='curline'><a href='../S/182.html#L112'>ms</a>                112 ext/fileinfo/libmagic/compress.c 	if ((ms-&gt;flags &amp; MAGIC_COMPRESS) == 0)</span>
<span class='curline'><a href='../S/182.html#L121'>ms</a>                121 ext/fileinfo/libmagic/compress.c 		    (nsz = uncompressbuf(ms, fd, i, buf, &amp;newbuf,</span>
<span class='curline'><a href='../S/182.html#L123'>ms</a>                123 ext/fileinfo/libmagic/compress.c 			ms-&gt;flags &amp;= ~MAGIC_COMPRESS;</span>
<span class='curline'><a href='../S/182.html#L125'>ms</a>                125 ext/fileinfo/libmagic/compress.c 			if (file_buffer(ms, -1, name, newbuf, nsz) == -1)</span>
<span class='curline'><a href='../S/182.html#L129'>ms</a>                129 ext/fileinfo/libmagic/compress.c 				if (file_printf(ms, mime ?</span>
<span class='curline'><a href='../S/182.html#L132'>ms</a>                132 ext/fileinfo/libmagic/compress.c 				if (file_buffer(ms, -1, NULL, buf, nbytes) == -1)</span>
<span class='curline'><a href='../S/182.html#L134'>ms</a>                134 ext/fileinfo/libmagic/compress.c 				if (!mime &amp;&amp; file_printf(ms, ")") == -1)</span>
<span class='curline'><a href='../S/182.html#L145'>ms</a>                145 ext/fileinfo/libmagic/compress.c 	ms-&gt;flags |= MAGIC_COMPRESS;</span>
<span class='curline'><a href='../S/182.html#L243'>ms</a>                243 ext/fileinfo/libmagic/compress.c file_pipe2file(struct magic_set *ms, int fd, const void *startbuf,</span>
<span class='curline'><a href='../S/182.html#L269'>ms</a>                269 ext/fileinfo/libmagic/compress.c 		file_error(ms, errno,</span>
<span class='curline'><a href='../S/182.html#L284'>ms</a>                284 ext/fileinfo/libmagic/compress.c 		file_error(ms, errno, "error copying from pipe to temp file");</span>
<span class='curline'><a href='../S/182.html#L289'>ms</a>                289 ext/fileinfo/libmagic/compress.c 		file_error(ms, errno, "error while writing to temp file");</span>
<span class='curline'><a href='../S/182.html#L299'>ms</a>                299 ext/fileinfo/libmagic/compress.c 		file_error(ms, errno, "could not dup descriptor for temp file");</span>
<span class='curline'><a href='../S/182.html#L304'>ms</a>                304 ext/fileinfo/libmagic/compress.c 		file_badseek(ms);</span>
<span class='curline'><a href='../S/182.html#L319'>ms</a>                319 ext/fileinfo/libmagic/compress.c uncompressgzipped(struct magic_set *ms, const unsigned char *old,</span>
<span class='curline'><a href='../S/182.html#L364'>ms</a>                364 ext/fileinfo/libmagic/compress.c 		file_error(ms, 0, "zlib: %s", z.msg);</span>
<span class='curline'><a href='../S/182.html#L370'>ms</a>                370 ext/fileinfo/libmagic/compress.c 		file_error(ms, 0, "zlib: %s", z.msg);</span>
<span class='curline'><a href='../S/182.html#L385'>ms</a>                385 ext/fileinfo/libmagic/compress.c uncompressbuf(struct magic_set *ms, int fd, size_t method,</span>
<span class='curline'><a href='../S/182.html#L395'>ms</a>                395 ext/fileinfo/libmagic/compress.c 		return uncompressgzipped(ms, old, newch, n);</span>
<span class='curline'><a href='../S/182.html#L401'>ms</a>                401 ext/fileinfo/libmagic/compress.c 		file_error(ms, errno, "cannot create pipe");	</span>
<span class='curline'><a href='../S/182.html#L434'>ms</a>                434 ext/fileinfo/libmagic/compress.c 		file_error(ms, errno, "could not fork");</span>
<span class='curline'><a href='../S/184.html#L39'>ms</a>                 39 ext/fileinfo/libmagic/elfclass.h 		if (dophn_core(ms, clazz, swap, fd,</span>
<span class='curline'><a href='../S/184.html#L49'>ms</a>                 49 ext/fileinfo/libmagic/elfclass.h 		if (dophn_exec(ms, clazz, swap, fd,</span>
<span class='curline'><a href='../S/184.html#L58'>ms</a>                 58 ext/fileinfo/libmagic/elfclass.h 		if (doshn(ms, clazz, swap, fd,</span>
<span class='curline'><a href='../S/185.html#L68'>ms</a>                 68 ext/fileinfo/libmagic/encoding.c file_encoding(struct magic_set *ms, const unsigned char *buf, size_t nbytes, unichar **ubuf, size_t *ulen, const char **code, const char **code_mime, const char **type)</span>
<span class='curline'><a href='../S/185.html#L81'>ms</a>                 81 ext/fileinfo/libmagic/encoding.c 		file_oomem(ms, mlen);</span>
<span class='curline'><a href='../S/185.html#L86'>ms</a>                 86 ext/fileinfo/libmagic/encoding.c 		file_oomem(ms, mlen);</span>
<span class='curline'><a href='../S/186.html#L459'>ms</a>                459 ext/fileinfo/libmagic/file.h protected size_t file_printedlen(const struct magic_set *ms);</span>
<span class='curline'><a href='../S/187.html#L78'>ms</a>                 78 ext/fileinfo/libmagic/fsmagic.c handle_mime(struct magic_set *ms, int mime, const char *str)</span>
<span class='curline'><a href='../S/187.html#L81'>ms</a>                 81 ext/fileinfo/libmagic/fsmagic.c 		if (file_printf(ms, "inode/%s", str) == -1)</span>
<span class='curline'><a href='../S/187.html#L83'>ms</a>                 83 ext/fileinfo/libmagic/fsmagic.c 		if ((mime &amp; MAGIC_MIME_ENCODING) &amp;&amp; file_printf(ms,</span>
<span class='curline'><a href='../S/187.html#L87'>ms</a>                 87 ext/fileinfo/libmagic/fsmagic.c 	if ((mime &amp; MAGIC_MIME_ENCODING) &amp;&amp; file_printf(ms, "binary") == -1)</span>
<span class='curline'><a href='../S/187.html#L93'>ms</a>                 93 ext/fileinfo/libmagic/fsmagic.c file_fsmagic(struct magic_set *ms, const char *fn, struct stat *sb, php_stream *stream)</span>
<span class='curline'><a href='../S/187.html#L96'>ms</a>                 96 ext/fileinfo/libmagic/fsmagic.c 	int mime = ms-&gt;flags &amp; MAGIC_MIME;</span>
<span class='curline'><a href='../S/187.html#L99'>ms</a>                 99 ext/fileinfo/libmagic/fsmagic.c 	if (ms-&gt;flags &amp; MAGIC_APPLE)</span>
<span class='curline'><a href='../S/187.html#L111'>ms</a>                111 ext/fileinfo/libmagic/fsmagic.c 			if (ms-&gt;flags &amp; MAGIC_ERROR) {</span>
<span class='curline'><a href='../S/187.html#L112'>ms</a>                112 ext/fileinfo/libmagic/fsmagic.c 				file_error(ms, errno, "cannot stat `%s'", fn);</span>
<span class='curline'><a href='../S/187.html#L120'>ms</a>                120 ext/fileinfo/libmagic/fsmagic.c 			if (ms-&gt;flags &amp; MAGIC_ERROR) {</span>
<span class='curline'><a href='../S/187.html#L121'>ms</a>                121 ext/fileinfo/libmagic/fsmagic.c 				file_error(ms, errno, "cannot stat `%s'", fn);</span>
<span class='curline'><a href='../S/187.html#L132'>ms</a>                132 ext/fileinfo/libmagic/fsmagic.c 			if (file_printf(ms, "%ssetuid", COMMA) == -1)</span>
<span class='curline'><a href='../S/187.html#L137'>ms</a>                137 ext/fileinfo/libmagic/fsmagic.c 			if (file_printf(ms, "%ssetgid", COMMA) == -1)</span>
<span class='curline'><a href='../S/187.html#L142'>ms</a>                142 ext/fileinfo/libmagic/fsmagic.c 			if (file_printf(ms, "%ssticky", COMMA) == -1)</span>
<span class='curline'><a href='../S/187.html#L156'>ms</a>                156 ext/fileinfo/libmagic/fsmagic.c 			if ((ms-&gt;flags &amp; MAGIC_DEVICES) != 0) {</span>
<span class='curline'><a href='../S/187.html#L161'>ms</a>                161 ext/fileinfo/libmagic/fsmagic.c 				if (handle_mime(ms, mime, "chardevice") == -1)</span>
<span class='curline'><a href='../S/187.html#L166'>ms</a>                166 ext/fileinfo/libmagic/fsmagic.c 			if (file_printf(ms, "%scharacter special (%d/%d/%d)",</span>
<span class='curline'><a href='../S/187.html#L171'>ms</a>                171 ext/fileinfo/libmagic/fsmagic.c 			if (file_printf(ms, "%scharacter special (%ld/%ld)",</span>
<span class='curline'><a href='../S/187.html#L177'>ms</a>                177 ext/fileinfo/libmagic/fsmagic.c 			if (file_printf(ms, "%scharacter special", COMMA) == -1)</span>
<span class='curline'><a href='../S/187.html#L187'>ms</a>                187 ext/fileinfo/libmagic/fsmagic.c 		if((ms-&gt;flags &amp; MAGIC_DEVICES) != 0)</span>
<span class='curline'><a href='../S/187.html#L190'>ms</a>                190 ext/fileinfo/libmagic/fsmagic.c 			if (handle_mime(ms, mime, "fifo") == -1)</span>
<span class='curline'><a href='../S/187.html#L192'>ms</a>                192 ext/fileinfo/libmagic/fsmagic.c 		} else if (file_printf(ms, "%sfifo (named pipe)", COMMA) == -1)</span>
<span class='curline'><a href='../S/187.html#L199'>ms</a>                199 ext/fileinfo/libmagic/fsmagic.c 			if (handle_mime(ms, mime, "door") == -1)</span>
<span class='curline'><a href='../S/187.html#L201'>ms</a>                201 ext/fileinfo/libmagic/fsmagic.c 		} else if (file_printf(ms, "%sdoor", COMMA) == -1)</span>
<span class='curline'><a href='../S/187.html#L208'>ms</a>                208 ext/fileinfo/libmagic/fsmagic.c 			if (ms-&gt;flags &amp; MAGIC_ERROR) {</span>
<span class='curline'><a href='../S/187.html#L209'>ms</a>                209 ext/fileinfo/libmagic/fsmagic.c 			    file_error(ms, errno, "unreadable symlink `%s'", fn);</span>
<span class='curline'><a href='../S/187.html#L219'>ms</a>                219 ext/fileinfo/libmagic/fsmagic.c 			if (handle_mime(ms, mime, "socket") == -1)</span>
<span class='curline'><a href='../S/187.html#L221'>ms</a>                221 ext/fileinfo/libmagic/fsmagic.c 		} else if (file_printf(ms, "%ssocket", COMMA) == -1)</span>
<span class='curline'><a href='../S/187.html#L239'>ms</a>                239 ext/fileinfo/libmagic/fsmagic.c 	if ((ms-&gt;flags &amp; MAGIC_DEVICES) == 0 &amp;&amp; sb-&gt;st_size == 0) {</span>
<span class='curline'><a href='../S/187.html#L241'>ms</a>                241 ext/fileinfo/libmagic/fsmagic.c 			if (handle_mime(ms, mime, "x-empty") == -1)</span>
<span class='curline'><a href='../S/187.html#L243'>ms</a>                243 ext/fileinfo/libmagic/fsmagic.c 			} else if (file_printf(ms, "%sempty", COMMA) == -1)</span>
<span class='curline'><a href='../S/187.html#L251'>ms</a>                251 ext/fileinfo/libmagic/fsmagic.c 		file_error(ms, 0, "invalid mode 0%o", sb-&gt;st_mode);</span>
<span class='curline'><a href='../S/188.html#L62'>ms</a>                 62 ext/fileinfo/libmagic/funcs.c file_printf(struct magic_set *ms, const char *fmt, ...)</span>
<span class='curline'><a href='../S/188.html#L72'>ms</a>                 72 ext/fileinfo/libmagic/funcs.c 	if (ms-&gt;o.buf != NULL) {</span>
<span class='curline'><a href='../S/188.html#L73'>ms</a>                 73 ext/fileinfo/libmagic/funcs.c 		len = spprintf(&amp;newstr, 0, "%s%s", ms-&gt;o.buf, (buf ? buf : ""));</span>
<span class='curline'><a href='../S/188.html#L77'>ms</a>                 77 ext/fileinfo/libmagic/funcs.c 		efree(ms-&gt;o.buf);</span>
<span class='curline'><a href='../S/188.html#L78'>ms</a>                 78 ext/fileinfo/libmagic/funcs.c 		ms-&gt;o.buf = newstr;</span>
<span class='curline'><a href='../S/188.html#L80'>ms</a>                 80 ext/fileinfo/libmagic/funcs.c 		ms-&gt;o.buf = buf;</span>
<span class='curline'><a href='../S/188.html#L90'>ms</a>                 90 ext/fileinfo/libmagic/funcs.c file_error_core(struct magic_set *ms, int error, const char *f, va_list va,</span>
<span class='curline'><a href='../S/188.html#L96'>ms</a>                 96 ext/fileinfo/libmagic/funcs.c 	if (ms-&gt;event_flags &amp; EVENT_HAD_ERR)</span>
<span class='curline'><a href='../S/188.html#L99'>ms</a>                 99 ext/fileinfo/libmagic/funcs.c 		efree(ms-&gt;o.buf);</span>
<span class='curline'><a href='../S/188.html#L100'>ms</a>                100 ext/fileinfo/libmagic/funcs.c 		ms-&gt;o.buf = NULL;</span>
<span class='curline'><a href='../S/188.html#L101'>ms</a>                101 ext/fileinfo/libmagic/funcs.c 		file_printf(ms, "line %" SIZE_T_FORMAT "u: ", lineno);</span>
<span class='curline'><a href='../S/188.html#L108'>ms</a>                108 ext/fileinfo/libmagic/funcs.c 		file_printf(ms, "%s (%s)", (*buf ? buf : ""), strerror(error));</span>
<span class='curline'><a href='../S/188.html#L110'>ms</a>                110 ext/fileinfo/libmagic/funcs.c 		file_printf(ms, "%s", buf);</span>
<span class='curline'><a href='../S/188.html#L117'>ms</a>                117 ext/fileinfo/libmagic/funcs.c 	ms-&gt;event_flags |= EVENT_HAD_ERR;</span>
<span class='curline'><a href='../S/188.html#L118'>ms</a>                118 ext/fileinfo/libmagic/funcs.c 	ms-&gt;error = error;</span>
<span class='curline'><a href='../S/188.html#L123'>ms</a>                123 ext/fileinfo/libmagic/funcs.c file_error(struct magic_set *ms, int error, const char *f, ...)</span>
<span class='curline'><a href='../S/188.html#L127'>ms</a>                127 ext/fileinfo/libmagic/funcs.c 	file_error_core(ms, error, f, va, 0);</span>
<span class='curline'><a href='../S/188.html#L136'>ms</a>                136 ext/fileinfo/libmagic/funcs.c file_magerror(struct magic_set *ms, const char *f, ...)</span>
<span class='curline'><a href='../S/188.html#L140'>ms</a>                140 ext/fileinfo/libmagic/funcs.c 	file_error_core(ms, 0, f, va, ms-&gt;line);</span>
<span class='curline'><a href='../S/188.html#L145'>ms</a>                145 ext/fileinfo/libmagic/funcs.c file_oomem(struct magic_set *ms, size_t len)</span>
<span class='curline'><a href='../S/188.html#L147'>ms</a>                147 ext/fileinfo/libmagic/funcs.c 	file_error(ms, errno, "cannot allocate %" SIZE_T_FORMAT "u bytes",</span>
<span class='curline'><a href='../S/188.html#L152'>ms</a>                152 ext/fileinfo/libmagic/funcs.c file_badseek(struct magic_set *ms)</span>
<span class='curline'><a href='../S/188.html#L154'>ms</a>                154 ext/fileinfo/libmagic/funcs.c 	file_error(ms, errno, "error seeking");</span>
<span class='curline'><a href='../S/188.html#L158'>ms</a>                158 ext/fileinfo/libmagic/funcs.c file_badread(struct magic_set *ms)</span>
<span class='curline'><a href='../S/188.html#L160'>ms</a>                160 ext/fileinfo/libmagic/funcs.c 	file_error(ms, errno, "error reading");</span>
<span class='curline'><a href='../S/188.html#L164'>ms</a>                164 ext/fileinfo/libmagic/funcs.c file_buffer(struct magic_set *ms, php_stream *stream, const char *inname, const void *buf,</span>
<span class='curline'><a href='../S/188.html#L168'>ms</a>                168 ext/fileinfo/libmagic/funcs.c 	int mime = ms-&gt;flags &amp; MAGIC_MIME;</span>
<span class='curline'><a href='../S/188.html#L187'>ms</a>                187 ext/fileinfo/libmagic/funcs.c 	if ((ms-&gt;flags &amp; MAGIC_NO_CHECK_ENCODING) == 0) {</span>
<span class='curline'><a href='../S/188.html#L188'>ms</a>                188 ext/fileinfo/libmagic/funcs.c 		looks_text = file_encoding(ms, ubuf, nb, &amp;u8buf, &amp;ulen,</span>
<span class='curline'><a href='../S/188.html#L193'>ms</a>                193 ext/fileinfo/libmagic/funcs.c 	if ((ms-&gt;flags &amp; MAGIC_NO_CHECK_APPTYPE) == 0 &amp;&amp; inname) {</span>
<span class='curline'><a href='../S/188.html#L194'>ms</a>                194 ext/fileinfo/libmagic/funcs.c 		switch (file_os2_apptype(ms, inname, buf, nb)) {</span>
<span class='curline'><a href='../S/188.html#L206'>ms</a>                206 ext/fileinfo/libmagic/funcs.c 	if ((ms-&gt;flags &amp; MAGIC_NO_CHECK_COMPRESS) == 0)</span>
<span class='curline'><a href='../S/188.html#L207'>ms</a>                207 ext/fileinfo/libmagic/funcs.c 		if ((m = file_zmagic(ms, stream, inname, ubuf, nb)) != 0) {</span>
<span class='curline'><a href='../S/188.html#L208'>ms</a>                208 ext/fileinfo/libmagic/funcs.c 			if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/188.html#L214'>ms</a>                214 ext/fileinfo/libmagic/funcs.c 	if ((ms-&gt;flags &amp; MAGIC_NO_CHECK_TAR) == 0)</span>
<span class='curline'><a href='../S/188.html#L215'>ms</a>                215 ext/fileinfo/libmagic/funcs.c 		if ((m = file_is_tar(ms, ubuf, nb)) != 0) {</span>
<span class='curline'><a href='../S/188.html#L216'>ms</a>                216 ext/fileinfo/libmagic/funcs.c 			if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/188.html#L222'>ms</a>                222 ext/fileinfo/libmagic/funcs.c 	if ((ms-&gt;flags &amp; MAGIC_NO_CHECK_CDF) == 0) {</span>
<span class='curline'><a href='../S/188.html#L226'>ms</a>                226 ext/fileinfo/libmagic/funcs.c 			if ((m = file_trycdf(ms, fd, ubuf, nb)) != 0) {</span>
<span class='curline'><a href='../S/188.html#L227'>ms</a>                227 ext/fileinfo/libmagic/funcs.c 				if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/188.html#L235'>ms</a>                235 ext/fileinfo/libmagic/funcs.c 	if ((ms-&gt;flags &amp; MAGIC_NO_CHECK_SOFT) == 0)</span>
<span class='curline'><a href='../S/188.html#L236'>ms</a>                236 ext/fileinfo/libmagic/funcs.c 		if ((m = file_softmagic(ms, ubuf, nb, 0, BINTEST,</span>
<span class='curline'><a href='../S/188.html#L238'>ms</a>                238 ext/fileinfo/libmagic/funcs.c 			if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/188.html#L241'>ms</a>                241 ext/fileinfo/libmagic/funcs.c 			if ((ms-&gt;flags &amp; MAGIC_NO_CHECK_ELF) == 0 &amp;&amp; m == 1 &amp;&amp;</span>
<span class='curline'><a href='../S/188.html#L252'>ms</a>                252 ext/fileinfo/libmagic/funcs.c 				if ((m = file_tryelf(ms, fd, ubuf, nb)) != 0)</span>
<span class='curline'><a href='../S/188.html#L253'>ms</a>                253 ext/fileinfo/libmagic/funcs.c 					if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/188.html#L262'>ms</a>                262 ext/fileinfo/libmagic/funcs.c 	if ((ms-&gt;flags &amp; MAGIC_NO_CHECK_TEXT) == 0) {</span>
<span class='curline'><a href='../S/188.html#L264'>ms</a>                264 ext/fileinfo/libmagic/funcs.c 		if ((m = file_ascmagic(ms, ubuf, nb, looks_text)) != 0) {</span>
<span class='curline'><a href='../S/188.html#L265'>ms</a>                265 ext/fileinfo/libmagic/funcs.c 			if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/188.html#L271'>ms</a>                271 ext/fileinfo/libmagic/funcs.c 		if ((ms-&gt;flags &amp; MAGIC_NO_CHECK_ENCODING) == 0) {</span>
<span class='curline'><a href='../S/188.html#L273'>ms</a>                273 ext/fileinfo/libmagic/funcs.c 				if ((m = file_ascmagic_with_encoding( ms, ubuf,</span>
<span class='curline'><a href='../S/188.html#L276'>ms</a>                276 ext/fileinfo/libmagic/funcs.c 					if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/188.html#L288'>ms</a>                288 ext/fileinfo/libmagic/funcs.c 	    file_printf(ms, "%s", mime ? type : def) == -1) {</span>
<span class='curline'><a href='../S/188.html#L292'>ms</a>                292 ext/fileinfo/libmagic/funcs.c 	if ((ms-&gt;flags &amp; MAGIC_MIME_ENCODING) != 0) {</span>
<span class='curline'><a href='../S/188.html#L293'>ms</a>                293 ext/fileinfo/libmagic/funcs.c 		if (ms-&gt;flags &amp; MAGIC_MIME_TYPE)</span>
<span class='curline'><a href='../S/188.html#L294'>ms</a>                294 ext/fileinfo/libmagic/funcs.c 			if (file_printf(ms, "; charset=") == -1)</span>
<span class='curline'><a href='../S/188.html#L296'>ms</a>                296 ext/fileinfo/libmagic/funcs.c 		if (file_printf(ms, "%s", code_mime) == -1)</span>
<span class='curline'><a href='../S/188.html#L308'>ms</a>                308 ext/fileinfo/libmagic/funcs.c file_reset(struct magic_set *ms)</span>
<span class='curline'><a href='../S/188.html#L310'>ms</a>                310 ext/fileinfo/libmagic/funcs.c 	if (ms-&gt;mlist[0] == NULL) {</span>
<span class='curline'><a href='../S/188.html#L311'>ms</a>                311 ext/fileinfo/libmagic/funcs.c 		file_error(ms, 0, "no magic files loaded");</span>
<span class='curline'><a href='../S/188.html#L314'>ms</a>                314 ext/fileinfo/libmagic/funcs.c 	if (ms-&gt;o.buf) {</span>
<span class='curline'><a href='../S/188.html#L315'>ms</a>                315 ext/fileinfo/libmagic/funcs.c 		efree(ms-&gt;o.buf);</span>
<span class='curline'><a href='../S/188.html#L316'>ms</a>                316 ext/fileinfo/libmagic/funcs.c 		ms-&gt;o.buf = NULL;</span>
<span class='curline'><a href='../S/188.html#L318'>ms</a>                318 ext/fileinfo/libmagic/funcs.c 	if (ms-&gt;o.pbuf) {</span>
<span class='curline'><a href='../S/188.html#L319'>ms</a>                319 ext/fileinfo/libmagic/funcs.c 		efree(ms-&gt;o.pbuf);</span>
<span class='curline'><a href='../S/188.html#L320'>ms</a>                320 ext/fileinfo/libmagic/funcs.c 		ms-&gt;o.pbuf = NULL;</span>
<span class='curline'><a href='../S/188.html#L322'>ms</a>                322 ext/fileinfo/libmagic/funcs.c 	ms-&gt;event_flags &amp;= ~EVENT_HAD_ERR;</span>
<span class='curline'><a href='../S/188.html#L323'>ms</a>                323 ext/fileinfo/libmagic/funcs.c 	ms-&gt;error = -1;</span>
<span class='curline'><a href='../S/188.html#L336'>ms</a>                336 ext/fileinfo/libmagic/funcs.c file_getbuffer(struct magic_set *ms)</span>
<span class='curline'><a href='../S/188.html#L341'>ms</a>                341 ext/fileinfo/libmagic/funcs.c 	if (ms-&gt;event_flags &amp; EVENT_HAD_ERR)</span>
<span class='curline'><a href='../S/188.html#L344'>ms</a>                344 ext/fileinfo/libmagic/funcs.c 	if (ms-&gt;flags &amp; MAGIC_RAW)</span>
<span class='curline'><a href='../S/188.html#L345'>ms</a>                345 ext/fileinfo/libmagic/funcs.c 		return ms-&gt;o.buf;</span>
<span class='curline'><a href='../S/188.html#L347'>ms</a>                347 ext/fileinfo/libmagic/funcs.c 	if (ms-&gt;o.buf == NULL)</span>
<span class='curline'><a href='../S/188.html#L351'>ms</a>                351 ext/fileinfo/libmagic/funcs.c 	len = strlen(ms-&gt;o.buf);</span>
<span class='curline'><a href='../S/188.html#L356'>ms</a>                356 ext/fileinfo/libmagic/funcs.c 	if ((ms-&gt;o.pbuf = CAST(char *, erealloc(ms-&gt;o.pbuf, psize))) == NULL) {</span>
<span class='curline'><a href='../S/188.html#L357'>ms</a>                357 ext/fileinfo/libmagic/funcs.c 		file_oomem(ms, psize);</span>
<span class='curline'><a href='../S/188.html#L370'>ms</a>                370 ext/fileinfo/libmagic/funcs.c 		np = ms-&gt;o.pbuf;</span>
<span class='curline'><a href='../S/188.html#L371'>ms</a>                371 ext/fileinfo/libmagic/funcs.c 		op = ms-&gt;o.buf;</span>
<span class='curline'><a href='../S/188.html#L396'>ms</a>                396 ext/fileinfo/libmagic/funcs.c 			return ms-&gt;o.pbuf;</span>
<span class='curline'><a href='../S/188.html#L400'>ms</a>                400 ext/fileinfo/libmagic/funcs.c 	for (np = ms-&gt;o.pbuf, op = ms-&gt;o.buf; *op;) {</span>
<span class='curline'><a href='../S/188.html#L408'>ms</a>                408 ext/fileinfo/libmagic/funcs.c 	return ms-&gt;o.pbuf;</span>
<span class='curline'><a href='../S/188.html#L412'>ms</a>                412 ext/fileinfo/libmagic/funcs.c file_check_mem(struct magic_set *ms, unsigned int level)</span>
<span class='curline'><a href='../S/188.html#L416'>ms</a>                416 ext/fileinfo/libmagic/funcs.c 	if (level &gt;= ms-&gt;c.len) {</span>
<span class='curline'><a href='../S/188.html#L417'>ms</a>                417 ext/fileinfo/libmagic/funcs.c 		len = (ms-&gt;c.len += 20 + level) * sizeof(*ms-&gt;c.li);</span>
<span class='curline'><a href='../S/188.html#L418'>ms</a>                418 ext/fileinfo/libmagic/funcs.c 		ms-&gt;c.li = CAST(struct level_info *, (ms-&gt;c.li == NULL) ?</span>
<span class='curline'><a href='../S/188.html#L420'>ms</a>                420 ext/fileinfo/libmagic/funcs.c 		    erealloc(ms-&gt;c.li, len));</span>
<span class='curline'><a href='../S/188.html#L421'>ms</a>                421 ext/fileinfo/libmagic/funcs.c 		if (ms-&gt;c.li == NULL) {</span>
<span class='curline'><a href='../S/188.html#L422'>ms</a>                422 ext/fileinfo/libmagic/funcs.c 			file_oomem(ms, len);</span>
<span class='curline'><a href='../S/188.html#L426'>ms</a>                426 ext/fileinfo/libmagic/funcs.c 	ms-&gt;c.li[level].got_match = 0;</span>
<span class='curline'><a href='../S/188.html#L428'>ms</a>                428 ext/fileinfo/libmagic/funcs.c 	ms-&gt;c.li[level].last_match = 0;</span>
<span class='curline'><a href='../S/188.html#L429'>ms</a>                429 ext/fileinfo/libmagic/funcs.c 	ms-&gt;c.li[level].last_cond = COND_NONE;</span>
<span class='curline'><a href='../S/188.html#L435'>ms</a>                435 ext/fileinfo/libmagic/funcs.c file_printedlen(const struct magic_set *ms)</span>
<span class='curline'><a href='../S/188.html#L437'>ms</a>                437 ext/fileinfo/libmagic/funcs.c 	return ms-&gt;o.buf == NULL ? 0 : strlen(ms-&gt;o.buf);</span>
<span class='curline'><a href='../S/188.html#L440'>ms</a>                440 ext/fileinfo/libmagic/funcs.c file_replace(struct magic_set *ms, const char *pat, const char *rep)</span>
<span class='curline'><a href='../S/188.html#L466'>ms</a>                466 ext/fileinfo/libmagic/funcs.c 	res = php_pcre_replace_impl(pce, ms-&gt;o.buf, strlen(ms-&gt;o.buf), repl,</span>
<span class='curline'><a href='../S/188.html#L478'>ms</a>                478 ext/fileinfo/libmagic/funcs.c 	strncpy(ms-&gt;o.buf, res, res_len);</span>
<span class='curline'><a href='../S/188.html#L479'>ms</a>                479 ext/fileinfo/libmagic/funcs.c 	ms-&gt;o.buf[res_len] = '\0';</span>
<span class='curline'><a href='../S/189.html#L63'>ms</a>                 63 ext/fileinfo/libmagic/is_tar.c file_is_tar(struct magic_set *ms, const unsigned char *buf, size_t nbytes)</span>
<span class='curline'><a href='../S/189.html#L70'>ms</a>                 70 ext/fileinfo/libmagic/is_tar.c 	int mime = ms-&gt;flags &amp; MAGIC_MIME;</span>
<span class='curline'><a href='../S/189.html#L72'>ms</a>                 72 ext/fileinfo/libmagic/is_tar.c 	if ((ms-&gt;flags &amp; MAGIC_APPLE) != 0)</span>
<span class='curline'><a href='../S/189.html#L79'>ms</a>                 79 ext/fileinfo/libmagic/is_tar.c 	if (file_printf(ms, "%s", mime ? "application/x-tar" :</span>
<span class='curline'><a href='../S/190.html#L234'>ms</a>                234 ext/fileinfo/libmagic/magic.c unreadable_info(struct magic_set *ms, mode_t md, const char *file)</span>
<span class='curline'><a href='../S/190.html#L238'>ms</a>                238 ext/fileinfo/libmagic/magic.c 		if (file_printf(ms, "writable, ") == -1)</span>
<span class='curline'><a href='../S/190.html#L241'>ms</a>                241 ext/fileinfo/libmagic/magic.c 		if (file_printf(ms, "executable, ") == -1)</span>
<span class='curline'><a href='../S/190.html#L244'>ms</a>                244 ext/fileinfo/libmagic/magic.c 		if (file_printf(ms, "regular file, ") == -1)</span>
<span class='curline'><a href='../S/190.html#L246'>ms</a>                246 ext/fileinfo/libmagic/magic.c 	if (file_printf(ms, "no read permission") == -1)</span>
<span class='curline'><a href='../S/190.html#L252'>ms</a>                252 ext/fileinfo/libmagic/magic.c magic_close(struct magic_set *ms)</span>
<span class='curline'><a href='../S/190.html#L254'>ms</a>                254 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/190.html#L256'>ms</a>                256 ext/fileinfo/libmagic/magic.c 	file_ms_free(ms);</span>
<span class='curline'><a href='../S/190.html#L263'>ms</a>                263 ext/fileinfo/libmagic/magic.c magic_load(struct magic_set *ms, const char *magicfile)</span>
<span class='curline'><a href='../S/190.html#L265'>ms</a>                265 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/190.html#L267'>ms</a>                267 ext/fileinfo/libmagic/magic.c 	return file_apprentice(ms, magicfile, FILE_LOAD);</span>
<span class='curline'><a href='../S/190.html#L271'>ms</a>                271 ext/fileinfo/libmagic/magic.c magic_compile(struct magic_set *ms, const char *magicfile)</span>
<span class='curline'><a href='../S/190.html#L273'>ms</a>                273 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/190.html#L275'>ms</a>                275 ext/fileinfo/libmagic/magic.c 	return file_apprentice(ms, magicfile, FILE_COMPILE);</span>
<span class='curline'><a href='../S/190.html#L280'>ms</a>                280 ext/fileinfo/libmagic/magic.c magic_list(struct magic_set *ms, const char *magicfile)</span>
<span class='curline'><a href='../S/190.html#L282'>ms</a>                282 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/190.html#L284'>ms</a>                284 ext/fileinfo/libmagic/magic.c 	return file_apprentice(ms, magicfile, FILE_LIST);</span>
<span class='curline'><a href='../S/190.html#L288'>ms</a>                288 ext/fileinfo/libmagic/magic.c close_and_restore(const struct magic_set *ms, const char *name, int fd,</span>
<span class='curline'><a href='../S/190.html#L292'>ms</a>                292 ext/fileinfo/libmagic/magic.c 	if ((ms-&gt;flags &amp; MAGIC_PRESERVE_ATIME) != 0) {</span>
<span class='curline'><a href='../S/190.html#L322'>ms</a>                322 ext/fileinfo/libmagic/magic.c magic_descriptor(struct magic_set *ms, int fd)</span>
<span class='curline'><a href='../S/190.html#L324'>ms</a>                324 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/190.html#L326'>ms</a>                326 ext/fileinfo/libmagic/magic.c 	return file_or_stream(ms, NULL, NULL);</span>
<span class='curline'><a href='../S/190.html#L333'>ms</a>                333 ext/fileinfo/libmagic/magic.c magic_file(struct magic_set *ms, const char *inname)</span>
<span class='curline'><a href='../S/190.html#L335'>ms</a>                335 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/190.html#L337'>ms</a>                337 ext/fileinfo/libmagic/magic.c 	return file_or_stream(ms, inname, NULL);</span>
<span class='curline'><a href='../S/190.html#L341'>ms</a>                341 ext/fileinfo/libmagic/magic.c magic_stream(struct magic_set *ms, php_stream *stream)</span>
<span class='curline'><a href='../S/190.html#L343'>ms</a>                343 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/190.html#L345'>ms</a>                345 ext/fileinfo/libmagic/magic.c 	return file_or_stream(ms, NULL, stream);</span>
<span class='curline'><a href='../S/190.html#L349'>ms</a>                349 ext/fileinfo/libmagic/magic.c file_or_stream(struct magic_set *ms, const char *inname, php_stream *stream)</span>
<span class='curline'><a href='../S/190.html#L369'>ms</a>                369 ext/fileinfo/libmagic/magic.c 	if (file_reset(ms) == -1)</span>
<span class='curline'><a href='../S/190.html#L372'>ms</a>                372 ext/fileinfo/libmagic/magic.c 	switch (file_fsmagic(ms, inname, &amp;sb, stream)) {</span>
<span class='curline'><a href='../S/190.html#L390'>ms</a>                390 ext/fileinfo/libmagic/magic.c 		if (unreadable_info(ms, sb.st_mode, inname) == -1)</span>
<span class='curline'><a href='../S/190.html#L404'>ms</a>                404 ext/fileinfo/libmagic/magic.c 		file_error(ms, errno, "cannot read `%s'", inname);</span>
<span class='curline'><a href='../S/190.html#L409'>ms</a>                409 ext/fileinfo/libmagic/magic.c 	if (file_buffer(ms, stream, inname, buf, (size_t)nbytes) == -1)</span>
<span class='curline'><a href='../S/190.html#L419'>ms</a>                419 ext/fileinfo/libmagic/magic.c 	close_and_restore(ms, inname, 0, &amp;sb);</span>
<span class='curline'><a href='../S/190.html#L420'>ms</a>                420 ext/fileinfo/libmagic/magic.c 	return rv == 0 ? file_getbuffer(ms) : NULL;</span>
<span class='curline'><a href='../S/190.html#L425'>ms</a>                425 ext/fileinfo/libmagic/magic.c magic_buffer(struct magic_set *ms, const void *buf, size_t nb)</span>
<span class='curline'><a href='../S/190.html#L427'>ms</a>                427 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/190.html#L429'>ms</a>                429 ext/fileinfo/libmagic/magic.c 	if (file_reset(ms) == -1)</span>
<span class='curline'><a href='../S/190.html#L435'>ms</a>                435 ext/fileinfo/libmagic/magic.c 	if (file_buffer(ms, NULL, NULL, buf, nb) == -1) {</span>
<span class='curline'><a href='../S/190.html#L438'>ms</a>                438 ext/fileinfo/libmagic/magic.c 	return file_getbuffer(ms);</span>
<span class='curline'><a href='../S/190.html#L442'>ms</a>                442 ext/fileinfo/libmagic/magic.c magic_error(struct magic_set *ms)</span>
<span class='curline'><a href='../S/190.html#L444'>ms</a>                444 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/190.html#L446'>ms</a>                446 ext/fileinfo/libmagic/magic.c 	return (ms-&gt;event_flags &amp; EVENT_HAD_ERR) ? ms-&gt;o.buf : NULL;</span>
<span class='curline'><a href='../S/190.html#L450'>ms</a>                450 ext/fileinfo/libmagic/magic.c magic_errno(struct magic_set *ms)</span>
<span class='curline'><a href='../S/190.html#L452'>ms</a>                452 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/190.html#L454'>ms</a>                454 ext/fileinfo/libmagic/magic.c 	return (ms-&gt;event_flags &amp; EVENT_HAD_ERR) ? ms-&gt;error : 0;</span>
<span class='curline'><a href='../S/190.html#L458'>ms</a>                458 ext/fileinfo/libmagic/magic.c magic_setflags(struct magic_set *ms, int flags)</span>
<span class='curline'><a href='../S/190.html#L460'>ms</a>                460 ext/fileinfo/libmagic/magic.c 	if (ms == NULL)</span>
<span class='curline'><a href='../S/190.html#L466'>ms</a>                466 ext/fileinfo/libmagic/magic.c 	ms-&gt;flags = flags;</span>
<span class='curline'><a href='../S/194.html#L59'>ms</a>                 59 ext/fileinfo/libmagic/print.c file_magwarn(struct magic_set *ms, const char *f, ...)</span>
<span class='curline'><a href='../S/195.html#L48'>ms</a>                 48 ext/fileinfo/libmagic/readcdf.c #define NOTMIME(ms) (((ms)-&gt;flags &amp; MAGIC_MIME) == 0)</span>
<span class='curline'><a href='../S/195.html#L137'>ms</a>                137 ext/fileinfo/libmagic/readcdf.c cdf_file_property_info(struct magic_set *ms, const cdf_property_info_t *info,</span>
<span class='curline'><a href='../S/195.html#L150'>ms</a>                150 ext/fileinfo/libmagic/readcdf.c         if (!NOTMIME(ms) &amp;&amp; root_storage)</span>
<span class='curline'><a href='../S/195.html#L159'>ms</a>                159 ext/fileinfo/libmagic/readcdf.c                         if (NOTMIME(ms) &amp;&amp; file_printf(ms, ", %s: %hd", buf,</span>
<span class='curline'><a href='../S/195.html#L164'>ms</a>                164 ext/fileinfo/libmagic/readcdf.c                         if (NOTMIME(ms) &amp;&amp; file_printf(ms, ", %s: %d", buf,</span>
<span class='curline'><a href='../S/195.html#L169'>ms</a>                169 ext/fileinfo/libmagic/readcdf.c                         if (NOTMIME(ms) &amp;&amp; file_printf(ms, ", %s: %u", buf,</span>
<span class='curline'><a href='../S/195.html#L174'>ms</a>                174 ext/fileinfo/libmagic/readcdf.c                         if (NOTMIME(ms) &amp;&amp; file_printf(ms, ", %s: %g", buf,</span>
<span class='curline'><a href='../S/195.html#L179'>ms</a>                179 ext/fileinfo/libmagic/readcdf.c                         if (NOTMIME(ms) &amp;&amp; file_printf(ms, ", %s: %g", buf,</span>
<span class='curline'><a href='../S/195.html#L203'>ms</a>                203 ext/fileinfo/libmagic/readcdf.c                                 if (NOTMIME(ms)) {</span>
<span class='curline'><a href='../S/195.html#L205'>ms</a>                205 ext/fileinfo/libmagic/readcdf.c                                                 if (file_printf(ms, ", %s: %s",</span>
<span class='curline'><a href='../S/195.html#L226'>ms</a>                226 ext/fileinfo/libmagic/readcdf.c                                         if (NOTMIME(ms) &amp;&amp; file_printf(ms,</span>
<span class='curline'><a href='../S/195.html#L240'>ms</a>                240 ext/fileinfo/libmagic/readcdf.c                                         if (NOTMIME(ms) &amp;&amp; file_printf(ms,</span>
<span class='curline'><a href='../S/195.html#L252'>ms</a>                252 ext/fileinfo/libmagic/readcdf.c         if (!NOTMIME(ms)) {</span>
<span class='curline'><a href='../S/195.html#L255'>ms</a>                255 ext/fileinfo/libmagic/readcdf.c                 if (file_printf(ms, "application/%s", str) == -1)</span>
<span class='curline'><a href='../S/195.html#L262'>ms</a>                262 ext/fileinfo/libmagic/readcdf.c cdf_file_summary_info(struct magic_set *ms, const cdf_header_t *h,</span>
<span class='curline'><a href='../S/195.html#L273'>ms</a>                273 ext/fileinfo/libmagic/readcdf.c         if (NOTMIME(ms)) {</span>
<span class='curline'><a href='../S/195.html#L276'>ms</a>                276 ext/fileinfo/libmagic/readcdf.c                 if (file_printf(ms, "Composite Document File V2 Document")</span>
<span class='curline'><a href='../S/195.html#L280'>ms</a>                280 ext/fileinfo/libmagic/readcdf.c                 if (file_printf(ms, ", %s Endian",</span>
<span class='curline'><a href='../S/195.html#L285'>ms</a>                285 ext/fileinfo/libmagic/readcdf.c                         if (file_printf(ms, ", Os: Windows, Version %d.%d",</span>
<span class='curline'><a href='../S/195.html#L291'>ms</a>                291 ext/fileinfo/libmagic/readcdf.c                         if (file_printf(ms, ", Os: MacOS, Version %d.%d",</span>
<span class='curline'><a href='../S/195.html#L297'>ms</a>                297 ext/fileinfo/libmagic/readcdf.c                         if (file_printf(ms, ", Os %d, Version: %d.%d", si.si_os,</span>
<span class='curline'><a href='../S/195.html#L306'>ms</a>                306 ext/fileinfo/libmagic/readcdf.c 				if (file_printf(ms, ", %s", str) == -1)</span>
<span class='curline'><a href='../S/195.html#L311'>ms</a>                311 ext/fileinfo/libmagic/readcdf.c         m = cdf_file_property_info(ms, info, count, root_storage);</span>
<span class='curline'><a href='../S/195.html#L318'>ms</a>                318 ext/fileinfo/libmagic/readcdf.c file_trycdf(struct magic_set *ms, int fd, const unsigned char *buf,</span>
<span class='curline'><a href='../S/195.html#L334'>ms</a>                334 ext/fileinfo/libmagic/readcdf.c         if (ms-&gt;flags &amp; MAGIC_APPLE)</span>
<span class='curline'><a href='../S/195.html#L385'>ms</a>                385 ext/fileinfo/libmagic/readcdf.c         if ((i = cdf_file_summary_info(ms, &amp;h, &amp;scn, root_storage)) &lt; 0)</span>
<span class='curline'><a href='../S/195.html#L399'>ms</a>                399 ext/fileinfo/libmagic/readcdf.c 			    NOTMIME(ms) ? name2desc : name2mime);</span>
<span class='curline'><a href='../S/195.html#L401'>ms</a>                401 ext/fileinfo/libmagic/readcdf.c 		if (NOTMIME(ms)) {</span>
<span class='curline'><a href='../S/195.html#L403'>ms</a>                403 ext/fileinfo/libmagic/readcdf.c 				if (file_printf(ms, "%s", str) == -1)</span>
<span class='curline'><a href='../S/195.html#L410'>ms</a>                410 ext/fileinfo/libmagic/readcdf.c 			if (file_printf(ms, "application/%s", str) == -1)</span>
<span class='curline'><a href='../S/195.html#L426'>ms</a>                426 ext/fileinfo/libmagic/readcdf.c 	    if (NOTMIME(ms)) {</span>
<span class='curline'><a href='../S/195.html#L427'>ms</a>                427 ext/fileinfo/libmagic/readcdf.c 		if (file_printf(ms,</span>
<span class='curline'><a href='../S/195.html#L431'>ms</a>                431 ext/fileinfo/libmagic/readcdf.c 		    if (file_printf(ms, ", %s%s", corrupt, expn) == -1)</span>
<span class='curline'><a href='../S/195.html#L434'>ms</a>                434 ext/fileinfo/libmagic/readcdf.c 		if (file_printf(ms, "application/CDFV2-corrupt") == -1)</span>
<span class='curline'><a href='../S/196.html#L87'>ms</a>                 87 ext/fileinfo/libmagic/softmagic.c file_softmagic(struct magic_set *ms, const unsigned char *buf, size_t nbytes,</span>
<span class='curline'><a href='../S/196.html#L92'>ms</a>                 92 ext/fileinfo/libmagic/softmagic.c 	for (ml = ms-&gt;mlist[0]-&gt;next; ml != ms-&gt;mlist[0]; ml = ml-&gt;next)</span>
<span class='curline'><a href='../S/196.html#L93'>ms</a>                 93 ext/fileinfo/libmagic/softmagic.c 		if ((rv = match(ms, ml-&gt;magic, ml-&gt;nmagic, buf, nbytes, 0, mode,</span>
<span class='curline'><a href='../S/196.html#L129'>ms</a>                129 ext/fileinfo/libmagic/softmagic.c match(struct magic_set *ms, struct magic *magic, uint32_t nmagic,</span>
<span class='curline'><a href='../S/196.html#L138'>ms</a>                138 ext/fileinfo/libmagic/softmagic.c 	int print = (ms-&gt;flags &amp; (MAGIC_MIME|MAGIC_APPLE)) == 0;</span>
<span class='curline'><a href='../S/196.html#L143'>ms</a>                143 ext/fileinfo/libmagic/softmagic.c 	if (file_check_mem(ms, cont_level) == -1)</span>
<span class='curline'><a href='../S/196.html#L164'>ms</a>                164 ext/fileinfo/libmagic/softmagic.c 		ms-&gt;offset = m-&gt;offset;</span>
<span class='curline'><a href='../S/196.html#L165'>ms</a>                165 ext/fileinfo/libmagic/softmagic.c 		ms-&gt;line = m-&gt;lineno;</span>
<span class='curline'><a href='../S/196.html#L168'>ms</a>                168 ext/fileinfo/libmagic/softmagic.c 		switch (mget(ms, s, m, nbytes, offset, cont_level, mode, text,</span>
<span class='curline'><a href='../S/196.html#L180'>ms</a>                180 ext/fileinfo/libmagic/softmagic.c 			switch (magiccheck(ms, m)) {</span>
<span class='curline'><a href='../S/196.html#L203'>ms</a>                203 ext/fileinfo/libmagic/softmagic.c 		if ((e = handle_annotation(ms, m)) != 0) {</span>
<span class='curline'><a href='../S/196.html#L216'>ms</a>                216 ext/fileinfo/libmagic/softmagic.c 			if (print_sep(ms, firstline) == -1)</span>
<span class='curline'><a href='../S/196.html#L221'>ms</a>                221 ext/fileinfo/libmagic/softmagic.c 		if (print &amp;&amp; mprint(ms, m) == -1)</span>
<span class='curline'><a href='../S/196.html#L224'>ms</a>                224 ext/fileinfo/libmagic/softmagic.c 		ms-&gt;c.li[cont_level].off = moffset(ms, m);</span>
<span class='curline'><a href='../S/196.html#L227'>ms</a>                227 ext/fileinfo/libmagic/softmagic.c 		if (file_check_mem(ms, ++cont_level) == -1)</span>
<span class='curline'><a href='../S/196.html#L233'>ms</a>                233 ext/fileinfo/libmagic/softmagic.c 			ms-&gt;line = m-&gt;lineno; /* for messages */</span>
<span class='curline'><a href='../S/196.html#L244'>ms</a>                244 ext/fileinfo/libmagic/softmagic.c 			ms-&gt;offset = m-&gt;offset;</span>
<span class='curline'><a href='../S/196.html#L246'>ms</a>                246 ext/fileinfo/libmagic/softmagic.c 				ms-&gt;offset +=</span>
<span class='curline'><a href='../S/196.html#L247'>ms</a>                247 ext/fileinfo/libmagic/softmagic.c 				    ms-&gt;c.li[cont_level - 1].off;</span>
<span class='curline'><a href='../S/196.html#L253'>ms</a>                253 ext/fileinfo/libmagic/softmagic.c 				if (ms-&gt;c.li[cont_level].last_match == 1)</span>
<span class='curline'><a href='../S/196.html#L257'>ms</a>                257 ext/fileinfo/libmagic/softmagic.c 			switch (mget(ms, s, m, nbytes, offset, cont_level, mode,</span>
<span class='curline'><a href='../S/196.html#L274'>ms</a>                274 ext/fileinfo/libmagic/softmagic.c 			switch (flush ? 1 : magiccheck(ms, m)) {</span>
<span class='curline'><a href='../S/196.html#L279'>ms</a>                279 ext/fileinfo/libmagic/softmagic.c 				ms-&gt;c.li[cont_level].last_match = 0;</span>
<span class='curline'><a href='../S/196.html#L284'>ms</a>                284 ext/fileinfo/libmagic/softmagic.c 				ms-&gt;c.li[cont_level].last_match = 1;</span>
<span class='curline'><a href='../S/196.html#L287'>ms</a>                287 ext/fileinfo/libmagic/softmagic.c 					ms-&gt;c.li[cont_level].got_match = 0;</span>
<span class='curline'><a href='../S/196.html#L288'>ms</a>                288 ext/fileinfo/libmagic/softmagic.c 				else if (ms-&gt;c.li[cont_level].got_match) {</span>
<span class='curline'><a href='../S/196.html#L292'>ms</a>                292 ext/fileinfo/libmagic/softmagic.c 					ms-&gt;c.li[cont_level].got_match = 1;</span>
<span class='curline'><a href='../S/196.html#L293'>ms</a>                293 ext/fileinfo/libmagic/softmagic.c 				if ((e = handle_annotation(ms, m)) != 0) {</span>
<span class='curline'><a href='../S/196.html#L306'>ms</a>                306 ext/fileinfo/libmagic/softmagic.c 						if (print_sep(ms, firstline)</span>
<span class='curline'><a href='../S/196.html#L322'>ms</a>                322 ext/fileinfo/libmagic/softmagic.c 					    file_printf(ms, " ") == -1)</span>
<span class='curline'><a href='../S/196.html#L326'>ms</a>                326 ext/fileinfo/libmagic/softmagic.c 				if (print &amp;&amp; mprint(ms, m) == -1)</span>
<span class='curline'><a href='../S/196.html#L329'>ms</a>                329 ext/fileinfo/libmagic/softmagic.c 				ms-&gt;c.li[cont_level].off = moffset(ms, m);</span>
<span class='curline'><a href='../S/196.html#L339'>ms</a>                339 ext/fileinfo/libmagic/softmagic.c 				if (file_check_mem(ms, ++cont_level) == -1)</span>
<span class='curline'><a href='../S/196.html#L349'>ms</a>                349 ext/fileinfo/libmagic/softmagic.c 		if ((ms-&gt;flags &amp; MAGIC_CONTINUE) == 0 &amp;&amp; *printed_something) {</span>
<span class='curline'><a href='../S/196.html#L357'>ms</a>                357 ext/fileinfo/libmagic/softmagic.c check_fmt(struct magic_set *ms, struct magic *m)</span>
<span class='curline'><a href='../S/196.html#L378'>ms</a>                378 ext/fileinfo/libmagic/softmagic.c mprint(struct magic_set *ms, struct magic *m)</span>
<span class='curline'><a href='../S/196.html#L385'>ms</a>                385 ext/fileinfo/libmagic/softmagic.c 	union VALUETYPE *p = &amp;ms-&gt;ms_value;</span>
<span class='curline'><a href='../S/196.html#L389'>ms</a>                389 ext/fileinfo/libmagic/softmagic.c 		v = file_signextend(ms, m, (uint64_t)p-&gt;b);</span>
<span class='curline'><a href='../S/196.html#L390'>ms</a>                390 ext/fileinfo/libmagic/softmagic.c 		switch (check_fmt(ms, m)) {</span>
<span class='curline'><a href='../S/196.html#L396'>ms</a>                396 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(m-&gt;desc, "%s"), buf) == -1)</span>
<span class='curline'><a href='../S/196.html#L400'>ms</a>                400 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(m-&gt;desc, "%c"),</span>
<span class='curline'><a href='../S/196.html#L405'>ms</a>                405 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(char);</span>
<span class='curline'><a href='../S/196.html#L411'>ms</a>                411 ext/fileinfo/libmagic/softmagic.c 		v = file_signextend(ms, m, (uint64_t)p-&gt;h);</span>
<span class='curline'><a href='../S/196.html#L412'>ms</a>                412 ext/fileinfo/libmagic/softmagic.c 		switch (check_fmt(ms, m)) {</span>
<span class='curline'><a href='../S/196.html#L418'>ms</a>                418 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(m-&gt;desc, "%s"), buf) == -1)</span>
<span class='curline'><a href='../S/196.html#L422'>ms</a>                422 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(m-&gt;desc, "%hu"),</span>
<span class='curline'><a href='../S/196.html#L427'>ms</a>                427 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(short);</span>
<span class='curline'><a href='../S/196.html#L434'>ms</a>                434 ext/fileinfo/libmagic/softmagic.c 		v = file_signextend(ms, m, (uint64_t)p-&gt;l);</span>
<span class='curline'><a href='../S/196.html#L435'>ms</a>                435 ext/fileinfo/libmagic/softmagic.c 		switch (check_fmt(ms, m)) {</span>
<span class='curline'><a href='../S/196.html#L440'>ms</a>                440 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(m-&gt;desc, "%s"), buf) == -1)</span>
<span class='curline'><a href='../S/196.html#L444'>ms</a>                444 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(m-&gt;desc, "%u"),</span>
<span class='curline'><a href='../S/196.html#L449'>ms</a>                449 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(int32_t);</span>
<span class='curline'><a href='../S/196.html#L455'>ms</a>                455 ext/fileinfo/libmagic/softmagic.c 		v = file_signextend(ms, m, p-&gt;q);</span>
<span class='curline'><a href='../S/196.html#L456'>ms</a>                456 ext/fileinfo/libmagic/softmagic.c 		switch (check_fmt(ms, m)) {</span>
<span class='curline'><a href='../S/196.html#L462'>ms</a>                462 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(m-&gt;desc, "%s"), buf) == -1)</span>
<span class='curline'><a href='../S/196.html#L466'>ms</a>                466 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(m-&gt;desc, "%llu"),</span>
<span class='curline'><a href='../S/196.html#L471'>ms</a>                471 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(int64_t);</span>
<span class='curline'><a href='../S/196.html#L479'>ms</a>                479 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(m-&gt;desc, "%s"), m-&gt;value.s) == -1)</span>
<span class='curline'><a href='../S/196.html#L481'>ms</a>                481 ext/fileinfo/libmagic/softmagic.c 			t = ms-&gt;offset + m-&gt;vallen;</span>
<span class='curline'><a href='../S/196.html#L487'>ms</a>                487 ext/fileinfo/libmagic/softmagic.c 			t = ms-&gt;offset + strlen(str);</span>
<span class='curline'><a href='../S/196.html#L505'>ms</a>                505 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(m-&gt;desc, "%s"), str) == -1)</span>
<span class='curline'><a href='../S/196.html#L517'>ms</a>                517 ext/fileinfo/libmagic/softmagic.c 		if (file_printf(ms, F(m-&gt;desc, "%s"),</span>
<span class='curline'><a href='../S/196.html#L521'>ms</a>                521 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(uint32_t);</span>
<span class='curline'><a href='../S/196.html#L528'>ms</a>                528 ext/fileinfo/libmagic/softmagic.c 		if (file_printf(ms, F(m-&gt;desc, "%s"),</span>
<span class='curline'><a href='../S/196.html#L531'>ms</a>                531 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(uint32_t);</span>
<span class='curline'><a href='../S/196.html#L537'>ms</a>                537 ext/fileinfo/libmagic/softmagic.c 		if (file_printf(ms, F(m-&gt;desc, "%s"),</span>
<span class='curline'><a href='../S/196.html#L540'>ms</a>                540 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(uint64_t);</span>
<span class='curline'><a href='../S/196.html#L546'>ms</a>                546 ext/fileinfo/libmagic/softmagic.c 		if (file_printf(ms, F(m-&gt;desc, "%s"),</span>
<span class='curline'><a href='../S/196.html#L549'>ms</a>                549 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(uint64_t);</span>
<span class='curline'><a href='../S/196.html#L555'>ms</a>                555 ext/fileinfo/libmagic/softmagic.c 		if (file_printf(ms, F(m-&gt;desc, "%s"),</span>
<span class='curline'><a href='../S/196.html#L558'>ms</a>                558 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(uint64_t);</span>
<span class='curline'><a href='../S/196.html#L565'>ms</a>                565 ext/fileinfo/libmagic/softmagic.c 		switch (check_fmt(ms, m)) {</span>
<span class='curline'><a href='../S/196.html#L570'>ms</a>                570 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(m-&gt;desc, "%s"), buf) == -1)</span>
<span class='curline'><a href='../S/196.html#L574'>ms</a>                574 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(m-&gt;desc, "%g"), vf) == -1)</span>
<span class='curline'><a href='../S/196.html#L578'>ms</a>                578 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(float);</span>
<span class='curline'><a href='../S/196.html#L585'>ms</a>                585 ext/fileinfo/libmagic/softmagic.c 		switch (check_fmt(ms, m)) {</span>
<span class='curline'><a href='../S/196.html#L590'>ms</a>                590 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(m-&gt;desc, "%s"), buf) == -1)</span>
<span class='curline'><a href='../S/196.html#L594'>ms</a>                594 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, F(m-&gt;desc, "%g"), vd) == -1)</span>
<span class='curline'><a href='../S/196.html#L598'>ms</a>                598 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset + sizeof(double);</span>
<span class='curline'><a href='../S/196.html#L605'>ms</a>                605 ext/fileinfo/libmagic/softmagic.c 		cp = estrndup((const char *)ms-&gt;search.s, ms-&gt;search.rm_len);</span>
<span class='curline'><a href='../S/196.html#L607'>ms</a>                607 ext/fileinfo/libmagic/softmagic.c 			file_oomem(ms, ms-&gt;search.rm_len);</span>
<span class='curline'><a href='../S/196.html#L610'>ms</a>                610 ext/fileinfo/libmagic/softmagic.c 		rval = file_printf(ms, F(m-&gt;desc, "%s"), cp);</span>
<span class='curline'><a href='../S/196.html#L617'>ms</a>                617 ext/fileinfo/libmagic/softmagic.c 			t = ms-&gt;search.offset;</span>
<span class='curline'><a href='../S/196.html#L619'>ms</a>                619 ext/fileinfo/libmagic/softmagic.c 			t = ms-&gt;search.offset + ms-&gt;search.rm_len;</span>
<span class='curline'><a href='../S/196.html#L624'>ms</a>                624 ext/fileinfo/libmagic/softmagic.c 	  	if (file_printf(ms, F(m-&gt;desc, "%s"), m-&gt;value.s) == -1)</span>
<span class='curline'><a href='../S/196.html#L627'>ms</a>                627 ext/fileinfo/libmagic/softmagic.c 			t = ms-&gt;search.offset;</span>
<span class='curline'><a href='../S/196.html#L629'>ms</a>                629 ext/fileinfo/libmagic/softmagic.c 			t = ms-&gt;search.offset + m-&gt;vallen;</span>
<span class='curline'><a href='../S/196.html#L634'>ms</a>                634 ext/fileinfo/libmagic/softmagic.c 	  	if (file_printf(ms, "%s", m-&gt;desc) == -1)</span>
<span class='curline'><a href='../S/196.html#L636'>ms</a>                636 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset;</span>
<span class='curline'><a href='../S/196.html#L642'>ms</a>                642 ext/fileinfo/libmagic/softmagic.c 		t = ms-&gt;offset;</span>
<span class='curline'><a href='../S/196.html#L646'>ms</a>                646 ext/fileinfo/libmagic/softmagic.c 		file_magerror(ms, "invalid m-&gt;type (%d) in mprint()", m-&gt;type);</span>
<span class='curline'><a href='../S/196.html#L653'>ms</a>                653 ext/fileinfo/libmagic/softmagic.c moffset(struct magic_set *ms, struct magic *m)</span>
<span class='curline'><a href='../S/196.html#L657'>ms</a>                657 ext/fileinfo/libmagic/softmagic.c 		return CAST(int32_t, (ms-&gt;offset + sizeof(char)));</span>
<span class='curline'><a href='../S/196.html#L662'>ms</a>                662 ext/fileinfo/libmagic/softmagic.c 		return CAST(int32_t, (ms-&gt;offset + sizeof(short)));</span>
<span class='curline'><a href='../S/196.html#L668'>ms</a>                668 ext/fileinfo/libmagic/softmagic.c 		return CAST(int32_t, (ms-&gt;offset + sizeof(int32_t)));</span>
<span class='curline'><a href='../S/196.html#L673'>ms</a>                673 ext/fileinfo/libmagic/softmagic.c 		return CAST(int32_t, (ms-&gt;offset + sizeof(int64_t)));</span>
<span class='curline'><a href='../S/196.html#L680'>ms</a>                680 ext/fileinfo/libmagic/softmagic.c 			return ms-&gt;offset + m-&gt;vallen;</span>
<span class='curline'><a href='../S/196.html#L682'>ms</a>                682 ext/fileinfo/libmagic/softmagic.c 			union VALUETYPE *p = &amp;ms-&gt;ms_value;</span>
<span class='curline'><a href='../S/196.html#L687'>ms</a>                687 ext/fileinfo/libmagic/softmagic.c 			t = CAST(uint32_t, (ms-&gt;offset + strlen(p-&gt;s)));</span>
<span class='curline'><a href='../S/196.html#L697'>ms</a>                697 ext/fileinfo/libmagic/softmagic.c 		return CAST(int32_t, (ms-&gt;offset + sizeof(uint32_t)));</span>
<span class='curline'><a href='../S/196.html#L703'>ms</a>                703 ext/fileinfo/libmagic/softmagic.c 		return CAST(int32_t, (ms-&gt;offset + sizeof(uint32_t)));</span>
<span class='curline'><a href='../S/196.html#L708'>ms</a>                708 ext/fileinfo/libmagic/softmagic.c 		return CAST(int32_t, (ms-&gt;offset + sizeof(uint64_t)));</span>
<span class='curline'><a href='../S/196.html#L713'>ms</a>                713 ext/fileinfo/libmagic/softmagic.c 		return CAST(int32_t, (ms-&gt;offset + sizeof(uint64_t)));</span>
<span class='curline'><a href='../S/196.html#L718'>ms</a>                718 ext/fileinfo/libmagic/softmagic.c 		return CAST(int32_t, (ms-&gt;offset + sizeof(float)));</span>
<span class='curline'><a href='../S/196.html#L723'>ms</a>                723 ext/fileinfo/libmagic/softmagic.c 		return CAST(int32_t, (ms-&gt;offset + sizeof(double)));</span>
<span class='curline'><a href='../S/196.html#L727'>ms</a>                727 ext/fileinfo/libmagic/softmagic.c 			return CAST(int32_t, ms-&gt;search.offset);</span>
<span class='curline'><a href='../S/196.html#L729'>ms</a>                729 ext/fileinfo/libmagic/softmagic.c 			return CAST(int32_t, (ms-&gt;search.offset +</span>
<span class='curline'><a href='../S/196.html#L730'>ms</a>                730 ext/fileinfo/libmagic/softmagic.c 			    ms-&gt;search.rm_len));</span>
<span class='curline'><a href='../S/196.html#L734'>ms</a>                734 ext/fileinfo/libmagic/softmagic.c 			return CAST(int32_t, ms-&gt;search.offset);</span>
<span class='curline'><a href='../S/196.html#L736'>ms</a>                736 ext/fileinfo/libmagic/softmagic.c 			return CAST(int32_t, (ms-&gt;search.offset + m-&gt;vallen));</span>
<span class='curline'><a href='../S/196.html#L741'>ms</a>                741 ext/fileinfo/libmagic/softmagic.c 		return ms-&gt;offset;</span>
<span class='curline'><a href='../S/196.html#L888'>ms</a>                888 ext/fileinfo/libmagic/softmagic.c mconvert(struct magic_set *ms, struct magic *m, int flip)</span>
<span class='curline'><a href='../S/196.html#L890'>ms</a>                890 ext/fileinfo/libmagic/softmagic.c 	union VALUETYPE *p = &amp;ms-&gt;ms_value;</span>
<span class='curline'><a href='../S/196.html#L1027'>ms</a>               1027 ext/fileinfo/libmagic/softmagic.c 		file_magerror(ms, "invalid type %d in mconvert()", m-&gt;type);</span>
<span class='curline'><a href='../S/196.html#L1043'>ms</a>               1043 ext/fileinfo/libmagic/softmagic.c mcopy(struct magic_set *ms, union VALUETYPE *p, int type, int indir,</span>
<span class='curline'><a href='../S/196.html#L1053'>ms</a>               1053 ext/fileinfo/libmagic/softmagic.c 			ms-&gt;search.s = RCAST(const char *, s) + offset;</span>
<span class='curline'><a href='../S/196.html#L1054'>ms</a>               1054 ext/fileinfo/libmagic/softmagic.c 			ms-&gt;search.s_len = nbytes - offset;</span>
<span class='curline'><a href='../S/196.html#L1055'>ms</a>               1055 ext/fileinfo/libmagic/softmagic.c 			ms-&gt;search.offset = offset;</span>
<span class='curline'><a href='../S/196.html#L1079'>ms</a>               1079 ext/fileinfo/libmagic/softmagic.c 				ms-&gt;search.s_len = 0;</span>
<span class='curline'><a href='../S/196.html#L1080'>ms</a>               1080 ext/fileinfo/libmagic/softmagic.c 				ms-&gt;search.s = NULL;</span>
<span class='curline'><a href='../S/196.html#L1099'>ms</a>               1099 ext/fileinfo/libmagic/softmagic.c 			ms-&gt;search.s = buf;</span>
<span class='curline'><a href='../S/196.html#L1100'>ms</a>               1100 ext/fileinfo/libmagic/softmagic.c 			ms-&gt;search.s_len = last - buf;</span>
<span class='curline'><a href='../S/196.html#L1101'>ms</a>               1101 ext/fileinfo/libmagic/softmagic.c 			ms-&gt;search.offset = offset;</span>
<span class='curline'><a href='../S/196.html#L1102'>ms</a>               1102 ext/fileinfo/libmagic/softmagic.c 			ms-&gt;search.rm_len = 0;</span>
<span class='curline'><a href='../S/196.html#L1162'>ms</a>               1162 ext/fileinfo/libmagic/softmagic.c mget(struct magic_set *ms, const unsigned char *s, struct magic *m,</span>
<span class='curline'><a href='../S/196.html#L1167'>ms</a>               1167 ext/fileinfo/libmagic/softmagic.c 	uint32_t soffset, offset = ms-&gt;offset;</span>
<span class='curline'><a href='../S/196.html#L1170'>ms</a>               1170 ext/fileinfo/libmagic/softmagic.c 	union VALUETYPE *p = &amp;ms-&gt;ms_value;</span>
<span class='curline'><a href='../S/196.html#L1174'>ms</a>               1174 ext/fileinfo/libmagic/softmagic.c 		file_error(ms, 0, "recursion nesting exceeded");</span>
<span class='curline'><a href='../S/196.html#L1178'>ms</a>               1178 ext/fileinfo/libmagic/softmagic.c 	if (mcopy(ms, p, m-&gt;type, m-&gt;flag &amp; INDIR, s, (uint32_t)(offset + o),</span>
<span class='curline'><a href='../S/196.html#L1182'>ms</a>               1182 ext/fileinfo/libmagic/softmagic.c 	if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0) {</span>
<span class='curline'><a href='../S/196.html#L1224'>ms</a>               1224 ext/fileinfo/libmagic/softmagic.c 			if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/196.html#L1667'>ms</a>               1667 ext/fileinfo/libmagic/softmagic.c 			offset += ms-&gt;c.li[cont_level-1].off;</span>
<span class='curline'><a href='../S/196.html#L1669'>ms</a>               1669 ext/fileinfo/libmagic/softmagic.c 				if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/196.html#L1674'>ms</a>               1674 ext/fileinfo/libmagic/softmagic.c 			if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/196.html#L1677'>ms</a>               1677 ext/fileinfo/libmagic/softmagic.c 		if (mcopy(ms, p, m-&gt;type, 0, s, offset, nbytes, m) == -1)</span>
<span class='curline'><a href='../S/196.html#L1679'>ms</a>               1679 ext/fileinfo/libmagic/softmagic.c 		ms-&gt;offset = offset;</span>
<span class='curline'><a href='../S/196.html#L1681'>ms</a>               1681 ext/fileinfo/libmagic/softmagic.c 		if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0) {</span>
<span class='curline'><a href='../S/196.html#L1744'>ms</a>               1744 ext/fileinfo/libmagic/softmagic.c 		sbuf = ms-&gt;o.buf;</span>
<span class='curline'><a href='../S/196.html#L1745'>ms</a>               1745 ext/fileinfo/libmagic/softmagic.c 		soffset = ms-&gt;offset;</span>
<span class='curline'><a href='../S/196.html#L1746'>ms</a>               1746 ext/fileinfo/libmagic/softmagic.c 		ms-&gt;o.buf = NULL;</span>
<span class='curline'><a href='../S/196.html#L1747'>ms</a>               1747 ext/fileinfo/libmagic/softmagic.c 		ms-&gt;offset = 0;</span>
<span class='curline'><a href='../S/196.html#L1748'>ms</a>               1748 ext/fileinfo/libmagic/softmagic.c 		rv = file_softmagic(ms, s + offset, nbytes - offset,</span>
<span class='curline'><a href='../S/196.html#L1750'>ms</a>               1750 ext/fileinfo/libmagic/softmagic.c 		if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/196.html#L1752'>ms</a>               1752 ext/fileinfo/libmagic/softmagic.c 		rbuf = ms-&gt;o.buf;</span>
<span class='curline'><a href='../S/196.html#L1753'>ms</a>               1753 ext/fileinfo/libmagic/softmagic.c 		ms-&gt;o.buf = sbuf;</span>
<span class='curline'><a href='../S/196.html#L1754'>ms</a>               1754 ext/fileinfo/libmagic/softmagic.c 		ms-&gt;offset = soffset;</span>
<span class='curline'><a href='../S/196.html#L1756'>ms</a>               1756 ext/fileinfo/libmagic/softmagic.c 			if ((ms-&gt;flags &amp; (MAGIC_MIME|MAGIC_APPLE)) == 0 &amp;&amp;</span>
<span class='curline'><a href='../S/196.html#L1757'>ms</a>               1757 ext/fileinfo/libmagic/softmagic.c 			    file_printf(ms, m-&gt;desc, offset) == -1) {</span>
<span class='curline'><a href='../S/196.html#L1763'>ms</a>               1763 ext/fileinfo/libmagic/softmagic.c 			if (file_printf(ms, "%s", rbuf) == -1) {</span>
<span class='curline'><a href='../S/196.html#L1783'>ms</a>               1783 ext/fileinfo/libmagic/softmagic.c 		if (file_magicfind(ms, sbuf, &amp;ml) == -1) {</span>
<span class='curline'><a href='../S/196.html#L1784'>ms</a>               1784 ext/fileinfo/libmagic/softmagic.c 			file_error(ms, 0, "cannot find entry `%s'", sbuf);</span>
<span class='curline'><a href='../S/196.html#L1791'>ms</a>               1791 ext/fileinfo/libmagic/softmagic.c 		rv = match(ms, ml.magic, ml.nmagic, s, nbytes, offset + o,</span>
<span class='curline'><a href='../S/196.html#L1799'>ms</a>               1799 ext/fileinfo/libmagic/softmagic.c 		if (file_printf(ms, "%s", m-&gt;desc) == -1)</span>
<span class='curline'><a href='../S/196.html#L1807'>ms</a>               1807 ext/fileinfo/libmagic/softmagic.c 	if (!mconvert(ms, m, flip))</span>
<span class='curline'><a href='../S/196.html#L1924'>ms</a>               1924 ext/fileinfo/libmagic/softmagic.c magiccheck(struct magic_set *ms, struct magic *m)</span>
<span class='curline'><a href='../S/196.html#L1931'>ms</a>               1931 ext/fileinfo/libmagic/softmagic.c 	union VALUETYPE *p = &amp;ms-&gt;ms_value;</span>
<span class='curline'><a href='../S/196.html#L2002'>ms</a>               2002 ext/fileinfo/libmagic/softmagic.c 			file_magerror(ms, "cannot happen with float: invalid relation `%c'",</span>
<span class='curline'><a href='../S/196.html#L2036'>ms</a>               2036 ext/fileinfo/libmagic/softmagic.c 			file_magerror(ms, "cannot happen with double: invalid relation `%c'", m-&gt;reln);</span>
<span class='curline'><a href='../S/196.html#L2063'>ms</a>               2063 ext/fileinfo/libmagic/softmagic.c 		if (ms-&gt;search.s == NULL)</span>
<span class='curline'><a href='../S/196.html#L2071'>ms</a>               2071 ext/fileinfo/libmagic/softmagic.c 			if (slen + idx &gt; ms-&gt;search.s_len)</span>
<span class='curline'><a href='../S/196.html#L2074'>ms</a>               2074 ext/fileinfo/libmagic/softmagic.c 			v = file_strncmp(m-&gt;value.s, ms-&gt;search.s + idx, slen, m-&gt;str_flags);</span>
<span class='curline'><a href='../S/196.html#L2076'>ms</a>               2076 ext/fileinfo/libmagic/softmagic.c 				ms-&gt;search.offset += idx;</span>
<span class='curline'><a href='../S/196.html#L2114'>ms</a>               2114 ext/fileinfo/libmagic/softmagic.c 			haystack = estrndup(ms-&gt;search.s, ms-&gt;search.s_len);</span>
<span class='curline'><a href='../S/196.html#L2117'>ms</a>               2117 ext/fileinfo/libmagic/softmagic.c 			php_pcre_match_impl(pce, haystack, ms-&gt;search.s_len, retval, subpats, 0, 1, PREG_OFFSET_CAPTURE, 0 TSRMLS_CC);</span>
<span class='curline'><a href='../S/196.html#L2144'>ms</a>               2144 ext/fileinfo/libmagic/softmagic.c 						ms-&gt;search.s += (int)Z_LVAL_PP(offset); /* this is where the match starts */</span>
<span class='curline'><a href='../S/196.html#L2145'>ms</a>               2145 ext/fileinfo/libmagic/softmagic.c 						ms-&gt;search.offset += (size_t)Z_LVAL_PP(offset); /* this is where the match starts as size_t */</span>
<span class='curline'><a href='../S/196.html#L2146'>ms</a>               2146 ext/fileinfo/libmagic/softmagic.c 						ms-&gt;search.rm_len = Z_STRLEN_PP(match) /* This is the length of the matched pattern */;</span>
<span class='curline'><a href='../S/196.html#L2174'>ms</a>               2174 ext/fileinfo/libmagic/softmagic.c 		file_magerror(ms, "invalid type %d in magiccheck()", m-&gt;type);</span>
<span class='curline'><a href='../S/196.html#L2178'>ms</a>               2178 ext/fileinfo/libmagic/softmagic.c 	v = file_signextend(ms, m, v);</span>
<span class='curline'><a href='../S/196.html#L2182'>ms</a>               2182 ext/fileinfo/libmagic/softmagic.c 		if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/196.html#L2190'>ms</a>               2190 ext/fileinfo/libmagic/softmagic.c 		if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/196.html#L2198'>ms</a>               2198 ext/fileinfo/libmagic/softmagic.c 		if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/196.html#L2207'>ms</a>               2207 ext/fileinfo/libmagic/softmagic.c 			if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/196.html#L2215'>ms</a>               2215 ext/fileinfo/libmagic/softmagic.c 			if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/196.html#L2225'>ms</a>               2225 ext/fileinfo/libmagic/softmagic.c 			if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/196.html#L2233'>ms</a>               2233 ext/fileinfo/libmagic/softmagic.c 			if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/196.html#L2242'>ms</a>               2242 ext/fileinfo/libmagic/softmagic.c 		if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/196.html#L2252'>ms</a>               2252 ext/fileinfo/libmagic/softmagic.c 		if ((ms-&gt;flags &amp; MAGIC_DEBUG) != 0)</span>
<span class='curline'><a href='../S/196.html#L2262'>ms</a>               2262 ext/fileinfo/libmagic/softmagic.c 		file_magerror(ms, "cannot happen: invalid relation `%c'",</span>
<span class='curline'><a href='../S/196.html#L2271'>ms</a>               2271 ext/fileinfo/libmagic/softmagic.c handle_annotation(struct magic_set *ms, struct magic *m)</span>
<span class='curline'><a href='../S/196.html#L2273'>ms</a>               2273 ext/fileinfo/libmagic/softmagic.c 	if (ms-&gt;flags &amp; MAGIC_APPLE) {</span>
<span class='curline'><a href='../S/196.html#L2274'>ms</a>               2274 ext/fileinfo/libmagic/softmagic.c 		if (file_printf(ms, "%.8s", m-&gt;apple) == -1)</span>
<span class='curline'><a href='../S/196.html#L2278'>ms</a>               2278 ext/fileinfo/libmagic/softmagic.c 	if ((ms-&gt;flags &amp; MAGIC_MIME_TYPE) &amp;&amp; m-&gt;mimetype[0]) {</span>
<span class='curline'><a href='../S/196.html#L2279'>ms</a>               2279 ext/fileinfo/libmagic/softmagic.c 		if (file_printf(ms, "%s", m-&gt;mimetype) == -1)</span>
<span class='curline'><a href='../S/196.html#L2287'>ms</a>               2287 ext/fileinfo/libmagic/softmagic.c print_sep(struct magic_set *ms, int firstline)</span>
<span class='curline'><a href='../S/196.html#L2289'>ms</a>               2289 ext/fileinfo/libmagic/softmagic.c 	if (ms-&gt;flags &amp; MAGIC_MIME)</span>
<span class='curline'><a href='../S/196.html#L2297'>ms</a>               2297 ext/fileinfo/libmagic/softmagic.c 	return file_printf(ms, "\n- ");</span>
<span class='curline'><a href='../S/1067.html#L2383'>ms</a>               2383 ext/sqlite3/libsqlite/sqlite3.c SQLITE_API int SQLITE_STDCALL sqlite3_busy_timeout(sqlite3*, int ms);</span>
<span class='curline'><a href='../S/1067.html#L15497'>ms</a>               15497 ext/sqlite3/libsqlite/sqlite3.c   double ms = 0.0;</span>
<span class='curline'><a href='../S/1067.html#L15512'>ms</a>               15512 ext/sqlite3/libsqlite/sqlite3.c         ms = ms*10.0 + *zDate - '0';</span>
<span class='curline'><a href='../S/1067.html#L15516'>ms</a>               15516 ext/sqlite3/libsqlite/sqlite3.c       ms /= rScale;</span>
<span class='curline'><a href='../S/1067.html#L15525'>ms</a>               15525 ext/sqlite3/libsqlite/sqlite3.c   p-&gt;s = s + ms;</span>
<span class='curline'><a href='../S/1067.html#L101904'>ms</a>               101904 ext/sqlite3/libsqlite/sqlite3.c   int  (*busy_timeout)(sqlite3*,int ms);</span>
<span class='curline'><a href='../S/1067.html#L129478'>ms</a>               129478 ext/sqlite3/libsqlite/sqlite3.c SQLITE_API int SQLITE_STDCALL sqlite3_busy_timeout(sqlite3 *db, int ms){</span>
<span class='curline'><a href='../S/1067.html#L129482'>ms</a>               129482 ext/sqlite3/libsqlite/sqlite3.c   if( ms&gt;0 ){</span>
<span class='curline'><a href='../S/1067.html#L129484'>ms</a>               129484 ext/sqlite3/libsqlite/sqlite3.c     db-&gt;busyTimeout = ms;</span>
<span class='curline'><a href='../S/1067.html#L131283'>ms</a>               131283 ext/sqlite3/libsqlite/sqlite3.c SQLITE_API int SQLITE_STDCALL sqlite3_sleep(int ms){</span>
<span class='curline'><a href='../S/1067.html#L131292'>ms</a>               131292 ext/sqlite3/libsqlite/sqlite3.c   rc = (sqlite3OsSleep(pVfs, 1000*ms)/1000);</span>
<span class='curline'><a href='../S/1068.html#L2176'>ms</a>               2176 ext/sqlite3/libsqlite/sqlite3.h SQLITE_API int SQLITE_STDCALL sqlite3_busy_timeout(sqlite3*, int ms);</span>
<span class='curline'><a href='../S/1069.html#L49'>ms</a>                 49 ext/sqlite3/libsqlite/sqlite3ext.h   int  (*busy_timeout)(sqlite3*,int ms);</span>
<span class='curline'><a href='../S/1072.html#L327'>ms</a>                327 ext/sqlite3/sqlite3.c 	long ms;</span>
<span class='curline'><a href='../S/1072.html#L333'>ms</a>                333 ext/sqlite3/sqlite3.c 	if (FAILURE == zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "l", &amp;ms)) {</span>
<span class='curline'><a href='../S/1072.html#L337'>ms</a>                337 ext/sqlite3/sqlite3.c 	return_code = sqlite3_busy_timeout(db_obj-&gt;db, ms);</span>
<span class='curline'><a href='../S/1072.html#L1882'>ms</a>               1882 ext/sqlite3/sqlite3.c 	ZEND_ARG_INFO(0, ms)</span>
<span class='curline'><a href='../S/1406.html#L51'>ms</a>                 51 main/streams/memory.c 	php_stream_memory_data *ms = (php_stream_memory_data*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/1406.html#L52'>ms</a>                 52 main/streams/memory.c 	assert(ms != NULL);</span>
<span class='curline'><a href='../S/1406.html#L54'>ms</a>                 54 main/streams/memory.c 	if (ms-&gt;mode &amp; TEMP_STREAM_READONLY) {</span>
<span class='curline'><a href='../S/1406.html#L57'>ms</a>                 57 main/streams/memory.c 	if (ms-&gt;fpos + count &gt; ms-&gt;fsize) {</span>
<span class='curline'><a href='../S/1406.html#L60'>ms</a>                 60 main/streams/memory.c 		if (!ms-&gt;data) {</span>
<span class='curline'><a href='../S/1406.html#L61'>ms</a>                 61 main/streams/memory.c 			tmp = emalloc(ms-&gt;fpos + count);</span>
<span class='curline'><a href='../S/1406.html#L63'>ms</a>                 63 main/streams/memory.c 			tmp = erealloc(ms-&gt;data, ms-&gt;fpos + count);</span>
<span class='curline'><a href='../S/1406.html#L66'>ms</a>                 66 main/streams/memory.c 			count = ms-&gt;fsize - ms-&gt;fpos + 1;</span>
<span class='curline'><a href='../S/1406.html#L68'>ms</a>                 68 main/streams/memory.c 			ms-&gt;data = tmp;</span>
<span class='curline'><a href='../S/1406.html#L69'>ms</a>                 69 main/streams/memory.c 			ms-&gt;fsize = ms-&gt;fpos + count;</span>
<span class='curline'><a href='../S/1406.html#L72'>ms</a>                 72 main/streams/memory.c 	if (!ms-&gt;data)</span>
<span class='curline'><a href='../S/1406.html#L76'>ms</a>                 76 main/streams/memory.c 		memcpy(ms-&gt;data+ms-&gt;fpos, (char*)buf, count);</span>
<span class='curline'><a href='../S/1406.html#L77'>ms</a>                 77 main/streams/memory.c 		ms-&gt;fpos += count;</span>
<span class='curline'><a href='../S/1406.html#L87'>ms</a>                 87 main/streams/memory.c 	php_stream_memory_data *ms = (php_stream_memory_data*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/1406.html#L88'>ms</a>                 88 main/streams/memory.c 	assert(ms != NULL);</span>
<span class='curline'><a href='../S/1406.html#L90'>ms</a>                 90 main/streams/memory.c 	if (ms-&gt;fpos == ms-&gt;fsize) {</span>
<span class='curline'><a href='../S/1406.html#L94'>ms</a>                 94 main/streams/memory.c 		if (ms-&gt;fpos + count &gt;= ms-&gt;fsize) {</span>
<span class='curline'><a href='../S/1406.html#L95'>ms</a>                 95 main/streams/memory.c 			count = ms-&gt;fsize - ms-&gt;fpos;</span>
<span class='curline'><a href='../S/1406.html#L98'>ms</a>                 98 main/streams/memory.c 			assert(ms-&gt;data!= NULL);</span>
<span class='curline'><a href='../S/1406.html#L100'>ms</a>                100 main/streams/memory.c 			memcpy(buf, ms-&gt;data+ms-&gt;fpos, count);</span>
<span class='curline'><a href='../S/1406.html#L101'>ms</a>                101 main/streams/memory.c 			ms-&gt;fpos += count;</span>
<span class='curline'><a href='../S/1406.html#L112'>ms</a>                112 main/streams/memory.c 	php_stream_memory_data *ms = (php_stream_memory_data*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/1406.html#L113'>ms</a>                113 main/streams/memory.c 	assert(ms != NULL);</span>
<span class='curline'><a href='../S/1406.html#L115'>ms</a>                115 main/streams/memory.c 	if (ms-&gt;data &amp;&amp; close_handle &amp;&amp; ms-&gt;mode != TEMP_STREAM_READONLY) {</span>
<span class='curline'><a href='../S/1406.html#L116'>ms</a>                116 main/streams/memory.c 		efree(ms-&gt;data);</span>
<span class='curline'><a href='../S/1406.html#L118'>ms</a>                118 main/streams/memory.c 	efree(ms);</span>
<span class='curline'><a href='../S/1406.html#L136'>ms</a>                136 main/streams/memory.c 	php_stream_memory_data *ms = (php_stream_memory_data*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/1406.html#L137'>ms</a>                137 main/streams/memory.c 	assert(ms != NULL);</span>
<span class='curline'><a href='../S/1406.html#L142'>ms</a>                142 main/streams/memory.c 				if (ms-&gt;fpos &lt; (size_t)(-offset)) {</span>
<span class='curline'><a href='../S/1406.html#L143'>ms</a>                143 main/streams/memory.c 					ms-&gt;fpos = 0;</span>
<span class='curline'><a href='../S/1406.html#L147'>ms</a>                147 main/streams/memory.c 					ms-&gt;fpos = ms-&gt;fpos + offset;</span>
<span class='curline'><a href='../S/1406.html#L148'>ms</a>                148 main/streams/memory.c 					*newoffs = ms-&gt;fpos;</span>
<span class='curline'><a href='../S/1406.html#L153'>ms</a>                153 main/streams/memory.c 				if (ms-&gt;fpos + (size_t)(offset) &gt; ms-&gt;fsize) {</span>
<span class='curline'><a href='../S/1406.html#L154'>ms</a>                154 main/streams/memory.c 					ms-&gt;fpos = ms-&gt;fsize;</span>
<span class='curline'><a href='../S/1406.html#L158'>ms</a>                158 main/streams/memory.c 					ms-&gt;fpos = ms-&gt;fpos + offset;</span>
<span class='curline'><a href='../S/1406.html#L159'>ms</a>                159 main/streams/memory.c 					*newoffs = ms-&gt;fpos;</span>
<span class='curline'><a href='../S/1406.html#L165'>ms</a>                165 main/streams/memory.c 			if (ms-&gt;fsize &lt; (size_t)(offset)) {</span>
<span class='curline'><a href='../S/1406.html#L166'>ms</a>                166 main/streams/memory.c 				ms-&gt;fpos = ms-&gt;fsize;</span>
<span class='curline'><a href='../S/1406.html#L170'>ms</a>                170 main/streams/memory.c 				ms-&gt;fpos = offset;</span>
<span class='curline'><a href='../S/1406.html#L171'>ms</a>                171 main/streams/memory.c 				*newoffs = ms-&gt;fpos;</span>
<span class='curline'><a href='../S/1406.html#L177'>ms</a>                177 main/streams/memory.c 				ms-&gt;fpos = ms-&gt;fsize;</span>
<span class='curline'><a href='../S/1406.html#L180'>ms</a>                180 main/streams/memory.c 			} else if (ms-&gt;fsize &lt; (size_t)(-offset)) {</span>
<span class='curline'><a href='../S/1406.html#L181'>ms</a>                181 main/streams/memory.c 				ms-&gt;fpos = 0;</span>
<span class='curline'><a href='../S/1406.html#L185'>ms</a>                185 main/streams/memory.c 				ms-&gt;fpos = ms-&gt;fsize + offset;</span>
<span class='curline'><a href='../S/1406.html#L186'>ms</a>                186 main/streams/memory.c 				*newoffs = ms-&gt;fpos;</span>
<span class='curline'><a href='../S/1406.html#L191'>ms</a>                191 main/streams/memory.c 			*newoffs = ms-&gt;fpos;</span>
<span class='curline'><a href='../S/1406.html#L207'>ms</a>                207 main/streams/memory.c 	php_stream_memory_data *ms = (php_stream_memory_data*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/1406.html#L208'>ms</a>                208 main/streams/memory.c 	assert(ms != NULL);</span>
<span class='curline'><a href='../S/1406.html#L213'>ms</a>                213 main/streams/memory.c 	ssb-&gt;sb.st_mode = ms-&gt;mode &amp; TEMP_STREAM_READONLY ? 0444 : 0666;</span>
<span class='curline'><a href='../S/1406.html#L215'>ms</a>                215 main/streams/memory.c 	ssb-&gt;sb.st_size = ms-&gt;fsize;</span>
<span class='curline'><a href='../S/1406.html#L249'>ms</a>                249 main/streams/memory.c 	php_stream_memory_data *ms = (php_stream_memory_data*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/1406.html#L259'>ms</a>                259 main/streams/memory.c 					if (ms-&gt;mode &amp; TEMP_STREAM_READONLY) {</span>
<span class='curline'><a href='../S/1406.html#L263'>ms</a>                263 main/streams/memory.c 					if (newsize &lt;= ms-&gt;fsize) {</span>
<span class='curline'><a href='../S/1406.html#L264'>ms</a>                264 main/streams/memory.c 						if (newsize &lt; ms-&gt;fpos) {</span>
<span class='curline'><a href='../S/1406.html#L265'>ms</a>                265 main/streams/memory.c 							ms-&gt;fpos = newsize;</span>
<span class='curline'><a href='../S/1406.html#L268'>ms</a>                268 main/streams/memory.c 						ms-&gt;data = erealloc(ms-&gt;data, newsize);</span>
<span class='curline'><a href='../S/1406.html#L269'>ms</a>                269 main/streams/memory.c 						memset(ms-&gt;data+ms-&gt;fsize, 0, newsize - ms-&gt;fsize);</span>
<span class='curline'><a href='../S/1406.html#L270'>ms</a>                270 main/streams/memory.c 						ms-&gt;fsize = newsize;</span>
<span class='curline'><a href='../S/1406.html#L272'>ms</a>                272 main/streams/memory.c 					ms-&gt;fsize = newsize;</span>
<span class='curline'><a href='../S/1406.html#L316'>ms</a>                316 main/streams/memory.c 	php_stream_memory_data *ms;</span>
<span class='curline'><a href='../S/1406.html#L319'>ms</a>                319 main/streams/memory.c 		ms = (php_stream_memory_data*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/1406.html#L323'>ms</a>                323 main/streams/memory.c 			ms-&gt;data = buf;</span>
<span class='curline'><a href='../S/1406.html#L324'>ms</a>                324 main/streams/memory.c 			ms-&gt;fsize = length;</span>
<span class='curline'><a href='../S/1406.html#L340'>ms</a>                340 main/streams/memory.c 	php_stream_memory_data *ms = (php_stream_memory_data*)stream-&gt;abstract;</span>
<span class='curline'><a href='../S/1406.html#L342'>ms</a>                342 main/streams/memory.c 	assert(ms != NULL);</span>
<span class='curline'><a href='../S/1406.html#L345'>ms</a>                345 main/streams/memory.c 	*length = ms-&gt;fsize;</span>
<span class='curline'><a href='../S/1406.html#L346'>ms</a>                346 main/streams/memory.c 	return ms-&gt;data;</span>
<span class='curline'><a href='../S/1495.html#L376'>ms</a>                376 sapi/fpm/fpm/fpm_events.c 		struct timeval ms;</span>
<span class='curline'><a href='../S/1495.html#L388'>ms</a>                388 sapi/fpm/fpm/fpm_events.c 		timerclear(&amp;ms);</span>
<span class='curline'><a href='../S/1495.html#L393'>ms</a>                393 sapi/fpm/fpm/fpm_events.c 			if (!timerisset(&amp;ms)) {</span>
<span class='curline'><a href='../S/1495.html#L394'>ms</a>                394 sapi/fpm/fpm/fpm_events.c 				ms = q-&gt;ev-&gt;timeout;</span>
<span class='curline'><a href='../S/1495.html#L396'>ms</a>                396 sapi/fpm/fpm/fpm_events.c 				if (timercmp(&amp;q-&gt;ev-&gt;timeout, &amp;ms, &lt;)) {</span>
<span class='curline'><a href='../S/1495.html#L397'>ms</a>                397 sapi/fpm/fpm/fpm_events.c 					ms = q-&gt;ev-&gt;timeout;</span>
<span class='curline'><a href='../S/1495.html#L404'>ms</a>                404 sapi/fpm/fpm/fpm_events.c 		if (!timerisset(&amp;ms) || timercmp(&amp;ms, &amp;now, &lt;) || timercmp(&amp;ms, &amp;now, ==)) {</span>
<span class='curline'><a href='../S/1495.html#L407'>ms</a>                407 sapi/fpm/fpm/fpm_events.c 			timersub(&amp;ms, &amp;now, &amp;tmp);</span>
</pre>
</body>
</html>
