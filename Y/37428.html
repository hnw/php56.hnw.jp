<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>ssl_handle</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/206.html#L188'>ssl_handle</a>        188 ext/ftp/ftp.c  			SSL_shutdown(ftp-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/206.html#L189'>ssl_handle</a>        189 ext/ftp/ftp.c  			SSL_free(ftp-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/206.html#L293'>ssl_handle</a>        293 ext/ftp/ftp.c  		ftp-&gt;ssl_handle = SSL_new(ctx);</span>
<span class='curline'><a href='../S/206.html#L294'>ssl_handle</a>        294 ext/ftp/ftp.c  		if (ftp-&gt;ssl_handle == NULL) {</span>
<span class='curline'><a href='../S/206.html#L300'>ssl_handle</a>        300 ext/ftp/ftp.c  		SSL_set_fd(ftp-&gt;ssl_handle, ftp-&gt;fd);</span>
<span class='curline'><a href='../S/206.html#L302'>ssl_handle</a>        302 ext/ftp/ftp.c  		if (SSL_connect(ftp-&gt;ssl_handle) &lt;= 0) {</span>
<span class='curline'><a href='../S/206.html#L304'>ssl_handle</a>        304 ext/ftp/ftp.c  			SSL_shutdown(ftp-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/206.html#L305'>ssl_handle</a>        305 ext/ftp/ftp.c  			SSL_free(ftp-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/206.html#L1251'>ssl_handle</a>       1251 ext/ftp/ftp.c  			sent = SSL_write(ftp-&gt;ssl_handle, buf, size);</span>
<span class='curline'><a href='../S/206.html#L1253'>ssl_handle</a>       1253 ext/ftp/ftp.c  			sent = SSL_write(ftp-&gt;data-&gt;ssl_handle, buf, size);</span>
<span class='curline'><a href='../S/206.html#L1291'>ssl_handle</a>       1291 ext/ftp/ftp.c  		nr_bytes = SSL_read(ftp-&gt;ssl_handle, buf, len);</span>
<span class='curline'><a href='../S/206.html#L1293'>ssl_handle</a>       1293 ext/ftp/ftp.c  		nr_bytes = SSL_read(ftp-&gt;data-&gt;ssl_handle, buf, len);</span>
<span class='curline'><a href='../S/206.html#L1530'>ssl_handle</a>       1530 ext/ftp/ftp.c  		data-&gt;ssl_handle = SSL_new(ctx);</span>
<span class='curline'><a href='../S/206.html#L1531'>ssl_handle</a>       1531 ext/ftp/ftp.c  		if (data-&gt;ssl_handle == NULL) {</span>
<span class='curline'><a href='../S/206.html#L1538'>ssl_handle</a>       1538 ext/ftp/ftp.c  		SSL_set_fd(data-&gt;ssl_handle, data-&gt;fd);</span>
<span class='curline'><a href='../S/206.html#L1541'>ssl_handle</a>       1541 ext/ftp/ftp.c  			SSL_copy_session_id(data-&gt;ssl_handle, ftp-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/206.html#L1544'>ssl_handle</a>       1544 ext/ftp/ftp.c  		if (SSL_connect(data-&gt;ssl_handle) &lt;= 0) {</span>
<span class='curline'><a href='../S/206.html#L1546'>ssl_handle</a>       1546 ext/ftp/ftp.c  			SSL_shutdown(data-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/206.html#L1547'>ssl_handle</a>       1547 ext/ftp/ftp.c  			SSL_free(data-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/206.html#L1575'>ssl_handle</a>       1575 ext/ftp/ftp.c  			ctx = SSL_get_SSL_CTX(data-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/206.html#L1578'>ssl_handle</a>       1578 ext/ftp/ftp.c  			SSL_shutdown(data-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/206.html#L1579'>ssl_handle</a>       1579 ext/ftp/ftp.c  			SSL_free(data-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/206.html#L1588'>ssl_handle</a>       1588 ext/ftp/ftp.c  			ctx = SSL_get_SSL_CTX(data-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/206.html#L1591'>ssl_handle</a>       1591 ext/ftp/ftp.c  			SSL_shutdown(data-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/206.html#L1592'>ssl_handle</a>       1592 ext/ftp/ftp.c  			SSL_free(data-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/207.html#L54'>ssl_handle</a>         54 ext/ftp/ftp.h  	SSL		*ssl_handle;	/* ssl handle */</span>
<span class='curline'><a href='../S/207.html#L87'>ssl_handle</a>         87 ext/ftp/ftp.h  	SSL				*ssl_handle;      /* handle for control connection */</span>
<span class='curline'><a href='../S/867.html#L108'>ssl_handle</a>        108 ext/openssl/xp_ssl.c 	SSL *ssl_handle;</span>
<span class='curline'><a href='../S/867.html#L153'>ssl_handle</a>        153 ext/openssl/xp_ssl.c 	int err = SSL_get_error(sslsock-&gt;ssl_handle, nr_bytes);</span>
<span class='curline'><a href='../S/867.html#L178'>ssl_handle</a>        178 ext/openssl/xp_ssl.c 					SSL_set_shutdown(sslsock-&gt;ssl_handle, SSL_SENT_SHUTDOWN|SSL_RECEIVED_SHUTDOWN);</span>
<span class='curline'><a href='../S/867.html#L1125'>ssl_handle</a>       1125 ext/openssl/xp_ssl.c 	SSL_set_info_callback(sslsock-&gt;ssl_handle, info_callback);</span>
<span class='curline'><a href='../S/867.html#L1286'>ssl_handle</a>       1286 ext/openssl/xp_ssl.c static int server_sni_callback(SSL *ssl_handle, int *al, void *arg) /* {{{ */</span>
<span class='curline'><a href='../S/867.html#L1293'>ssl_handle</a>       1293 ext/openssl/xp_ssl.c 	server_name = SSL_get_servername(ssl_handle, TLSEXT_NAMETYPE_host_name);</span>
<span class='curline'><a href='../S/867.html#L1299'>ssl_handle</a>       1299 ext/openssl/xp_ssl.c 	stream = (php_stream*)SSL_get_ex_data(ssl_handle, php_openssl_get_ssl_stream_data_index());</span>
<span class='curline'><a href='../S/867.html#L1308'>ssl_handle</a>       1308 ext/openssl/xp_ssl.c 			SSL_set_SSL_CTX(ssl_handle, sslsock-&gt;sni_certs[i].ctx);</span>
<span class='curline'><a href='../S/867.html#L1431'>ssl_handle</a>       1431 ext/openssl/xp_ssl.c 		SSL_set_tlsext_host_name(sslsock-&gt;ssl_handle, sni_server_name);</span>
<span class='curline'><a href='../S/867.html#L1448'>ssl_handle</a>       1448 ext/openssl/xp_ssl.c 	if (sslsock-&gt;ssl_handle) {</span>
<span class='curline'><a href='../S/867.html#L1543'>ssl_handle</a>       1543 ext/openssl/xp_ssl.c 	sslsock-&gt;ssl_handle = SSL_new(sslsock-&gt;ctx);</span>
<span class='curline'><a href='../S/867.html#L1544'>ssl_handle</a>       1544 ext/openssl/xp_ssl.c 	if (sslsock-&gt;ssl_handle == NULL) {</span>
<span class='curline'><a href='../S/867.html#L1550'>ssl_handle</a>       1550 ext/openssl/xp_ssl.c 		SSL_set_ex_data(sslsock-&gt;ssl_handle, php_openssl_get_ssl_stream_data_index(), stream);</span>
<span class='curline'><a href='../S/867.html#L1553'>ssl_handle</a>       1553 ext/openssl/xp_ssl.c 	if (!SSL_set_fd(sslsock-&gt;ssl_handle, sslsock-&gt;s.socket)) {</span>
<span class='curline'><a href='../S/867.html#L1571'>ssl_handle</a>       1571 ext/openssl/xp_ssl.c 		long mode = SSL_get_mode(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/867.html#L1572'>ssl_handle</a>       1572 ext/openssl/xp_ssl.c 		SSL_set_mode(sslsock-&gt;ssl_handle, mode | SSL_MODE_RELEASE_BUFFERS);</span>
<span class='curline'><a href='../S/867.html#L1579'>ssl_handle</a>       1579 ext/openssl/xp_ssl.c 		} else if (((php_openssl_netstream_data_t*)cparam-&gt;inputs.session-&gt;abstract)-&gt;ssl_handle == NULL) {</span>
<span class='curline'><a href='../S/867.html#L1582'>ssl_handle</a>       1582 ext/openssl/xp_ssl.c 			SSL_copy_session_id(sslsock-&gt;ssl_handle, ((php_openssl_netstream_data_t*)cparam-&gt;inputs.session-&gt;abstract)-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/867.html#L1590'>ssl_handle</a>       1590 ext/openssl/xp_ssl.c static zval *capture_session_meta(SSL *ssl_handle) /* {{{ */</span>
<span class='curline'><a href='../S/867.html#L1594'>ssl_handle</a>       1594 ext/openssl/xp_ssl.c 	long proto = SSL_version(ssl_handle);</span>
<span class='curline'><a href='../S/867.html#L1595'>ssl_handle</a>       1595 ext/openssl/xp_ssl.c 	const SSL_CIPHER *cipher = SSL_get_current_cipher(ssl_handle);</span>
<span class='curline'><a href='../S/867.html#L1643'>ssl_handle</a>       1643 ext/openssl/xp_ssl.c 		chain = SSL_get_peer_cert_chain(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/867.html#L1693'>ssl_handle</a>       1693 ext/openssl/xp_ssl.c 				SSL_set_connect_state(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/867.html#L1695'>ssl_handle</a>       1695 ext/openssl/xp_ssl.c 				SSL_set_accept_state(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/867.html#L1716'>ssl_handle</a>       1716 ext/openssl/xp_ssl.c 				n = SSL_connect(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/867.html#L1718'>ssl_handle</a>       1718 ext/openssl/xp_ssl.c 				n = SSL_accept(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/867.html#L1737'>ssl_handle</a>       1737 ext/openssl/xp_ssl.c 					int err = SSL_get_error(sslsock-&gt;ssl_handle, n);</span>
<span class='curline'><a href='../S/867.html#L1756'>ssl_handle</a>       1756 ext/openssl/xp_ssl.c 			peer_cert = SSL_get_peer_certificate(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/867.html#L1761'>ssl_handle</a>       1761 ext/openssl/xp_ssl.c 			if (FAILURE == apply_peer_verification_policy(sslsock-&gt;ssl_handle, peer_cert, stream TSRMLS_CC)) {</span>
<span class='curline'><a href='../S/867.html#L1762'>ssl_handle</a>       1762 ext/openssl/xp_ssl.c 				SSL_shutdown(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/867.html#L1774'>ssl_handle</a>       1774 ext/openssl/xp_ssl.c 						zval *meta_arr = capture_session_meta(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/867.html#L1785'>ssl_handle</a>       1785 ext/openssl/xp_ssl.c 			peer_cert = SSL_get_peer_certificate(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/867.html#L1799'>ssl_handle</a>       1799 ext/openssl/xp_ssl.c 		SSL_shutdown(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/867.html#L1878'>ssl_handle</a>       1878 ext/openssl/xp_ssl.c 				nr_bytes = SSL_read(sslsock-&gt;ssl_handle, buf, count);</span>
<span class='curline'><a href='../S/867.html#L1888'>ssl_handle</a>       1888 ext/openssl/xp_ssl.c 				nr_bytes = SSL_write(sslsock-&gt;ssl_handle, buf, count);</span>
<span class='curline'><a href='../S/867.html#L1900'>ssl_handle</a>       1900 ext/openssl/xp_ssl.c 				int err = SSL_get_error(sslsock-&gt;ssl_handle, nr_bytes );</span>
<span class='curline'><a href='../S/867.html#L1913'>ssl_handle</a>       1913 ext/openssl/xp_ssl.c 					stream-&gt;eof = (retry == 0 &amp;&amp; errno != EAGAIN &amp;&amp; !SSL_pending(sslsock-&gt;ssl_handle));</span>
<span class='curline'><a href='../S/867.html#L1935'>ssl_handle</a>       1935 ext/openssl/xp_ssl.c 				int err = SSL_get_error(sslsock-&gt;ssl_handle, nr_bytes);</span>
<span class='curline'><a href='../S/867.html#L2020'>ssl_handle</a>       2020 ext/openssl/xp_ssl.c 			SSL_shutdown(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/867.html#L2023'>ssl_handle</a>       2023 ext/openssl/xp_ssl.c 		if (sslsock-&gt;ssl_handle) {</span>
<span class='curline'><a href='../S/867.html#L2024'>ssl_handle</a>       2024 ext/openssl/xp_ssl.c 			SSL_free(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/867.html#L2025'>ssl_handle</a>       2025 ext/openssl/xp_ssl.c 			sslsock-&gt;ssl_handle = NULL;</span>
<span class='curline'><a href='../S/867.html#L2186'>ssl_handle</a>       2186 ext/openssl/xp_ssl.c 							n = SSL_peek(sslsock-&gt;ssl_handle, &amp;buf, sizeof(buf));</span>
<span class='curline'><a href='../S/867.html#L2188'>ssl_handle</a>       2188 ext/openssl/xp_ssl.c 								int err = SSL_get_error(sslsock-&gt;ssl_handle, n);</span>
<span class='curline'><a href='../S/867.html#L2295'>ssl_handle</a>       2295 ext/openssl/xp_ssl.c 					&amp;&amp; (pending = (size_t)SSL_pending(sslsock-&gt;ssl_handle)) &gt; 0) {</span>
</pre>
</body>
</html>
