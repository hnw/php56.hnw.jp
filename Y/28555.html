<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>new_persistent_script</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/863.html#L1135'>new_persistent_script</a> 1135 ext/opcache/ZendAccelerator.c static zend_persistent_script *cache_script_in_shared_memory(zend_persistent_script *new_persistent_script, char *key, unsigned int key_length, int *from_shared_memory TSRMLS_DC)</span>
<span class='curline'><a href='../S/863.html#L1141'>new_persistent_script</a> 1141 ext/opcache/ZendAccelerator.c 	if (!zend_accel_script_persistable(new_persistent_script)) {</span>
<span class='curline'><a href='../S/863.html#L1142'>new_persistent_script</a> 1142 ext/opcache/ZendAccelerator.c 		return new_persistent_script;</span>
<span class='curline'><a href='../S/863.html#L1145'>new_persistent_script</a> 1145 ext/opcache/ZendAccelerator.c 	if (!zend_accel_script_optimize(new_persistent_script TSRMLS_CC)) {</span>
<span class='curline'><a href='../S/863.html#L1146'>new_persistent_script</a> 1146 ext/opcache/ZendAccelerator.c 		return new_persistent_script;</span>
<span class='curline'><a href='../S/863.html#L1149'>new_persistent_script</a> 1149 ext/opcache/ZendAccelerator.c 	if (!compact_persistent_script(new_persistent_script)) {</span>
<span class='curline'><a href='../S/863.html#L1150'>new_persistent_script</a> 1150 ext/opcache/ZendAccelerator.c 		return new_persistent_script;</span>
<span class='curline'><a href='../S/863.html#L1161'>new_persistent_script</a> 1161 ext/opcache/ZendAccelerator.c 		return new_persistent_script;</span>
<span class='curline'><a href='../S/863.html#L1167'>new_persistent_script</a> 1167 ext/opcache/ZendAccelerator.c 	bucket = zend_accel_hash_find_entry(&amp;ZCSG(hash), new_persistent_script-&gt;full_path, new_persistent_script-&gt;full_path_len + 1);</span>
<span class='curline'><a href='../S/863.html#L1174'>new_persistent_script</a> 1174 ext/opcache/ZendAccelerator.c 			     (new_persistent_script-&gt;timestamp == existing_persistent_script-&gt;timestamp))) {</span>
<span class='curline'><a href='../S/863.html#L1178'>new_persistent_script</a> 1178 ext/opcache/ZendAccelerator.c 			return new_persistent_script;</span>
<span class='curline'><a href='../S/863.html#L1183'>new_persistent_script</a> 1183 ext/opcache/ZendAccelerator.c 	memory_used = zend_accel_script_persist_calc(new_persistent_script, key, key_length TSRMLS_CC);</span>
<span class='curline'><a href='../S/863.html#L1190'>new_persistent_script</a> 1190 ext/opcache/ZendAccelerator.c 		return new_persistent_script;</span>
<span class='curline'><a href='../S/863.html#L1194'>new_persistent_script</a> 1194 ext/opcache/ZendAccelerator.c 	new_persistent_script-&gt;mem  = ZCG(mem);</span>
<span class='curline'><a href='../S/863.html#L1195'>new_persistent_script</a> 1195 ext/opcache/ZendAccelerator.c 	new_persistent_script-&gt;size = memory_used;</span>
<span class='curline'><a href='../S/863.html#L1198'>new_persistent_script</a> 1198 ext/opcache/ZendAccelerator.c 	new_persistent_script = zend_accel_script_persist(new_persistent_script, &amp;key, key_length TSRMLS_CC);</span>
<span class='curline'><a href='../S/863.html#L1201'>new_persistent_script</a> 1201 ext/opcache/ZendAccelerator.c 	if ((char*)new_persistent_script-&gt;mem + new_persistent_script-&gt;size != (char*)ZCG(mem)) {</span>
<span class='curline'><a href='../S/863.html#L1203'>new_persistent_script</a> 1203 ext/opcache/ZendAccelerator.c 			((char*)new_persistent_script-&gt;mem + new_persistent_script-&gt;size &lt; (char*)ZCG(mem)) ? ACCEL_LOG_ERROR : ACCEL_LOG_WARNING,</span>
<span class='curline'><a href='../S/863.html#L1205'>new_persistent_script</a> 1205 ext/opcache/ZendAccelerator.c 			new_persistent_script-&gt;full_path,</span>
<span class='curline'><a href='../S/863.html#L1206'>new_persistent_script</a> 1206 ext/opcache/ZendAccelerator.c 			new_persistent_script-&gt;mem,</span>
<span class='curline'><a href='../S/863.html#L1207'>new_persistent_script</a> 1207 ext/opcache/ZendAccelerator.c 			(char *)new_persistent_script-&gt;mem + new_persistent_script-&gt;size,</span>
<span class='curline'><a href='../S/863.html#L1211'>new_persistent_script</a> 1211 ext/opcache/ZendAccelerator.c 	new_persistent_script-&gt;dynamic_members.checksum = zend_accel_script_checksum(new_persistent_script);</span>
<span class='curline'><a href='../S/863.html#L1214'>new_persistent_script</a> 1214 ext/opcache/ZendAccelerator.c 	bucket = zend_accel_hash_update(&amp;ZCSG(hash), new_persistent_script-&gt;full_path, new_persistent_script-&gt;full_path_len + 1, 0, new_persistent_script);</span>
<span class='curline'><a href='../S/863.html#L1216'>new_persistent_script</a> 1216 ext/opcache/ZendAccelerator.c 		zend_accel_error(ACCEL_LOG_INFO, "Cached script '%s'", new_persistent_script-&gt;full_path);</span>
<span class='curline'><a href='../S/863.html#L1220'>new_persistent_script</a> 1220 ext/opcache/ZendAccelerator.c 		    (new_persistent_script-&gt;full_path_len != key_length ||</span>
<span class='curline'><a href='../S/863.html#L1221'>new_persistent_script</a> 1221 ext/opcache/ZendAccelerator.c 		     memcmp(new_persistent_script-&gt;full_path, key, key_length) != 0)) {</span>
<span class='curline'><a href='../S/863.html#L1233'>new_persistent_script</a> 1233 ext/opcache/ZendAccelerator.c 	new_persistent_script-&gt;dynamic_members.memory_consumption = ZEND_ALIGNED_SIZE(new_persistent_script-&gt;size);</span>
<span class='curline'><a href='../S/863.html#L1238'>new_persistent_script</a> 1238 ext/opcache/ZendAccelerator.c 	return new_persistent_script;</span>
<span class='curline'><a href='../S/863.html#L1294'>new_persistent_script</a> 1294 ext/opcache/ZendAccelerator.c 	zend_persistent_script *new_persistent_script;</span>
<span class='curline'><a href='../S/863.html#L1371'>new_persistent_script</a> 1371 ext/opcache/ZendAccelerator.c 	new_persistent_script = create_persistent_script();</span>
<span class='curline'><a href='../S/863.html#L1381'>new_persistent_script</a> 1381 ext/opcache/ZendAccelerator.c 	EG(class_table) = CG(class_table) = &amp;new_persistent_script-&gt;class_table;</span>
<span class='curline'><a href='../S/863.html#L1412'>new_persistent_script</a> 1412 ext/opcache/ZendAccelerator.c 		free_persistent_script(new_persistent_script, 1);</span>
<span class='curline'><a href='../S/863.html#L1424'>new_persistent_script</a> 1424 ext/opcache/ZendAccelerator.c 	zend_accel_move_user_functions(&amp;ZCG(function_table), &amp;new_persistent_script-&gt;function_table TSRMLS_CC);</span>
<span class='curline'><a href='../S/863.html#L1425'>new_persistent_script</a> 1425 ext/opcache/ZendAccelerator.c 	new_persistent_script-&gt;main_op_array = *op_array;</span>
<span class='curline'><a href='../S/863.html#L1433'>new_persistent_script</a> 1433 ext/opcache/ZendAccelerator.c 		new_persistent_script-&gt;ping_auto_globals_mask = zend_accel_get_auto_globals(TSRMLS_C);</span>
<span class='curline'><a href='../S/863.html#L1435'>new_persistent_script</a> 1435 ext/opcache/ZendAccelerator.c 		new_persistent_script-&gt;ping_auto_globals_mask = zend_accel_get_auto_globals_no_jit(TSRMLS_C);</span>
<span class='curline'><a href='../S/863.html#L1439'>new_persistent_script</a> 1439 ext/opcache/ZendAccelerator.c 		new_persistent_script-&gt;ping_auto_globals_mask = zend_accel_get_auto_globals(TSRMLS_C);</span>
<span class='curline'><a href='../S/863.html#L1447'>new_persistent_script</a> 1447 ext/opcache/ZendAccelerator.c 		new_persistent_script-&gt;timestamp = timestamp;</span>
<span class='curline'><a href='../S/863.html#L1448'>new_persistent_script</a> 1448 ext/opcache/ZendAccelerator.c 		new_persistent_script-&gt;dynamic_members.revalidate = ZCG(request_time) + ZCG(accel_directives).revalidate_freq;</span>
<span class='curline'><a href='../S/863.html#L1452'>new_persistent_script</a> 1452 ext/opcache/ZendAccelerator.c 		new_persistent_script-&gt;full_path_len = strlen(file_handle-&gt;opened_path);</span>
<span class='curline'><a href='../S/863.html#L1453'>new_persistent_script</a> 1453 ext/opcache/ZendAccelerator.c 		new_persistent_script-&gt;full_path = estrndup(file_handle-&gt;opened_path, new_persistent_script-&gt;full_path_len);</span>
<span class='curline'><a href='../S/863.html#L1455'>new_persistent_script</a> 1455 ext/opcache/ZendAccelerator.c 		new_persistent_script-&gt;full_path_len = strlen(file_handle-&gt;filename);</span>
<span class='curline'><a href='../S/863.html#L1456'>new_persistent_script</a> 1456 ext/opcache/ZendAccelerator.c 		new_persistent_script-&gt;full_path = estrndup(file_handle-&gt;filename, new_persistent_script-&gt;full_path_len);</span>
<span class='curline'><a href='../S/863.html#L1458'>new_persistent_script</a> 1458 ext/opcache/ZendAccelerator.c 	new_persistent_script-&gt;hash_value = zend_hash_func(new_persistent_script-&gt;full_path, new_persistent_script-&gt;full_path_len + 1);</span>
<span class='curline'><a href='../S/863.html#L1461'>new_persistent_script</a> 1461 ext/opcache/ZendAccelerator.c 	return cache_script_in_shared_memory(new_persistent_script, key, key_length, from_shared_memory TSRMLS_CC);</span>
<span class='curline'><a href='../S/860.html#L362'>new_persistent_script</a>  362 ext/opcache/zend_persist_calc.c uint zend_accel_script_persist_calc(zend_persistent_script *new_persistent_script, char *key, unsigned int key_length TSRMLS_DC)</span>
<span class='curline'><a href='../S/860.html#L366'>new_persistent_script</a>  366 ext/opcache/zend_persist_calc.c 	ADD_SIZE(zend_hash_persist_calc(&amp;new_persistent_script-&gt;function_table, (int (*)(void* TSRMLS_DC)) zend_persist_op_array_calc, sizeof(zend_op_array) TSRMLS_CC));</span>
<span class='curline'><a href='../S/860.html#L367'>new_persistent_script</a>  367 ext/opcache/zend_persist_calc.c 	ADD_SIZE(zend_accel_persist_class_table_calc(&amp;new_persistent_script-&gt;class_table TSRMLS_CC));</span>
<span class='curline'><a href='../S/860.html#L368'>new_persistent_script</a>  368 ext/opcache/zend_persist_calc.c 	ADD_SIZE(zend_persist_op_array_calc(&amp;new_persistent_script-&gt;main_op_array TSRMLS_CC));</span>
<span class='curline'><a href='../S/860.html#L370'>new_persistent_script</a>  370 ext/opcache/zend_persist_calc.c 	ADD_DUP_SIZE(new_persistent_script-&gt;full_path, new_persistent_script-&gt;full_path_len + 1);</span>
<span class='curline'><a href='../S/860.html#L371'>new_persistent_script</a>  371 ext/opcache/zend_persist_calc.c 	ADD_DUP_SIZE(new_persistent_script, sizeof(zend_persistent_script));</span>
</pre>
</body>
</html>
