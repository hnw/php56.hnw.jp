<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>pkey</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/865.html#L548'>pkey</a>              548 ext/openssl/openssl.c 	EVP_PKEY *pkey = (EVP_PKEY *)rsrc-&gt;ptr;</span>
<span class='curline'><a href='../S/865.html#L550'>pkey</a>              550 ext/openssl/openssl.c 	assert(pkey != NULL);</span>
<span class='curline'><a href='../S/865.html#L552'>pkey</a>              552 ext/openssl/openssl.c 	EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/865.html#L621'>pkey</a>              621 ext/openssl/openssl.c static int php_openssl_is_private_key(EVP_PKEY* pkey TSRMLS_DC);</span>
<span class='curline'><a href='../S/865.html#L1469'>pkey</a>             1469 ext/openssl/openssl.c 	EVP_PKEY * pkey = NULL;</span>
<span class='curline'><a href='../S/865.html#L1478'>pkey</a>             1478 ext/openssl/openssl.c 	pkey = php_openssl_evp_from_zval(&amp;zpkey, 0, challenge, 1, &amp;keyresource TSRMLS_CC);</span>
<span class='curline'><a href='../S/865.html#L1480'>pkey</a>             1480 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/865.html#L1509'>pkey</a>             1509 ext/openssl/openssl.c 	if (!NETSCAPE_SPKI_set_pubkey(spki, pkey)) {</span>
<span class='curline'><a href='../S/865.html#L1514'>pkey</a>             1514 ext/openssl/openssl.c 	if (!NETSCAPE_SPKI_sign(spki, pkey, mdtype)) {</span>
<span class='curline'><a href='../S/865.html#L1536'>pkey</a>             1536 ext/openssl/openssl.c 	if (keyresource == -1 &amp;&amp; pkey != NULL) {</span>
<span class='curline'><a href='../S/865.html#L1537'>pkey</a>             1537 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/865.html#L1560'>pkey</a>             1560 ext/openssl/openssl.c 	EVP_PKEY *pkey = NULL;</span>
<span class='curline'><a href='../S/865.html#L1587'>pkey</a>             1587 ext/openssl/openssl.c 	pkey = X509_PUBKEY_get(spki-&gt;spkac-&gt;pubkey);</span>
<span class='curline'><a href='../S/865.html#L1588'>pkey</a>             1588 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/865.html#L1593'>pkey</a>             1593 ext/openssl/openssl.c 	i = NETSCAPE_SPKI_verify(spki, pkey);</span>
<span class='curline'><a href='../S/865.html#L1600'>pkey</a>             1600 ext/openssl/openssl.c 	if (pkey != NULL) {</span>
<span class='curline'><a href='../S/865.html#L1601'>pkey</a>             1601 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/865.html#L1620'>pkey</a>             1620 ext/openssl/openssl.c 	EVP_PKEY *pkey = NULL;</span>
<span class='curline'><a href='../S/865.html#L1643'>pkey</a>             1643 ext/openssl/openssl.c 	pkey = X509_PUBKEY_get(spki-&gt;spkac-&gt;pubkey);</span>
<span class='curline'><a href='../S/865.html#L1644'>pkey</a>             1644 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/865.html#L1650'>pkey</a>             1650 ext/openssl/openssl.c 	if (out &amp;&amp; PEM_write_bio_PUBKEY(out, pkey))  {</span>
<span class='curline'><a href='../S/865.html#L1666'>pkey</a>             1666 ext/openssl/openssl.c 	if (pkey != NULL) {</span>
<span class='curline'><a href='../S/865.html#L1667'>pkey</a>             1667 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/865.html#L2539'>pkey</a>             2539 ext/openssl/openssl.c 	EVP_PKEY * pkey = NULL;</span>
<span class='curline'><a href='../S/865.html#L2556'>pkey</a>             2556 ext/openssl/openssl.c 		if(PKCS12_parse(p12, pass, &amp;pkey, &amp;cert, &amp;ca)) {</span>
<span class='curline'><a href='../S/865.html#L2573'>pkey</a>             2573 ext/openssl/openssl.c 			if (PEM_write_bio_PrivateKey(bio_out, pkey, NULL, NULL, 0, 0, NULL)) {</span>
<span class='curline'><a href='../S/865.html#L2628'>pkey</a>             2628 ext/openssl/openssl.c 	if (pkey) {</span>
<span class='curline'><a href='../S/865.html#L2629'>pkey</a>             2629 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/865.html#L3458'>pkey</a>             3458 ext/openssl/openssl.c static int php_openssl_is_private_key(EVP_PKEY* pkey TSRMLS_DC)</span>
<span class='curline'><a href='../S/865.html#L3460'>pkey</a>             3460 ext/openssl/openssl.c 	assert(pkey != NULL);</span>
<span class='curline'><a href='../S/865.html#L3462'>pkey</a>             3462 ext/openssl/openssl.c 	switch (pkey-&gt;type) {</span>
<span class='curline'><a href='../S/865.html#L3466'>pkey</a>             3466 ext/openssl/openssl.c 			assert(pkey-&gt;pkey.rsa != NULL);</span>
<span class='curline'><a href='../S/865.html#L3467'>pkey</a>             3467 ext/openssl/openssl.c 			if (pkey-&gt;pkey.rsa != NULL &amp;&amp; (NULL == pkey-&gt;pkey.rsa-&gt;p || NULL == pkey-&gt;pkey.rsa-&gt;q)) {</span>
<span class='curline'><a href='../S/865.html#L3478'>pkey</a>             3478 ext/openssl/openssl.c 			assert(pkey-&gt;pkey.dsa != NULL);</span>
<span class='curline'><a href='../S/865.html#L3480'>pkey</a>             3480 ext/openssl/openssl.c 			if (NULL == pkey-&gt;pkey.dsa-&gt;p || NULL == pkey-&gt;pkey.dsa-&gt;q || NULL == pkey-&gt;pkey.dsa-&gt;priv_key){ </span>
<span class='curline'><a href='../S/865.html#L3487'>pkey</a>             3487 ext/openssl/openssl.c 			assert(pkey-&gt;pkey.dh != NULL);</span>
<span class='curline'><a href='../S/865.html#L3489'>pkey</a>             3489 ext/openssl/openssl.c 			if (NULL == pkey-&gt;pkey.dh-&gt;p || NULL == pkey-&gt;pkey.dh-&gt;priv_key) {</span>
<span class='curline'><a href='../S/865.html#L3496'>pkey</a>             3496 ext/openssl/openssl.c 			assert(pkey-&gt;pkey.ec != NULL);</span>
<span class='curline'><a href='../S/865.html#L3498'>pkey</a>             3498 ext/openssl/openssl.c 			if ( NULL == EC_KEY_get0_private_key(pkey-&gt;pkey.ec)) {</span>
<span class='curline'><a href='../S/865.html#L3512'>pkey</a>             3512 ext/openssl/openssl.c 		if (pkey-&gt;pkey._type-&gt;_name != NULL) {							\</span>
<span class='curline'><a href='../S/865.html#L3513'>pkey</a>             3513 ext/openssl/openssl.c 			int len = BN_num_bytes(pkey-&gt;pkey._type-&gt;_name);			\</span>
<span class='curline'><a href='../S/865.html#L3515'>pkey</a>             3515 ext/openssl/openssl.c 			BN_bn2bin(pkey-&gt;pkey._type-&gt;_name, (unsigned char*)str);	\</span>
<span class='curline'><a href='../S/865.html#L3546'>pkey</a>             3546 ext/openssl/openssl.c 		EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/865.html#L3550'>pkey</a>             3550 ext/openssl/openssl.c 		    pkey = EVP_PKEY_new();</span>
<span class='curline'><a href='../S/865.html#L3551'>pkey</a>             3551 ext/openssl/openssl.c 		    if (pkey) {</span>
<span class='curline'><a href='../S/865.html#L3563'>pkey</a>             3563 ext/openssl/openssl.c 						if (EVP_PKEY_assign_RSA(pkey, rsa)) {</span>
<span class='curline'><a href='../S/865.html#L3564'>pkey</a>             3564 ext/openssl/openssl.c 							RETURN_RESOURCE(zend_list_insert(pkey, le_key TSRMLS_CC));</span>
<span class='curline'><a href='../S/865.html#L3569'>pkey</a>             3569 ext/openssl/openssl.c 				EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/865.html#L3574'>pkey</a>             3574 ext/openssl/openssl.c 		    pkey = EVP_PKEY_new();</span>
<span class='curline'><a href='../S/865.html#L3575'>pkey</a>             3575 ext/openssl/openssl.c 		    if (pkey) {</span>
<span class='curline'><a href='../S/865.html#L3587'>pkey</a>             3587 ext/openssl/openssl.c 						if (EVP_PKEY_assign_DSA(pkey, dsa)) {</span>
<span class='curline'><a href='../S/865.html#L3588'>pkey</a>             3588 ext/openssl/openssl.c 							RETURN_RESOURCE(zend_list_insert(pkey, le_key TSRMLS_CC));</span>
<span class='curline'><a href='../S/865.html#L3593'>pkey</a>             3593 ext/openssl/openssl.c 				EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/865.html#L3598'>pkey</a>             3598 ext/openssl/openssl.c 		    pkey = EVP_PKEY_new();</span>
<span class='curline'><a href='../S/865.html#L3599'>pkey</a>             3599 ext/openssl/openssl.c 		    if (pkey) {</span>
<span class='curline'><a href='../S/865.html#L3608'>pkey</a>             3608 ext/openssl/openssl.c 							EVP_PKEY_assign_DH(pkey, dh)) {</span>
<span class='curline'><a href='../S/865.html#L3609'>pkey</a>             3609 ext/openssl/openssl.c 						RETURN_RESOURCE(zend_list_insert(pkey, le_key TSRMLS_CC));</span>
<span class='curline'><a href='../S/865.html#L3613'>pkey</a>             3613 ext/openssl/openssl.c 				EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/865.html#L3790'>pkey</a>             3790 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/865.html#L3796'>pkey</a>             3796 ext/openssl/openssl.c 	pkey = php_openssl_evp_from_zval(cert, 1, NULL, 1, &amp;Z_LVAL_P(return_value) TSRMLS_CC);</span>
<span class='curline'><a href='../S/865.html#L3798'>pkey</a>             3798 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/865.html#L3810'>pkey</a>             3810 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/865.html#L3815'>pkey</a>             3815 ext/openssl/openssl.c 	ZEND_FETCH_RESOURCE(pkey, EVP_PKEY *, &amp;key, -1, "OpenSSL key", le_key);</span>
<span class='curline'><a href='../S/865.html#L3825'>pkey</a>             3825 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/865.html#L3833'>pkey</a>             3833 ext/openssl/openssl.c 	pkey = php_openssl_evp_from_zval(cert, 0, passphrase, 1, &amp;Z_LVAL_P(return_value) TSRMLS_CC);</span>
<span class='curline'><a href='../S/865.html#L3835'>pkey</a>             3835 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/865.html#L3848'>pkey</a>             3848 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/865.html#L3857'>pkey</a>             3857 ext/openssl/openssl.c 	ZEND_FETCH_RESOURCE(pkey, EVP_PKEY *, &amp;key, -1, "OpenSSL key", le_key);</span>
<span class='curline'><a href='../S/865.html#L3858'>pkey</a>             3858 ext/openssl/openssl.c 	if (!pkey) {</span>
<span class='curline'><a href='../S/865.html#L3862'>pkey</a>             3862 ext/openssl/openssl.c 	PEM_write_bio_PUBKEY(out, pkey);</span>
<span class='curline'><a href='../S/865.html#L3866'>pkey</a>             3866 ext/openssl/openssl.c 	add_assoc_long(return_value, "bits", EVP_PKEY_bits(pkey));</span>
<span class='curline'><a href='../S/865.html#L3871'>pkey</a>             3871 ext/openssl/openssl.c 	switch (EVP_PKEY_type(pkey-&gt;type)) {</span>
<span class='curline'><a href='../S/865.html#L3876'>pkey</a>             3876 ext/openssl/openssl.c 			if (pkey-&gt;pkey.rsa != NULL) {</span>
<span class='curline'><a href='../S/865.html#L3899'>pkey</a>             3899 ext/openssl/openssl.c 			if (pkey-&gt;pkey.dsa != NULL) {</span>
<span class='curline'><a href='../S/865.html#L3916'>pkey</a>             3916 ext/openssl/openssl.c 			if (pkey-&gt;pkey.dh != NULL) {</span>
<span class='curline'><a href='../S/865.html#L3932'>pkey</a>             3932 ext/openssl/openssl.c 			if (pkey-&gt;pkey.ec != NULL) {</span>
<span class='curline'><a href='../S/865.html#L3941'>pkey</a>             3941 ext/openssl/openssl.c 				ec_group = EC_KEY_get0_group(EVP_PKEY_get1_EC_KEY(pkey));</span>
<span class='curline'><a href='../S/865.html#L4465'>pkey</a>             4465 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/865.html#L4479'>pkey</a>             4479 ext/openssl/openssl.c 	pkey = php_openssl_evp_from_zval(key, 0, "", 0, &amp;keyresource TSRMLS_CC);</span>
<span class='curline'><a href='../S/865.html#L4481'>pkey</a>             4481 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/865.html#L4486'>pkey</a>             4486 ext/openssl/openssl.c 	cryptedlen = EVP_PKEY_size(pkey);</span>
<span class='curline'><a href='../S/865.html#L4489'>pkey</a>             4489 ext/openssl/openssl.c 	switch (pkey-&gt;type) {</span>
<span class='curline'><a href='../S/865.html#L4495'>pkey</a>             4495 ext/openssl/openssl.c 						pkey-&gt;pkey.rsa, </span>
<span class='curline'><a href='../S/865.html#L4513'>pkey</a>             4513 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/865.html#L4523'>pkey</a>             4523 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/865.html#L4538'>pkey</a>             4538 ext/openssl/openssl.c 	pkey = php_openssl_evp_from_zval(key, 0, "", 0, &amp;keyresource TSRMLS_CC);</span>
<span class='curline'><a href='../S/865.html#L4539'>pkey</a>             4539 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/865.html#L4544'>pkey</a>             4544 ext/openssl/openssl.c 	cryptedlen = EVP_PKEY_size(pkey);</span>
<span class='curline'><a href='../S/865.html#L4547'>pkey</a>             4547 ext/openssl/openssl.c 	switch (pkey-&gt;type) {</span>
<span class='curline'><a href='../S/865.html#L4553'>pkey</a>             4553 ext/openssl/openssl.c 					pkey-&gt;pkey.rsa, </span>
<span class='curline'><a href='../S/865.html#L4576'>pkey</a>             4576 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/865.html#L4589'>pkey</a>             4589 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/865.html#L4603'>pkey</a>             4603 ext/openssl/openssl.c 	pkey = php_openssl_evp_from_zval(key, 1, NULL, 0, &amp;keyresource TSRMLS_CC);</span>
<span class='curline'><a href='../S/865.html#L4604'>pkey</a>             4604 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/865.html#L4609'>pkey</a>             4609 ext/openssl/openssl.c 	cryptedlen = EVP_PKEY_size(pkey);</span>
<span class='curline'><a href='../S/865.html#L4612'>pkey</a>             4612 ext/openssl/openssl.c 	switch (pkey-&gt;type) {</span>
<span class='curline'><a href='../S/865.html#L4618'>pkey</a>             4618 ext/openssl/openssl.c 						pkey-&gt;pkey.rsa, </span>
<span class='curline'><a href='../S/865.html#L4634'>pkey</a>             4634 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/865.html#L4647'>pkey</a>             4647 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/865.html#L4662'>pkey</a>             4662 ext/openssl/openssl.c 	pkey = php_openssl_evp_from_zval(key, 1, NULL, 0, &amp;keyresource TSRMLS_CC);</span>
<span class='curline'><a href='../S/865.html#L4663'>pkey</a>             4663 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/865.html#L4668'>pkey</a>             4668 ext/openssl/openssl.c 	cryptedlen = EVP_PKEY_size(pkey);</span>
<span class='curline'><a href='../S/865.html#L4671'>pkey</a>             4671 ext/openssl/openssl.c 	switch (pkey-&gt;type) {</span>
<span class='curline'><a href='../S/865.html#L4677'>pkey</a>             4677 ext/openssl/openssl.c 					pkey-&gt;pkey.rsa, </span>
<span class='curline'><a href='../S/865.html#L4705'>pkey</a>             4705 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/865.html#L4735'>pkey</a>             4735 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/865.html#L4749'>pkey</a>             4749 ext/openssl/openssl.c 	pkey = php_openssl_evp_from_zval(key, 0, "", 0, &amp;keyresource TSRMLS_CC);</span>
<span class='curline'><a href='../S/865.html#L4750'>pkey</a>             4750 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/865.html#L4771'>pkey</a>             4771 ext/openssl/openssl.c 	siglen = EVP_PKEY_size(pkey);</span>
<span class='curline'><a href='../S/865.html#L4776'>pkey</a>             4776 ext/openssl/openssl.c 	if (EVP_SignFinal (&amp;md_ctx, sigbuf,(unsigned int *)&amp;siglen, pkey)) {</span>
<span class='curline'><a href='../S/865.html#L4787'>pkey</a>             4787 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/865.html#L4797'>pkey</a>             4797 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/865.html#L4827'>pkey</a>             4827 ext/openssl/openssl.c 	pkey = php_openssl_evp_from_zval(key, 1, NULL, 0, &amp;keyresource TSRMLS_CC);</span>
<span class='curline'><a href='../S/865.html#L4828'>pkey</a>             4828 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/865.html#L4835'>pkey</a>             4835 ext/openssl/openssl.c 	err = EVP_VerifyFinal (&amp;md_ctx, (unsigned char *)signature, signature_len, pkey);</span>
<span class='curline'><a href='../S/865.html#L4839'>pkey</a>             4839 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/865.html#L4984'>pkey</a>             4984 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/865.html#L4999'>pkey</a>             4999 ext/openssl/openssl.c 	pkey = php_openssl_evp_from_zval(privkey, 0, "", 0, &amp;keyresource TSRMLS_CC);</span>
<span class='curline'><a href='../S/865.html#L5000'>pkey</a>             5000 ext/openssl/openssl.c 	if (pkey == NULL) {</span>
<span class='curline'><a href='../S/865.html#L5017'>pkey</a>             5017 ext/openssl/openssl.c 	if (EVP_OpenInit(&amp;ctx, cipher, (unsigned char *)ekey, ekey_len, NULL, pkey) &amp;&amp; EVP_OpenUpdate(&amp;ctx, buf, &amp;len1, (unsigned char *)data, data_len)) {</span>
<span class='curline'><a href='../S/865.html#L5032'>pkey</a>             5032 ext/openssl/openssl.c 		EVP_PKEY_free(pkey);</span>
<span class='curline'><a href='../S/865.html#L5363'>pkey</a>             5363 ext/openssl/openssl.c 	EVP_PKEY *pkey;</span>
<span class='curline'><a href='../S/865.html#L5371'>pkey</a>             5371 ext/openssl/openssl.c 	ZEND_FETCH_RESOURCE(pkey, EVP_PKEY *, &amp;key, -1, "OpenSSL key", le_key);</span>
<span class='curline'><a href='../S/865.html#L5372'>pkey</a>             5372 ext/openssl/openssl.c 	if (!pkey || EVP_PKEY_type(pkey-&gt;type) != EVP_PKEY_DH || !pkey-&gt;pkey.dh) {</span>
<span class='curline'><a href='../S/865.html#L5378'>pkey</a>             5378 ext/openssl/openssl.c 	data = emalloc(DH_size(pkey-&gt;pkey.dh) + 1);</span>
<span class='curline'><a href='../S/865.html#L5379'>pkey</a>             5379 ext/openssl/openssl.c 	len = DH_compute_key((unsigned char*)data, pub, pkey-&gt;pkey.dh);</span>
</pre>
</body>
</html>
