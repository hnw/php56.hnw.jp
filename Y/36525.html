<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>signature</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/865.html#L339'>signature</a>         339 ext/openssl/openssl.c 	ZEND_ARG_INFO(1, signature)</span>
<span class='curline'><a href='../S/865.html#L346'>signature</a>         346 ext/openssl/openssl.c 	ZEND_ARG_INFO(0, signature)</span>
<span class='curline'><a href='../S/865.html#L4734'>signature</a>        4734 ext/openssl/openssl.c 	zval **key, *signature;</span>
<span class='curline'><a href='../S/865.html#L4746'>signature</a>        4746 ext/openssl/openssl.c 	if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "szZ|z", &amp;data, &amp;data_len, &amp;signature, &amp;key, &amp;method) == FAILURE) {</span>
<span class='curline'><a href='../S/865.html#L4777'>signature</a>        4777 ext/openssl/openssl.c 		zval_dtor(signature);</span>
<span class='curline'><a href='../S/865.html#L4779'>signature</a>        4779 ext/openssl/openssl.c 		ZVAL_STRINGL(signature, (char *)sigbuf, siglen, 0);</span>
<span class='curline'><a href='../S/865.html#L4803'>signature</a>        4803 ext/openssl/openssl.c 	char * signature;	int signature_len;</span>
<span class='curline'><a href='../S/865.html#L4807'>signature</a>        4807 ext/openssl/openssl.c 	if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "ssZ|z", &amp;data, &amp;data_len, &amp;signature, &amp;signature_len, &amp;key, &amp;method) == FAILURE) {</span>
<span class='curline'><a href='../S/865.html#L4835'>signature</a>        4835 ext/openssl/openssl.c 	err = EVP_VerifyFinal (&amp;md_ctx, (unsigned char *)signature, signature_len, pkey);</span>
<span class='curline'><a href='../S/973.html#L219'>signature</a>         219 ext/phar/phar.c 	if (phar-&gt;signature) {</span>
<span class='curline'><a href='../S/973.html#L220'>signature</a>         220 ext/phar/phar.c 		pefree(phar-&gt;signature, phar-&gt;is_persistent);</span>
<span class='curline'><a href='../S/973.html#L221'>signature</a>         221 ext/phar/phar.c 		phar-&gt;signature = NULL;</span>
<span class='curline'><a href='../S/973.html#L495'>signature</a>         495 ext/phar/phar.c 	if (signature) {\</span>
<span class='curline'><a href='../S/973.html#L496'>signature</a>         496 ext/phar/phar.c 		pefree(signature, PHAR_G(persist));\</span>
<span class='curline'><a href='../S/973.html#L660'>signature</a>         660 ext/phar/phar.c 	char *signature = NULL;</span>
<span class='curline'><a href='../S/973.html#L812'>signature</a>         812 ext/phar/phar.c 				if (FAILURE == phar_verify_signature(fp, end_of_phar, PHAR_SIG_OPENSSL, sig, signature_len, fname, &amp;signature, &amp;sig_len, error TSRMLS_CC)) {</span>
<span class='curline'><a href='../S/973.html#L842'>signature</a>         842 ext/phar/phar.c 				if (FAILURE == phar_verify_signature(fp, read_len, PHAR_SIG_SHA512, (char *)digest, 64, fname, &amp;signature, &amp;sig_len, error TSRMLS_CC)) {</span>
<span class='curline'><a href='../S/973.html#L869'>signature</a>         869 ext/phar/phar.c 				if (FAILURE == phar_verify_signature(fp, read_len, PHAR_SIG_SHA256, (char *)digest, 32, fname, &amp;signature, &amp;sig_len, error TSRMLS_CC)) {</span>
<span class='curline'><a href='../S/973.html#L907'>signature</a>         907 ext/phar/phar.c 				if (FAILURE == phar_verify_signature(fp, read_len, PHAR_SIG_SHA1, (char *)digest, 20, fname, &amp;signature, &amp;sig_len, error TSRMLS_CC)) {</span>
<span class='curline'><a href='../S/973.html#L934'>signature</a>         934 ext/phar/phar.c 				if (FAILURE == phar_verify_signature(fp, read_len, PHAR_SIG_MD5, (char *)digest, 16, fname, &amp;signature, &amp;sig_len, error TSRMLS_CC)) {</span>
<span class='curline'><a href='../S/973.html#L987'>signature</a>         987 ext/phar/phar.c 			if (signature) {</span>
<span class='curline'><a href='../S/973.html#L988'>signature</a>         988 ext/phar/phar.c 				efree(signature);</span>
<span class='curline'><a href='../S/973.html#L1199'>signature</a>        1199 ext/phar/phar.c 	mydata-&gt;signature = signature;</span>
<span class='curline'><a href='../S/973.html#L1208'>signature</a>        1208 ext/phar/phar.c 			signature = NULL;</span>
<span class='curline'><a href='../S/973.html#L1215'>signature</a>        1215 ext/phar/phar.c 				signature = NULL;</span>
<span class='curline'><a href='../S/973.html#L2427'>signature</a>        2427 ext/phar/phar.c 			if (desc.signature[0] == 'P' &amp;&amp; desc.signature[1] == 'K') {</span>
<span class='curline'><a href='../S/973.html#L3151'>signature</a>        3151 ext/phar/phar.c 		if (phar-&gt;signature) {</span>
<span class='curline'><a href='../S/973.html#L3152'>signature</a>        3152 ext/phar/phar.c 			efree(phar-&gt;signature);</span>
<span class='curline'><a href='../S/973.html#L3153'>signature</a>        3153 ext/phar/phar.c 			phar-&gt;signature = NULL;</span>
<span class='curline'><a href='../S/974.html#L315'>signature</a>         315 ext/phar/phar_internal.h 	char                     *signature;</span>
<span class='curline'><a href='../S/974.html#L567'>signature</a>         567 ext/phar/phar_internal.h int phar_verify_signature(php_stream *fp, size_t end_of_phar, php_uint32 sig_type, char *sig, int sig_len, char *fname, char **signature, int *signature_len, char **error TSRMLS_DC);</span>
<span class='curline'><a href='../S/974.html#L568'>signature</a>         568 ext/phar/phar_internal.h int phar_create_signature(phar_archive_data *phar, php_stream *fp, char **signature, int *signature_length, char **error TSRMLS_DC);</span>
<span class='curline'><a href='../S/975.html#L3093'>signature</a>        3093 ext/phar/phar_object.c 	if (phar_obj-&gt;arc.archive-&gt;signature) {</span>
<span class='curline'><a href='../S/975.html#L3098'>signature</a>        3098 ext/phar/phar_object.c 		add_assoc_stringl(return_value, "hash", phar_obj-&gt;arc.archive-&gt;signature, phar_obj-&gt;arc.archive-&gt;sig_len, 1);</span>
<span class='curline'><a href='../S/977.html#L23'>signature</a>          23 ext/phar/pharzip.h 	char signature[4];       /* local file header signature     4 bytes  (0x04034b50) */</span>
<span class='curline'><a href='../S/977.html#L40'>signature</a>          40 ext/phar/pharzip.h 	char signature[4];  /* signature (optional)            4 bytes */</span>
<span class='curline'><a href='../S/977.html#L56'>signature</a>          56 ext/phar/pharzip.h 	char signature[4];   /* archive extra data signature    4 bytes  (0x08064b50) */</span>
<span class='curline'><a href='../S/977.html#L152'>signature</a>         152 ext/phar/pharzip.h 	char signature[4];            /* central file header signature   4 bytes  (0x02014b50) */</span>
<span class='curline'><a href='../S/977.html#L176'>signature</a>         176 ext/phar/pharzip.h 	char signature[4];  /* header signature                4 bytes  (0x05054b50) */</span>
<span class='curline'><a href='../S/977.html#L182'>signature</a>         182 ext/phar/pharzip.h 	char signature[4];        /* zip64 end of central dir </span>
<span class='curline'><a href='../S/977.html#L209'>signature</a>         209 ext/phar/pharzip.h 	char signature[4];     /* zip64 end of central dir locator </span>
<span class='curline'><a href='../S/977.html#L221'>signature</a>         221 ext/phar/pharzip.h 	char signature[4];           /* end of central dir signature    4 bytes  (0x06054b50) */</span>
<span class='curline'><a href='../S/982.html#L305'>signature</a>         305 ext/phar/tar.c 			if (FAILURE == phar_verify_signature(fp, php_stream_tell(fp) - size - 512, myphar-&gt;sig_flags, buf + 8, size - 8, fname, &amp;myphar-&gt;signature, &amp;myphar-&gt;sig_len, error TSRMLS_CC)) {</span>
<span class='curline'><a href='../S/982.html#L604'>signature</a>         604 ext/phar/tar.c 	if (!myphar-&gt;is_data &amp;&amp; PHAR_G(require_hash) &amp;&amp; !myphar-&gt;signature) {</span>
<span class='curline'><a href='../S/982.html#L952'>signature</a>         952 ext/phar/tar.c 	char *buf, *signature, *tmp, sigbuf[8];</span>
<span class='curline'><a href='../S/982.html#L1196'>signature</a>        1196 ext/phar/tar.c 		if (FAILURE == phar_create_signature(phar, newfile, &amp;signature, &amp;signature_length, error TSRMLS_CC)) {</span>
<span class='curline'><a href='../S/982.html#L1230'>signature</a>        1230 ext/phar/tar.c 		if (8 != (int)php_stream_write(entry.fp, sigbuf, 8) || signature_length != (int)php_stream_write(entry.fp, signature, signature_length)) {</span>
<span class='curline'><a href='../S/982.html#L1231'>signature</a>        1231 ext/phar/tar.c 			efree(signature);</span>
<span class='curline'><a href='../S/982.html#L1243'>signature</a>        1243 ext/phar/tar.c 		efree(signature);</span>
<span class='curline'><a href='../S/984.html#L41'>signature</a>          41 ext/phar/util.c static int phar_call_openssl_signverify(int is_sign, php_stream *fp, off_t end, char *key, int key_len, char **signature, int *signature_len TSRMLS_DC);</span>
<span class='curline'><a href='../S/984.html#L1390'>signature</a>        1390 ext/phar/util.c static int phar_hex_str(const char *digest, size_t digest_len, char **signature TSRMLS_DC) /* {{{ */</span>
<span class='curline'><a href='../S/984.html#L1395'>signature</a>        1395 ext/phar/util.c 	*signature = (char*)safe_pemalloc(digest_len, 2, 1, PHAR_G(persist));</span>
<span class='curline'><a href='../S/984.html#L1398'>signature</a>        1398 ext/phar/util.c 		(*signature)[++pos] = hexChars[((const unsigned char *)digest)[len] &gt;&gt; 4];</span>
<span class='curline'><a href='../S/984.html#L1399'>signature</a>        1399 ext/phar/util.c 		(*signature)[++pos] = hexChars[((const unsigned char *)digest)[len] &amp; 0x0F];</span>
<span class='curline'><a href='../S/984.html#L1401'>signature</a>        1401 ext/phar/util.c 	(*signature)[++pos] = '\0';</span>
<span class='curline'><a href='../S/984.html#L1407'>signature</a>        1407 ext/phar/util.c static int phar_call_openssl_signverify(int is_sign, php_stream *fp, off_t end, char *key, int key_len, char **signature, int *signature_len TSRMLS_DC) /* {{{ */</span>
<span class='curline'><a href='../S/984.html#L1417'>signature</a>        1417 ext/phar/util.c 	ZVAL_STRINGL(zsig, *signature, *signature_len, 1);</span>
<span class='curline'><a href='../S/984.html#L1506'>signature</a>        1506 ext/phar/util.c 				*signature = estrndup(Z_STRVAL_P(zsig), Z_STRLEN_P(zsig));</span>
<span class='curline'><a href='../S/984.html#L1520'>signature</a>        1520 ext/phar/util.c int phar_verify_signature(php_stream *fp, size_t end_of_phar, php_uint32 sig_type, char *sig, int sig_len, char *fname, char **signature, int *signature_len, char **error TSRMLS_DC) /* {{{ */</span>
<span class='curline'><a href='../S/984.html#L1645'>signature</a>        1645 ext/phar/util.c 			*signature_len = phar_hex_str((const char*)sig, sig_len, signature TSRMLS_CC);</span>
<span class='curline'><a href='../S/984.html#L1679'>signature</a>        1679 ext/phar/util.c 			*signature_len = phar_hex_str((const char*)digest, sizeof(digest), signature TSRMLS_CC);</span>
<span class='curline'><a href='../S/984.html#L1712'>signature</a>        1712 ext/phar/util.c 			*signature_len = phar_hex_str((const char*)digest, sizeof(digest), signature TSRMLS_CC);</span>
<span class='curline'><a href='../S/984.html#L1753'>signature</a>        1753 ext/phar/util.c 			*signature_len = phar_hex_str((const char*)digest, sizeof(digest), signature TSRMLS_CC);</span>
<span class='curline'><a href='../S/984.html#L1786'>signature</a>        1786 ext/phar/util.c 			*signature_len = phar_hex_str((const char*)digest, sizeof(digest), signature TSRMLS_CC);</span>
<span class='curline'><a href='../S/984.html#L1799'>signature</a>        1799 ext/phar/util.c int phar_create_signature(phar_archive_data *phar, php_stream *fp, char **signature, int *signature_length, char **error TSRMLS_DC) /* {{{ */</span>
<span class='curline'><a href='../S/984.html#L1806'>signature</a>        1806 ext/phar/util.c 	if (phar-&gt;signature) {</span>
<span class='curline'><a href='../S/984.html#L1807'>signature</a>        1807 ext/phar/util.c 		efree(phar-&gt;signature);</span>
<span class='curline'><a href='../S/984.html#L1808'>signature</a>        1808 ext/phar/util.c 		phar-&gt;signature = NULL;</span>
<span class='curline'><a href='../S/984.html#L1824'>signature</a>        1824 ext/phar/util.c 			*signature = estrndup((char *) digest, 64);</span>
<span class='curline'><a href='../S/984.html#L1839'>signature</a>        1839 ext/phar/util.c 			*signature = estrndup((char *) digest, 32);</span>
<span class='curline'><a href='../S/984.html#L1924'>signature</a>        1924 ext/phar/util.c 			*signature = (char *) sigbuf;</span>
<span class='curline'><a href='../S/984.html#L1941'>signature</a>        1941 ext/phar/util.c 			*signature = estrndup((char *) digest, 20);</span>
<span class='curline'><a href='../S/984.html#L1956'>signature</a>        1956 ext/phar/util.c 			*signature = estrndup((char *) digest, 16);</span>
<span class='curline'><a href='../S/984.html#L1962'>signature</a>        1962 ext/phar/util.c 	phar-&gt;sig_len = phar_hex_str((const char *)*signature, *signature_length, &amp;phar-&gt;signature TSRMLS_CC);</span>
<span class='curline'><a href='../S/984.html#L2039'>signature</a>        2039 ext/phar/util.c 	if (phar-&gt;signature) {</span>
<span class='curline'><a href='../S/984.html#L2040'>signature</a>        2040 ext/phar/util.c 		phar-&gt;signature = estrdup(phar-&gt;signature);</span>
<span class='curline'><a href='../S/985.html#L313'>signature</a>         313 ext/phar/zip.c 			if (mydata-&gt;signature) { \</span>
<span class='curline'><a href='../S/985.html#L314'>signature</a>         314 ext/phar/zip.c 				efree(mydata-&gt;signature); \</span>
<span class='curline'><a href='../S/985.html#L337'>signature</a>         337 ext/phar/zip.c 			if (mydata-&gt;signature) { \</span>
<span class='curline'><a href='../S/985.html#L338'>signature</a>         338 ext/phar/zip.c 				efree(mydata-&gt;signature); \</span>
<span class='curline'><a href='../S/985.html#L360'>signature</a>         360 ext/phar/zip.c 		if (memcmp("PK\1\2", zipentry.signature, 4)) {</span>
<span class='curline'><a href='../S/985.html#L439'>signature</a>         439 ext/phar/zip.c 			if (FAILURE == phar_verify_signature(sigfile, php_stream_tell(sigfile), mydata-&gt;sig_flags, sig + 8, entry.uncompressed_filesize - 8, fname, &amp;mydata-&gt;signature, &amp;mydata-&gt;sig_len, error TSRMLS_CC)) {</span>
<span class='curline'><a href='../S/985.html#L796'>signature</a>         796 ext/phar/zip.c 	strncpy(local.signature, "PK\3\4", 4);</span>
<span class='curline'><a href='../S/985.html#L797'>signature</a>         797 ext/phar/zip.c 	strncpy(central.signature, "PK\1\2", 4);</span>
<span class='curline'><a href='../S/985.html#L1085'>signature</a>        1085 ext/phar/zip.c 		char *signature, sigbuf[8];</span>
<span class='curline'><a href='../S/985.html#L1106'>signature</a>        1106 ext/phar/zip.c 		if (FAILURE == phar_create_signature(phar, newfile, &amp;signature, &amp;signature_length, pass-&gt;error TSRMLS_CC)) {</span>
<span class='curline'><a href='../S/985.html#L1130'>signature</a>        1130 ext/phar/zip.c 		if (8 != (int)php_stream_write(entry.fp, sigbuf, 8) || signature_length != (int)php_stream_write(entry.fp, signature, signature_length)) {</span>
<span class='curline'><a href='../S/985.html#L1131'>signature</a>        1131 ext/phar/zip.c 			efree(signature);</span>
<span class='curline'><a href='../S/985.html#L1140'>signature</a>        1140 ext/phar/zip.c 		efree(signature);</span>
<span class='curline'><a href='../S/985.html#L1386'>signature</a>        1386 ext/phar/zip.c 	strncpy(eocd.signature, "PK\5\6", 4);</span>
</pre>
</body>
</html>
