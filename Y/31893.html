<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>peer_cert</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/867.html#L1619'>peer_cert</a>        1619 ext/openssl/xp_ssl.c static int capture_peer_certs(php_stream *stream, php_openssl_netstream_data_t *sslsock, X509 *peer_cert TSRMLS_DC) /* {{{ */</span>
<span class='curline'><a href='../S/867.html#L1629'>peer_cert</a>        1629 ext/openssl/xp_ssl.c 		ZVAL_RESOURCE(zcert, zend_list_insert(peer_cert, php_openssl_get_x509_list_id() TSRMLS_CC));</span>
<span class='curline'><a href='../S/867.html#L1677'>peer_cert</a>        1677 ext/openssl/xp_ssl.c 	X509 *peer_cert;</span>
<span class='curline'><a href='../S/867.html#L1756'>peer_cert</a>        1756 ext/openssl/xp_ssl.c 			peer_cert = SSL_get_peer_certificate(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/867.html#L1757'>peer_cert</a>        1757 ext/openssl/xp_ssl.c 			if (peer_cert &amp;&amp; stream-&gt;context) {</span>
<span class='curline'><a href='../S/867.html#L1758'>peer_cert</a>        1758 ext/openssl/xp_ssl.c 				cert_captured = capture_peer_certs(stream, sslsock, peer_cert TSRMLS_CC);</span>
<span class='curline'><a href='../S/867.html#L1761'>peer_cert</a>        1761 ext/openssl/xp_ssl.c 			if (FAILURE == apply_peer_verification_policy(sslsock-&gt;ssl_handle, peer_cert, stream TSRMLS_CC)) {</span>
<span class='curline'><a href='../S/867.html#L1785'>peer_cert</a>        1785 ext/openssl/xp_ssl.c 			peer_cert = SSL_get_peer_certificate(sslsock-&gt;ssl_handle);</span>
<span class='curline'><a href='../S/867.html#L1786'>peer_cert</a>        1786 ext/openssl/xp_ssl.c 			if (peer_cert &amp;&amp; stream-&gt;context) {</span>
<span class='curline'><a href='../S/867.html#L1787'>peer_cert</a>        1787 ext/openssl/xp_ssl.c 				cert_captured = capture_peer_certs(stream, sslsock, peer_cert TSRMLS_CC);</span>
<span class='curline'><a href='../S/867.html#L1791'>peer_cert</a>        1791 ext/openssl/xp_ssl.c 		if (n &amp;&amp; peer_cert &amp;&amp; cert_captured == 0) {</span>
<span class='curline'><a href='../S/867.html#L1792'>peer_cert</a>        1792 ext/openssl/xp_ssl.c 			X509_free(peer_cert);</span>
</pre>
</body>
</html>
