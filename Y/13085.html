<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>cafile</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.5.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<pre>
<span class='curline'><a href='../S/867.html#L735'>cafile</a>            735 ext/openssl/xp_ssl.c static long load_stream_cafile(X509_STORE *cert_store, const char *cafile TSRMLS_DC) /* {{{ */</span>
<span class='curline'><a href='../S/867.html#L745'>cafile</a>            745 ext/openssl/xp_ssl.c 	stream = php_stream_open_wrapper(cafile, "rb", 0, NULL);</span>
<span class='curline'><a href='../S/867.html#L748'>cafile</a>            748 ext/openssl/xp_ssl.c 		php_error(E_WARNING, "failed loading cafile stream: `%s'", cafile);</span>
<span class='curline'><a href='../S/867.html#L808'>cafile</a>            808 ext/openssl/xp_ssl.c 		php_error(E_WARNING, "no valid certs found cafile stream: `%s'", cafile);</span>
<span class='curline'><a href='../S/867.html#L818'>cafile</a>            818 ext/openssl/xp_ssl.c 	char *cafile = NULL;</span>
<span class='curline'><a href='../S/867.html#L822'>cafile</a>            822 ext/openssl/xp_ssl.c 	GET_VER_OPT_STRING("cafile", cafile);</span>
<span class='curline'><a href='../S/867.html#L825'>cafile</a>            825 ext/openssl/xp_ssl.c 	if (cafile == NULL) {</span>
<span class='curline'><a href='../S/867.html#L826'>cafile</a>            826 ext/openssl/xp_ssl.c 		cafile = zend_ini_string("openssl.cafile", sizeof("openssl.cafile"), 0);</span>
<span class='curline'><a href='../S/867.html#L827'>cafile</a>            827 ext/openssl/xp_ssl.c 		cafile = strlen(cafile) ? cafile : NULL;</span>
<span class='curline'><a href='../S/867.html#L830'>cafile</a>            830 ext/openssl/xp_ssl.c 		STACK_OF(X509_NAME) *cert_names = SSL_load_client_CA_file(cafile);</span>
<span class='curline'><a href='../S/867.html#L844'>cafile</a>            844 ext/openssl/xp_ssl.c 	if (cafile || capath) {</span>
<span class='curline'><a href='../S/867.html#L845'>cafile</a>            845 ext/openssl/xp_ssl.c 		if (!SSL_CTX_load_verify_locations(ctx, cafile, capath)) {</span>
<span class='curline'><a href='../S/867.html#L846'>cafile</a>            846 ext/openssl/xp_ssl.c 			if (cafile &amp;&amp; !load_stream_cafile(SSL_CTX_get_cert_store(ctx), cafile TSRMLS_CC)) {</span>
</pre>
</body>
</html>
